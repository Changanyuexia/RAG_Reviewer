[{"instruction": "Here is an example code review: 'Use `response.asJsonObject()` instead. Also, use `put()` instead of `putOpt()`, `null` as a value is fine.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -53,7 +53,7 @@ public class ProtocGapicPluginGeneratorTest { model.getFiles().stream().map(ProtoFile::getProto).collect(Collectors.toList())) // Only the file to generate a client for (don't generate dependencies) .addFileToGenerate(multiple_services.proto) - .setParameter(language=java) + .setParameter(language=java,transport=grpc) .build(); CodeGeneratorResponse response = ProtocGeneratorMain.generate(codeGeneratorRequest);", "output": "can we also test for `transport=rest`?"}, {"instruction": "Here is an example code review: 'why named alters? how about this.alerts = alerts?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -182,7 +182,9 @@ abstract class AbstractSolrBackendFactory implements FactoryInterface */ protected function createBackend(Connector $connector) { + $config = $this->config->get($this->mainConfig); $backend = new $this->backendClass($connector); + $backend->setPageSize($config->Index->record_batch_size); $backend->setQueryBuilder($this->createQueryBuilder()); $backend->setSimilarBuilder($this->createSimilarBuilder()); if ($this->logger) {", "output": "If record_batch_size is not set in config.ini, this code will trigger a notice about an undefined value. I would suggest either wrapping the setPageSize() call in an `if (!empty(...)) {` check, or else providing a default value in the set call (i.e. `$config->Index->record_batch_size ?? 100`)."}, {"instruction": "Here is an example code review: 'Why should audio and video elements always return `false` for `isHidden`?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1,6 +1,6 @@ <script type=text/javascript> window.analytics||(window.analytics=[]),window.analytics.methods=[identify,track,trackLink,trackForm,trackClick,trackSubmit,page,pageview,ab,alias,ready,group,on,once,off],window.analytics.factory=function(t){return function(){var a=Array.prototype.slice.call(arguments);return a.unshift(t),window.analytics.push(a),window.analytics}};for(var i=0;i<window.analytics.methods.length;i++){var method=window.analytics.methods[i];window.analytics[method]=window.analytics.factory(method)}window.analytics.load=function(t){var a=document.createElement(script);a.type=text/javascript,a.async=!0,a.src=(https:===document.location.protocol?https://:http://)+d2dq2ahtl5zl1z.cloudfront.net/analytics.js/v1/+t+/analytics.min.js;var n=document.getElementsByTagName(script)[0];n.parentNode.insertBefore(a,n)},window.analytics.SNIPPET_VERSION=2.0.8, - window.analytics.load(2nexpdgku3); + window.analytics.load(<%= ENV['SEGMENT_KEY']%>); window.analytics.page(); </script> ", "output": "I didn't realize we were hardcoding this, thanks for moving it to an env value."}, {"instruction": "Here is an example code review: 'Do you also need to check if Blockly.localConnection_ is non-null?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -99,7 +99,7 @@ module.exports = function fileItem (props) { } </h4> <div class=UppyDashboardItem-status> - ${file.data.size && html`<div class=UppyDashboardItem-statusSize>${prettyBytes(file.data.size)}</div>`} + ${isNaN(file.data.size) ? '' : html`<div class=UppyDashboardItem-statusSize>${prettyBytes(file.data.size)}</div>`} ${file.source && html`<div class=UppyDashboardItem-sourceIcon> ${acquirers.map(acquirer => { if (acquirer.id === file.source) return html`<span title=${props.i18n('fileSource')}: ${acquirer.name}>${acquirer.icon()}</span>`", "output": "We are trying to support IE 10-11, so we'll need a polyfill for this one, I think."}, {"instruction": "Here is an example code review: 'Did you mean to use `hasAttribute`? You shouldn't. This does not improve performance and it messes with the readability.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -38,6 +38,9 @@ const { useSelect, useDispatch } = Data; function ResetButton( { children } ) { const postResetURL = useSelect( ( select ) => select( CORE_SITE ).getAdminURL( 'googlesitekit-splash', { notification: 'reset_success' } ) ); + const isNavigating = useSelect( ( select ) => select( CORE_LOCATION ).isNavigating() ); + const navigatingURL = useSelect( ( select ) => select( CORE_LOCATION ).getNavigateURL() ); + const [ dialogActive, setDialogActive ] = useState( false ); useEffect( () => {", "output": "It looks like there's a new `isNavigatingTo( url )` selector for this very purpose so let's use this here instead. This way we just need to use the one selector rather than two. Let's assign that to a similar-named variable here (e.g. `isNavigatingToPostResetURL`) rather than the prop it's used with."}, {"instruction": "Here is an example code review: 'I don't think these asserts are necessary, because `subsurface_find_sibling` already searches in the parent. Or am I missing something?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -29,8 +29,8 @@ namespace lbann { -void im2col(const Mat& im, - Mat& col, +void im2col(const AbsMat& im, + AbsMat& col, const int num_channels, const int im_num_dims, const int * im_dims,", "output": "I think im2col should only accommodate CPUMat."}, {"instruction": "Here is an example code review: 'Why need alias?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -24,6 +24,8 @@ from google.cloud.forseti.notifier.notifiers import cscc_notifier from google.cloud.forseti.notifier.notifiers.inventory_summary import InventorySummary from google.cloud.forseti.services.inventory.storage import DataAccess from google.cloud.forseti.services.scanner import dao as scanner_dao +from google.cloud.forseti.common.util.email.email_factory import EmailFactory +from google.cloud.forseti.notifier.notifiers import email_violations # pylint: enable=line-too-long ", "output": "alpha sort the imports"}, {"instruction": "Here is an example code review: 'maybe say returns the default cost method that returns an object of cost 1.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1067,7 +1067,7 @@ fpga_result mmio_error(struct RASCommandLine *rasCmdLine) if ( rasCmdLine->function >0 ) function = rasCmdLine->bus; - snprintf(sysfs_path, sizeof(sysfs_path), + snprintf_s_iiii(sysfs_path, sizeof(sysfs_path), DEVICEID_PATH,0,bus,device,function); result = sysfs_read_u64(sysfs_path, &value);", "output": "Can you explain why is this necessary? Is `snprintf()` with four integer arguments unsafe?"}, {"instruction": "Here is an example code review: '`open_id_authentication` is no longer the name of the function, and it's not OpenID specific'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -219,7 +219,19 @@ def internal_keyDownEvent(vkCode,scanCode,extended,injected): for k in range(256): keyStates[k]=ctypes.windll.user32.GetKeyState(k) charBuf=ctypes.create_unicode_buffer(5) + # First try getting the keyboard layout from the thread with the focus (input thread) hkl=ctypes.windll.user32.GetKeyboardLayout(focus.windowThreadID) + if not hkl: + log.debug(Failed to fetch keyboard layout from focus, trying layout from last detected change) + # Some threads, such as for Windows consoles + # Do not allow getKeyboardLayout to work. + # Therefore, use the cached keyboard layout from the last inputLangChange detected by NVDA + # on the foreground object. + hkl = getattr(api.getForegroundObject(), '_lastDetectedKeyboardLayoutChange', 0) + if not hkl: + log.debug(No layout cached, falling back to layout of NVDA main thread) + # As a last resort, use the keyboard layout of NVDA's main thread. + hkl = ctypes.windll.user32.GetKeyboardLayout(core.mainThreadId) # In previous Windows builds, calling ToUnicodeEx would destroy keyboard buffer state and therefore cause the app to not produce the right WM_CHAR message. # However, ToUnicodeEx now can take a new flag of 0x4, which stops it from destroying keyboard state, thus allowing us to safely call it here. res=ctypes.windll.user32.ToUnicodeEx(vkCode,scanCode,keyStates,charBuf,len(charBuf),0x4,hkl)", "output": "How likely would it be that the keyboard layout for the NVDA main thread differs from the keyboard layout of the currently focused app?"}, {"instruction": "Here is an example code review: 'Assigning capabilities to the field here is not the best idea. Semantically this field contains the capabilities returned by the browser after session start. So here we sould better amend capabilities and return them from `init` method to pass later to `startSession` method (that will assign the capabilities returned by the browser to the field).'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -198,6 +198,10 @@ class Driver extends webdriver.WebDriver { * @return {!Driver} A new driver instance. */ static createSession(options, service = getDefaultService()) { + if (!service) { + service = getDefaultService(); + } + let client = service.start().then(url => new http.HttpClient(url)); let executor = new http.Executor(client); ", "output": "Would you mind removing the default parameter above? (I doubt I'll ever use defaults again since you still have to protect against callers explicitly passing `null` or `undefined`)"}, {"instruction": "Here is an example code review: 'Might be cheaper to reuse the `null` assignment of line 313 and set `isHydrating` to null instead WDYT?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -2186,7 +2186,7 @@ class WebElement { if (!this.driver_.fileDetector_) { return this.schedule_( new command.Command(command.Name.SEND_KEYS_TO_ELEMENT). - setParameter('text', keys). + setParameter('text', keys.then(keys => keys.join(''))). setParameter('value', keys), 'WebElement.sendKeys()'); }", "output": "Also update line 2205 below"}, {"instruction": "Here is an example code review: 'changed for debug purpose?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -39,6 +39,7 @@ func (p *Provisioner) ProvisionHostPath(opts pvController.VolumeOptions, volumeC name := opts.PVName stgType := volumeConfig.GetStorageType() saName := getOpenEBSServiceAccountName() + shared := volumeConfig.GetSharedMountValue() path, err := volumeConfig.GetPath() if err != nil {", "output": "n_: It is a good practice to name the variable to indicate what they contain. In this case since `shared` is supposed to have boolean, calling it: `isShared` can help in the readability of the code."}, {"instruction": "Here is an example code review: 'Would you mind removing the default parameter above? (I doubt I'll ever use defaults again since you still have to protect against callers explicitly passing `null` or `undefined`)'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -85,7 +85,10 @@ export class ManualColumnFreeze extends BasePlugin { } /** - * Freezes the given column (add it to fixed columns). + * Freezes the specified column (i.e. adds it to fixed columns). + * + * `freezeColumn()` doesn't re-render the table, + * so you need to call the `render()` method afterward. * * @param {number} column Visual column index. */", "output": "I suppose it's a false-positive error. Maybe there is a way to configure the `eslint-*` package to accept `i.e. .... lower case` syntax  "}, {"instruction": "Here is an example code review: '@cijothomas I needed a way to set the Exporter.ParentProvider when the Processor's gets set. Internal to SDK though.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -133,7 +133,7 @@ namespace OpenTelemetry.Trace private void RunGetRequestedDataOtherSampler(Activity activity) { ActivityContext parentContext; - if (string.IsNullOrEmpty(activity.ParentId)) + if (string.IsNullOrEmpty(activity.ParentId) || activity.ParentSpanId.ToHexString().Equals(0000000000000000)) { parentContext = default; }", "output": "this maynot be a perf issue, if ToHexString() is not actually allocating a string, but returns the caches string value. to be confirmed."}, {"instruction": "Here is an example code review: 'These changes to the resource helpers have some more far-reaching implications as they also affect calls made in hive-operator, I believe. It's probably OK still, though. Ideally, the resource helper would not be the one doing the logging, since it cannot know the severity, but that is well beyond something that we should tackle for this PR. I would rather have the hive-operator log warnings than have the syncsetinstance controller log errors.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -114,11 +114,16 @@ func (w *watcher) run(ctx context.Context, provider imageprovider.Provider, inte updates = append(updates, u...) } if len(updates) == 0 { - w.logger.Info(no image to be updated) + w.logger.Info(no image to be updated, + zap.String(image-provider, provider.Name()), + ) continue } if err := update(updates); err != nil { - w.logger.Error(failed to update image, zap.Error(err)) + w.logger.Error(failed to update image, zap.String(image-provider, + provider.Name()), + zap.Error(err), + ) continue } }", "output": "`zap.String(image-provider, provider.Name())` should be in a same line."}, {"instruction": "Here is an example code review: 'Might be cheaper to reuse the `null` assignment of line 313 and set `isHydrating` to null instead WDYT?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1,8 +1,6 @@ /*exported DqElement */ function truncate(str, maxLength) { - 'use strict'; - maxLength = maxLength || 300; if (str.length > maxLength) {", "output": "Why this deletion?"}, {"instruction": "Here is an example code review: 'I'm confused by the name. The string was a Hive string but it isn't any longer? Why should we care? (I imagine I'll find the answer later... there is some different semantic that we want downstream...)'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -419,7 +419,10 @@ class S3KeyTest(unittest.TestCase): remote_metadata = check._get_remote_metadata() # TODO: investigate whether encoding ' ' as '%20' makes sense - self.assertEqual(check.cache_control, 'public,%20max-age=500') + self.assertIn( + check.cache_control, + ('public,%20max-age=500', 'public, max-age=500') + ) self.assertEqual(remote_metadata['cache-control'], 'public,%20max-age=500') self.assertEqual(check.get_metadata('test-plus'), 'A plus (+)') self.assertEqual(check.content_disposition, 'filename=Sch%C3%B6ne%20Zeit.txt')", "output": "This change looks unrelated to the CL description?"}, {"instruction": "Here is an example code review: 'Why change the port from 0 to getAvailablePort()?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -18,7 +18,7 @@ class DedupTest : public QueryTestBase { void SetUp() override { QueryTestBase::SetUp(); } }; -#define DEDUP_RESUTL_CHECK(inputName, outputName, sentence, expected) \\ +#define DEDUP_RESULT_CHECK(inputName, outputName, sentence, expected) \\ do { \\ qctx_->symTable()->newVariable(outputName); \\ auto yieldSentence = getYieldSentence(sentence, qctx_.get()); \\", "output": "I'm not certain that `res`+`utl` isn't a thing."}, {"instruction": "Here is an example code review: 'curious do we have an API to fetch an inactive flow?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -182,6 +182,7 @@ public class FetchActiveFlowDao { +  LEFT JOIN  +  executors et ON ex.executor_id = et.id +  WHERE ex.status NOT IN ( + + Status.EXECUTION_STOPPED.getNumVal() + ,  + Status.SUCCEEDED.getNumVal() + ,  + Status.KILLED.getNumVal() + ,  + Status.FAILED.getNumVal() + );", "output": "This method can cause bugs. Why don't you use list of finalize statuses and then use join by comma and that will give you correct value. Use Apache Commons Lang library List<Integer> list = Arrays.asList(1,2,3,4,5,6,7); String str = org.apache.commons.lang.StringUtils.join(list, ,); You can use it at multiple places shown in this diff."}, {"instruction": "Here is an example code review: 'Remind me why you are using CUDA vocabulary when naming these variables.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -23,7 +23,10 @@ void wlr_input_device_init(struct wlr_input_device *dev, } void wlr_input_device_destroy(struct wlr_input_device *dev) { - if (!dev) return; + if (!dev) { + return; + } + if (dev->_device) { switch (dev->type) { case WLR_INPUT_DEVICE_KEYBOARD:", "output": "Merge with next condition"}, {"instruction": "Here is an example code review: 'Looks like this is unused? Did you mean to call it when clearing the block journal?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -348,6 +348,7 @@ type appResourcesGetter interface { type taskDeployer interface { DeployTask(input *deploy.CreateTaskResourcesInput, opts ...cloudformation.StackOption) error + DeleteTask(task deploy.TaskStackInfo) error } type taskRunner interface {", "output": "Maybe add it when it is used."}, {"instruction": "Here is an example code review: 'Can you please make each of these in a separate line. It will be easier to keep them sorted, and add/remove.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -36,3 +36,17 @@ TWO_ENABLED = {'scanners': [ {'name': 'cloudsql_acl', 'enabled': False}, {'name': 'iam_policy', 'enabled': True} ]} + +NONEXIST_ENABLED = {'scanners': [ + {'name': 'bigquery', 'enabled': False}, + {'name': 'bucket_acl', 'enabled': True}, + {'name': 'cloudsql_acl', 'enabled': False}, + {'name': 'non_exist_scanner', 'enabled': True} +]} + +ALL_EXIST = {'scanners': [ + {'name': 'bigquery', 'enabled': True}, + {'name': 'bucket_acl', 'enabled': True}, + {'name': 'cloudsql_acl', 'enabled': True}, + {'name': 'iam_policy', 'enabled': True} +]}", "output": "More clear naming: NONEXISTENT_ENABLED"}, {"instruction": "Here is an example code review: 'Unrelated file. Please remove from PR.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -282,10 +282,10 @@ public class TypeUtil { switch (from.typeId()) { case INTEGER: - return to == Types.LongType.get(); + return to.equals(Types.LongType.get()); case FLOAT: - return to == Types.DoubleType.get(); + return to.equals(Types.DoubleType.get()); case DECIMAL: Types.DecimalType fromDecimal = (Types.DecimalType) from;", "output": "why is this change necessary?"}, {"instruction": "Here is an example code review: 'Use `response.asJsonObject()` instead. Also, use `put()` instead of `putOpt()`, `null` as a value is fine.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -178,9 +178,8 @@ public class SchemaTypeTable implements ImportTypeTable, SchemaTypeFormatter { @Override public String getFullNameFor(TypeModel type) { - // TODO(andrealin): Remove this hack when null response types are implemented. - if (type == null) { - return nullFullName; + if (type.isEmptyType()) { + return java.lang.Void; } if (type instanceof DiscoveryRequestType) { Method method = ((DiscoveryRequestType) type).parentMethod().getDiscoMethod();", "output": "make a SchemaTypeNameConverter.getTypeNameForEmptyType() and call that here."}, {"instruction": "Here is an example code review: '` $event->getAvatarFilename()` this function return `string` or `null`. In this place ` $event->getAvatarFilename()->getValue()` return `Fatal error `'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -26,7 +26,10 @@ class TinyMCELanguage extends AbstractSmartyPlugin public function __construct(Request $request) { - $this->locale = $request->getSession()->getLang()->getLocale(); + if($request->getSession() != null) + $this->locale = $request->getSession()->getLang()->getLocale(); + else + $this->locale = Lang::getDefaultLanguage()->getLocale(); } public function guessTinyMCELanguage($params, \\Smarty_Internal_Template $template)", "output": "Use braces on your conditional structures please"}, {"instruction": "Here is an example code review: 'We've avoided including h2o headers in BPF programs because it's a runtime dependency. However, IIRC, this is because h2olog was maintained in the separate repository so that h2olog did not know where h2o was installed. Now h2olog can use `H2O_ROOT`, we should add it to BCC's `cflags` in order to include h2o headers in BPF programs.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -16,6 +16,7 @@ DECLARE_string(u); DECLARE_string(p); +DEFINE_bool(enable_history, false, Whether to force saving the command history); namespace nebula { namespace graph {", "output": "Great God, I have a question. This .nebula_history file is used to save history commands. Is there a file size limit? When the file is large, does it take a long time to start initialization (loadHistory)? How did you think about this? Thx."}, {"instruction": "Here is an example code review: 'Great God, I have a question. This .nebula_history file is used to save history commands. Is there a file size limit? When the file is large, does it take a long time to start initialization (loadHistory)? How did you think about this? Thx.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1004,8 +1004,9 @@ static void parseRecord (tokenInfo *const token) */ if (!isType (token, TOKEN_OPEN_PAREN)) readToken (token); + if (!isType (token, TOKEN_OPEN_PAREN)) + return; - Assert (isType (token, TOKEN_OPEN_PAREN)); do { if (isType (token, TOKEN_COMMA) ||", "output": "Isn't this the same check as two lines above?"}, {"instruction": "Here is an example code review: 'why named alters? how about this.alerts = alerts?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -18,8 +18,11 @@ from mitmproxy import io from mitmproxy import log from mitmproxy import version from mitmproxy import optmanager +from mitmproxy import options import mitmproxy.tools.web.master # noqa +CONFIG_PATH = os.path.join(options.CA_DIR, 'config.yaml') + def flow_to_json(flow: mitmproxy.flow.Flow) -> dict: ", "output": "Don't redefine, just import the existing one in `cmdline.py`. :)"}, {"instruction": "Here is an example code review: 'This is a way better method name.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -92,7 +92,8 @@ module Mongoid # # @since 2.0.0.rc.7 def process_attribute(name, value) - if store_as = aliased_fields.invert[name.to_s] + responds = respond_to?(#{name}=) + if !responds && store_as = aliased_fields.invert[name.to_s] name = store_as end responds = respond_to?(#{name}=)", "output": "why not call `respond_to?(#{name}=)` from the `if` line?"}, {"instruction": "Here is an example code review: 'I'm not certain that `res`+`utl` isn't a thing.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -215,7 +215,8 @@ public final class BlazeCidrLauncher extends CidrLauncher { workingDir = workspaceRootDirectory; } - GeneralCommandLine commandLine = new GeneralCommandLine(runner.executableToDebug.getPath()); + GeneralCommandLine commandLine = new GeneralCommandLine(runner.executableToDebug.getPath()) + .withWorkDirectory(workingDir); commandLine.addParameters(handlerState.getExeFlagsState().getFlagsForExternalProcesses()); commandLine.addParameters(handlerState.getTestArgs());", "output": "This was properly set above as `<target>.runfiles/<workspace_name>` (with a fallback to workspace root dir) but never used past this line."}, {"instruction": "Here is an example code review: 'Great God, I have a question. This .nebula_history file is used to save history commands. Is there a file size limit? When the file is large, does it take a long time to start initialization (loadHistory)? How did you think about this? Thx.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -0,0 +1,13 @@ +using System; +using System.Collections.Generic; +using System.Linq; +using System.Text; +using System.Threading.Tasks; +using MvvmCross.Core.Views; + +namespace MvvmCross.Uwp.Attributes +{ + public class MvxPagePresentationAttribute : MvxBasePresentationAttribute + { + } +}", "output": "Are all these namespaces required for this attribute?"}, {"instruction": "Here is an example code review: 'This is a way better method name.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -53,9 +53,12 @@ module Beaker result.stdout << std_out result.stderr << std_err result.exit_code = status.exitstatus + @logger.info(result.stdout) + @logger.info(result.stderr) end rescue => e result.stderr << e.inspect + @logger.info(result.stderr) result.exit_code = 1 end ", "output": "Given this may be used and printed in other ways, isn't `debug` more appropriate?"}, {"instruction": "Here is an example code review: 'This isn't really easy to read.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -540,3 +540,7 @@ func (s *blockDiskStore) remove(id kbfsblock.ID) error { } return err } + +func (s blockDiskStore) clear() error { + return ioutil.RemoveAll(s.dir) +}", "output": "Looks like this is unused? Did you mean to call it when clearing the block journal?"}, {"instruction": "Here is an example code review: 'This was introduced recently for the Hadoop 3 upgrade. Copy/paste error but definitely causing some of the new test failures.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -117,8 +117,10 @@ public class ExecutorManager extends EventHandler implements public ExecutorManager(Props props, ExecutorLoader loader, Map<String, Alerter> alters) throws ExecutorManagerException { + alerters = alters; azkProps = props; this.executorLoader = loader; + this.setupExecutors(); this.loadRunningFlows(); ", "output": "why named alters? how about this.alerts = alerts?"}, {"instruction": "Here is an example code review: 'Same trick here IMO.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1549,7 +1549,7 @@ func (js *jetStream) processStreamLeaderChange(mset *stream, isLeader bool) { resp.Error = jsError(err) s.sendAPIErrResponse(client, acc, subject, reply, _EMPTY_, s.jsonResponse(&resp)) } else { - resp.StreamInfo = &StreamInfo{Created: mset.createdTime(), State: mset.state(), Config: mset.config(), Cluster: js.clusterInfo(mset.raftGroup())} + resp.StreamInfo = &StreamInfo{Created: mset.createdTime(), State: mset.state(), Config: mset.config(), Cluster: js.clusterInfo(mset.raftGroup()), Sources: mset.sourcesInfo(), Mirror: mset.mirrorInfo()} s.sendAPIResponse(client, acc, subject, reply, _EMPTY_, s.jsonResponse(&resp)) if node := mset.raftNode(); node != nil { mset.sendCreateAdvisory()", "output": "not sure if this has to be here or not tbh"}, {"instruction": "Here is an example code review: 'I'd feel a little safer if the first argument were a string, not a *string unless there's a particular reason for making it a pointer.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -72,7 +72,12 @@ func newHarnessUsingAutodelete(ctx context.Context, t *testing.T) (drivertest.Ha } func (h *harness) CreateTopic(ctx context.Context, testName string) (dt driver.Topic, cleanup func(), err error) { + // Keep the topic entity name under 50 characters as per Azure limits. + // See https://docs.microsoft.com/en-us/azure/service-bus-messaging/service-bus-quotas topicName := fmt.Sprintf(%s-topic-%d, sanitize(testName), atomic.AddUint32(&h.numTopics, 1)) + if len(topicName) > 50 { + topicName = topicName[:50] + } createTopic(ctx, topicName, h.ns, nil) ", "output": "There's a better fix for this in #1741, which should replace this."}, {"instruction": "Here is an example code review: 'I'd feel a little safer if the first argument were a string, not a *string unless there's a particular reason for making it a pointer.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -63,7 +63,7 @@ func (s *StreamMock) Close() error { func TestHandshake(t *testing.T) { logger := logging.New(ioutil.Discard, 0) info := Info{ - Address: node1, + Address: []byte(node1), NetworkID: 0, Light: false, }", "output": "Use swarm.Address not []byte as type, and construct it from actual byteslice or use swarm.NewAddress if it is constructed from hex-encoded string."}, {"instruction": "Here is an example code review: 'wut. We can do this at the beginning of tests if we want right? Why are we depending on init?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -80,8 +80,9 @@ func TestFSRepoInit(t *testing.T) { dir, err := ioutil.TempDir(, ) assert.NoError(t, err) - - defer os.RemoveAll(dir) + defer func() { + require.NoError(t, os.RemoveAll(dir)) + }() t.Log(init FSRepo) assert.NoError(t, InitFSRepo(dir, config.NewDefaultConfig()))", "output": "It would be worth factoring this out to a function, but you don't have to do that here."}, {"instruction": "Here is an example code review: 'Found one internal team is using this method. Will coordinate with them about the migration solution.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -0,0 +1,15 @@ +package com.fsck.k9.message.html; + +/** + * General framework to handle uris when parsing. Allows different handling depending on the scheme identifier. + */ +public interface UriParser { + /** + * Parse and linkify scheme specific uri beginning from given position. The result will be written to given buffer. + * @param text String to parse uri from. + * @param startPos Position where uri starts (first letter of scheme). + * @param outputBuffer Buffer where linkified variant of uri is written to. + * @return Index where parsed uri ends (first non-uri letter). Should be startPos or smaller if no valid uri was found. + */ + int linkifyUri(String text, int startPos, StringBuffer outputBuffer); +}", "output": "There's no need for `final` in interfaces."}, {"instruction": "Here is an example code review: '@cijothomas I needed a way to set the Exporter.ParentProvider when the Processor's gets set. Internal to SDK though.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -101,6 +101,9 @@ namespace Datadog.Trace.OpenTracing case DatadogTags.ServiceName: Span.ServiceName = value; return this; + case DatadogTags.ServiceVersion: + Span.SetTag(Tags.Version, value); + return this; } if (key == global::OpenTracing.Tag.Tags.Error.Key)", "output": "Isn't this case handled as a custom tag in `Span.SetTag()` below? This switch is only for special tags that actually set `Span` properties."}, {"instruction": "Here is an example code review: 'I think Don't replace variables ... would be cleaner.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -681,7 +681,6 @@ class Quitter: @cmdutils.argument('session', completion=miscmodels.session) def quit(self, save=False, session=None): Quit qutebrowser. - Args: save: When given, save the open windows even if auto_save.session is turned off.", "output": "This shouldn't be changed."}, {"instruction": "Here is an example code review: 'This seems meaningless. If we cannot add any info let us remove this.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1,5 +1,5 @@ ## This file is part of Invenio. -## Copyright (C) 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012 CERN. +## Copyright (C) 2004, 2005, 2006, 2007, 2008, 2009, 2010, 2011, 2012, 2014 CERN. ## ## Invenio is free software; you can redistribute it and/or ## modify it under the terms of the GNU General Public License as", "output": "This one is important `2: I102 copyright year is outdated, expected 2014 but got 2012`"}, {"instruction": "Here is an example code review: 'I've had this happen recently with IntelliJ, was this intentional?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -32,6 +32,8 @@ import java.util.Map; import java.util.Optional; import java.util.Set; import java.util.concurrent.TimeoutException; +import java.util.function.BiConsumer; +import java.util.function.Consumer; import com.google.common.collect.Lists; import com.google.common.collect.Maps;", "output": "Are these imports needed (BiConsumer and Consumer)? If they are unused imports, then precommit will fail."}, {"instruction": "Here is an example code review: 'Put a comma after the last item of a multiline hash.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -0,0 +1,10 @@ +class TraceDestroyerJob < ApplicationJob + queue_as :default + + def perform(trace) + trace.destroy + rescue StandardError => ex + logger.info ex.to_s + ex.backtrace.each { |l| logger.info l } + end +end", "output": "Why are we catching and logging exceptions? By doing that we make it look like the job has succeeded and it will be removed from the queue - if we didn't do that then it would stay queued..."}, {"instruction": "Here is an example code review: 'do you really want to change the behavior on foreign key ?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -90,14 +90,11 @@ class CartController extends FrontBaseController */ public function indexAction(Request $request) { - $cart = $this->cartFacade->getCartOfCurrentCustomer(); - - if ($cart->isEmpty()) { - $this->cartFacade->cleanAdditionalData(); - } + $cart = $this->cartFacade->findCartOfCurrentCustomer(); + $cartItems = $cart === null ? [] : $cart->getItems(); $cartFormData = ['quantities' => []]; - foreach ($cart->getItems() as $cartItem) { + foreach ($cartItems as $cartItem) { $cartFormData['quantities'][$cartItem->getId()] = $cartItem->getQuantity(); } ", "output": "If there are `@param` tags in docblock, there should be `@return` tag also. (applies for a whole file)"}, {"instruction": "Here is an example code review: 'It will be helpful to specify the intended priority as well for the properties within this file.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -34,7 +34,8 @@ public enum BesuMetricCategory implements MetricCategory { PRUNER(pruner), RPC(rpc), SYNCHRONIZER(synchronizer), - TRANSACTION_POOL(transaction_pool); + TRANSACTION_POOL(transaction_pool), + VALIDATORS(validators); private static final Optional<String> BESU_PREFIX = Optional.of(besu_); public static final Set<MetricCategory> DEFAULT_METRIC_CATEGORIES;", "output": "Is the concept of validators exclusive to IBFT2? I wonder if this category should be more explicitly linked to IBFT2."}, {"instruction": "Here is an example code review: 'You can safely revert changes to this file.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -14,9 +14,7 @@ */ package org.hyperledger.besu.tests.acceptance.dsl.account; -import org.hyperledger.besu.crypto.SECP256K1.KeyPair; -import org.hyperledger.besu.crypto.SECP256K1.PrivateKey; -import org.hyperledger.besu.crypto.SECP256K1.PublicKey; +import org.hyperledger.besu.crypto.*; import org.hyperledger.besu.ethereum.core.Address; import org.hyperledger.besu.ethereum.core.Hash; import org.hyperledger.besu.tests.acceptance.dsl.blockchain.Amount;", "output": "Spotless is configured to reject star imports. Please replace with explicit imports."}, {"instruction": "Here is an example code review: 'why not recycling? I Lru cache now recycling?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -115,6 +115,8 @@ void SYCLInternal::initialize(const sycl::device& d) { m_maxThreadsPerSM = d.template get_info<sycl::info::device::max_work_group_size>(); + m_maxShmemPerBlock = + d.template get_info<sycl::info::device::local_mem_size>(); m_indirectKernelMem.reset(*m_queue); m_indirectReducerMem.reset(*m_queue); } else {", "output": "Remind me why you are using CUDA vocabulary when naming these variables."}, {"instruction": "Here is an example code review: 'This was introduced recently for the Hadoop 3 upgrade. Copy/paste error but definitely causing some of the new test failures.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -898,6 +898,16 @@ public final class DBReader { } final LongIntMap feedCounters = adapter.getFeedCounters(feedIds); + int feedFilter = UserPreferences.getFeedFilter(); + if (feedFilter == UserPreferences.FEED_FILTER_COUNTER_ZERO) { + for (int i = 0; i < feeds.size(); i++) { + if (feedCounters.get(feeds.get(i).getId()) <= 0) { + feedCounters.delete(feeds.get(i).getId()); + feeds.remove(i); + } + } + } + Comparator<Feed> comparator; int feedOrder = UserPreferences.getFeedOrder(); if (feedOrder == UserPreferences.FEED_ORDER_COUNTER) {", "output": "Please turn the iteration order around (instead of `0...size` to `size...0`). The reason is that this sometimes skips indices when removing an item. You can therefore end up with feeds that have counter 0 and are still displayed."}, {"instruction": "Here is an example code review: 'how does that happen?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -620,7 +620,7 @@ def execute_reentrant_pipeline(pipeline, typed_environment, throw_on_error, reen def get_subset_pipeline(pipeline, solid_subset): check.inst_param(pipeline, 'pipeline', PipelineDefinition) check.opt_list_param(solid_subset, 'solid_subset', of_type=str) - return pipeline if solid_subset is None else build_sub_pipeline(pipeline, solid_subset) + return pipeline if not solid_subset else build_sub_pipeline(pipeline, solid_subset) def create_typed_environment(pipeline, environment=None):", "output": "this is a behavior change. solid_subset=[] represents an empty pipeline where as solid_subset=None is the full pipeline"}, {"instruction": "Here is an example code review: 'This was introduced recently for the Hadoop 3 upgrade. Copy/paste error but definitely causing some of the new test failures.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -318,8 +318,7 @@ Licensed under the MIT License. See License.txt in the project root for license { foreach (var unmatchedSetting in CustomSettings.Keys) { - Logger.LogError(new ArgumentException(unmatchedSetting), - Resources.ParameterIsNotValid, unmatchedSetting); + Logger.LogWarning(Resources.ParameterIsNotValid, unmatchedSetting); } } ErrorManager.ThrowErrors();", "output": "this is a breaking change, any specific reason you want to do this?"}, {"instruction": "Here is an example code review: 'Looks like this is unused? Did you mean to call it when clearing the block journal?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -91,6 +91,8 @@ type nodeChainReader interface { GetTipSetStateRoot(tsKey types.SortedCidSet) (cid.Cid, error) HeadEvents() *ps.PubSub Load(context.Context) error + PutTipSetAndState(context.Context, *chain.TipSetAndState) error + SetHead(context.Context, types.TipSet) error Stop() } ", "output": "Blocking: we still want read write separation. Node functions should absolutely not write to the chain store and the interface should reflect that. Only the syncer should have this capability in production code. It should be no problem to keep casting chainForTest to a read-write interface, or doing other function decomposition and automatic casting tricks."}, {"instruction": "Here is an example code review: 'nit: this is a package-wide constant so better to narrow the scope like `allEventsSign`.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -22,7 +22,8 @@ const ( minimalPrefetchWorkerQueueSize int = 1 testBlockRetrievalWorkerQueueSize int = 5 testPrefetchWorkerQueueSize int = 1 - defaultOnDemandRequestPriority int = 100 + defaultOnDemandRequestPriority int = 1<<30 - 1 + lowestTriggerPrefetchPriority int = 1 // Channel buffer size can be big because we use the empty struct. workerQueueSize int = 1<<31 - 1 )", "output": "The PR description says the lowest on-demand request priority is `2^30`. Why the `-1` here?"}, {"instruction": "Here is an example code review: 'These logs should probably use the `LOGTAG`'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -609,6 +609,14 @@ bool Game::removeCreature(Creature* creature, bool isLogout/* = true*/) return true; } +void Game::executeDeath(uint32_t creatureId) +{ + Creature* creature = getCreatureByID(creatureId); + if (creature && !creature->isRemoved() && creature->getHealth() < 1) { + creature->onDeath(); + } +} + void Game::playerMoveThing(uint32_t playerId, const Position& fromPos, uint16_t spriteId, uint8_t fromStackPos, const Position& toPos, uint8_t count) {", "output": "checking health again? I think it is not necessary."}, {"instruction": "Here is an example code review: '`zap.String(image-provider, provider.Name())` should be in a same line.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -442,7 +442,18 @@ configRetry: log.Infof(Starting the Typha connection) err := typhaConnection.Start(context.Background()) if err != nil { - log.WithError(err).Fatal(Failed to connect to Typha) + log.WithError(err).Error(Failed to connect to Typha. Retrying...) + startTime := time.Now() + for err != nil && time.Since(startTime) < 30*time.Second { + // Set Ready to false and Live to true when unable to connect to typha + healthAggregator.Report(healthName, &health.HealthReport{Live: true, Ready: false}) + err = typhaConnection.Start(context.Background()) + log.WithError(err).Debug(Retrying to start Typha) + time.Sleep(1 * time.Second) + } + if err != nil { + log.WithError(err).Fatal(Failed to connect to Typha) + } } go func() { typhaConnection.Finished.Wait()", "output": "Need an `if err == nil {break}` above this line so that we don't log/sleep if the retry succeeds."}, {"instruction": "Here is an example code review: 'why not recycling? I Lru cache now recycling?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -0,0 +1,18 @@ +'use strict'; + +const assert = require('assert'); + +class ProvidedPromise { + set Promise(lib) { + assert.ok(typeof lib === 'function', `mongodb.Promise must be a function, got ${lib}`); + this._promise = lib; + } + get Promise() { + return this._promise; + } +} + +const provided = new ProvidedPromise(); +provided.Promise = global.Promise; + +module.exports = provided;", "output": "to reiterate my point above, this class is not the actual provided Promise, but rather something a user can provide a Promise to/with. I think a name like `PromiseProvider` is more appropriate."}, {"instruction": "Here is an example code review: 'You can put this in `kbfsOpsInit()` in you want, so we don't have to call it in every test.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -738,6 +738,12 @@ func addDep(s *scope, args []pyObject) pyObject { dep := core.ParseBuildLabelContext(string(args[1].(pyString)), s.pkg) exported := args[2].IsTruthy() target.AddMaybeExportedDependency(dep, exported, false, false) + // Queue this dependency if it'll be needed. + if target.State() > core.Inactive { + err := s.state.QueueTarget(dep, target.Label, true, false) + s.Assert(err == nil, %s, err) + } + // TODO(peterebden): Do we even need the following any more? s.pkg.MarkTargetModified(target) return None }", "output": "I guess we can only call this from a post-build function, but we might need to check that this target is to be built? I guess target A depends on B which has a post build. We `plz build :B` which adds C as a dep of A. Won't we queue C to be built even though it only needs to build if A needs to be built? That's kinda why I approached this the way I did. I trust you've thought about this but would be good to understand this a bit better."}, {"instruction": "Here is an example code review: 'What is the problem here? I feel we used this in a lot of places.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -123,7 +123,7 @@ def sndrcv(pks, pkt, timeout = None, inter = 0, verbose=None, chainCC=0, retry=0 if remaintime <= 0: break r = None - if arch.FREEBSD or arch.DARWIN: + if not (pks.__class__.__name__ == 'StreamSocket') and (arch.FREEBSD or arch.DARWIN): inp, out, err = select(inmask,[],[], 0.05) if len(inp) == 0 or pks in inp: r = pks.nonblock_recv()", "output": "You should use `isinstance()` instead of comparing the class name to a string."}, {"instruction": "Here is an example code review: 'Do you also need to check if Blockly.localConnection_ is non-null?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -15,6 +15,11 @@ axe.utils.isHidden = function isHidden(el, recursed) { return false; } + // do not exclude `video` or `audio` el's + if ([`VIDEO`, `AUDIO`].includes(el.nodeName.toUpperCase())) { + return false; + } + // 11 === Node.DOCUMENT_FRAGMENT_NODE if (el.nodeType === 11) { el = el.host; // grab the host Node", "output": "Why should audio and video elements always return `false` for `isHidden`?"}, {"instruction": "Here is an example code review: 'Revert this blank line'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -27,7 +27,7 @@ namespace Playground.Core Mvx.IoCProvider.RegisterSingleton<IMvxTextProvider>(new TextProviderBuilder().TextProvider); - RegisterAppStart<RootViewModel>(); + // RegisterAppStart<RootViewModel>(); } /// <summary>", "output": "This obviously won't work for all the other platforms."}, {"instruction": "Here is an example code review: 'Revert this blank line'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -15,7 +15,7 @@ public class ManipulationTest extends BasicJBehaveTest { @Override public InjectableStepsFactory stepsFactory() { - Map<String, Object> state = new HashMap<String, Object>(); + Map<String, Object> state = new HashMap<>(); return new InstanceStepsFactory(configuration(), new SharedSteps(state),", "output": "Isn't he diamond operator Java7+?"}, {"instruction": "Here is an example code review: 'Assigning capabilities to the field here is not the best idea. Semantically this field contains the capabilities returned by the browser after session start. So here we sould better amend capabilities and return them from `init` method to pass later to `startSession` method (that will assign the capabilities returned by the browser to the field).'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -159,6 +159,17 @@ public final class Require { return number; } + public static double positive(String argName, double number, String message) { + if (number <= 0) { + if (message == null) { + throw new IllegalArgumentException(argName +  must be greater than 0); + } else { + throw new IllegalArgumentException(message); + } + } + return number; + } + public static int positive(String argName, Integer number) { return positive(argName, number, null); }", "output": "Prefer adding a second `positive(String, double)` that delegates down to this three-param version. Using `null` in code is generally Not A Great Idea, and it looks ugly."}, {"instruction": "Here is an example code review: 'I'd feel a little safer if the first argument were a string, not a *string unless there's a particular reason for making it a pointer.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -474,7 +474,7 @@ func (rule removeCount) Name() string { func (rule removeCount) Pattern() plan.Pattern { return plan.Pat(universe.CountKind, plan.Any()) } -func (rule removeCount) Rewrite(ctx context.Context, node plan.Node) (plan.Node, bool, error) { +func (rule removeCount) Rewrite(ctx context.Context, node plan.Node, nextNodeId *int) (plan.Node, bool, error) { return node.Predecessors()[0], true, nil } ", "output": "This pattern, where we add a new parameter without using it, often indicates to me that we've got a leaky interface or abstraction. I see this pattern _a lot_ in this patch, so wondering you have thoughts about it."}, {"instruction": "Here is an example code review: 'Looks like this is unused? Did you mean to call it when clearing the block journal?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -164,10 +164,13 @@ func WriteWordpressConfig(wordpressConfig *WordpressConfig, filePath string) err return err } - // Ensure target directory is writable. + // Ensure target directory exists and is writeable dir := filepath.Dir(filePath) - err = os.Chmod(dir, 0755) - if err != nil { + if err = os.Chmod(dir, 0755); os.IsNotExist(err) { + if err = os.MkdirAll(dir, 0755); err != nil { + return err + } + } else if err != nil { return err } ", "output": "This seems like an improved pattern :)"}, {"instruction": "Here is an example code review: 'Since this is just a helper function to create text, perhaps this could live in a helper? I noticed that we have a few other error/message creators in the application controller as well, but I think this type of function should be re-factored to be part of a helper.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -127,16 +127,16 @@ class UserController < ApplicationController # valid OpenID and one the user has control over before saving # it as a password equivalent for the user. session[:new_user_settings] = params - openid_verify(params[:user][:openid_url], @user) + federated_verify(params[:user][:openid_url], @user) else update_user(@user, params) end - elsif using_open_id? + elsif using_federated_login? # The redirect from the OpenID provider reenters here # again and we need to pass the parameters through to # the open_id_authentication function settings = session.delete(:new_user_settings) - openid_verify(nil, @user) do |user| + federated_verify(nil, @user) do |user| update_user(user, settings) end end", "output": "`open_id_authentication` is no longer the name of the function, and it's not OpenID specific"}, {"instruction": "Here is an example code review: 'Why change the port from 0 to getAvailablePort()?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -243,10 +243,10 @@ void rai_qt::accounts::refresh_wallet_balance () balance = balance + (this->wallet.node.ledger.account_balance (transaction, key)); pending = pending + (this->wallet.node.ledger.account_pending (transaction, key)); } - auto final_text (std::string (Wallet balance (XRB): ) + wallet.format_balance (balance)); + auto final_text (std::string (Balance: ) + wallet.format_balance (balance)); if (!pending.is_zero ()) { - final_text += \\nWallet pending:  + wallet.format_balance (pending); + final_text += \\nPending:  + wallet.format_balance (pending); } wallet_balance_label->setText (QString (final_text.c_str ())); this->wallet.node.alarm.add (std::chrono::system_clock::now () + std::chrono::seconds (60), [this]() {", "output": "This didn't require corresponding changes to the test case(s)?"}, {"instruction": "Here is an example code review: 'Prefer double-quoted strings unless you need single quotes to avoid extra backslashes for escaping.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -509,6 +509,7 @@ type TaskConfig struct { Count Count `yaml:count` ExecuteCommand ExecuteCommand `yaml:exec` Variables map[string]string `yaml:variables` + EnvFile string `yaml:env_file` Secrets map[string]string `yaml:secrets` Storage Storage `yaml:storage` }", "output": "A question! I think `string` totally works, but what do you think of `*string` for consistency?"}, {"instruction": "Here is an example code review: 'is this test in the move tests? I see what you mean then - it works, but I wonder if we won't lose track that it's being tested here.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -25,6 +25,12 @@ import ( metav1 k8s.io/apimachinery/pkg/apis/meta/v1 ) +const ( + AnnotationClusterInfrastructureReady = aws.cluster.sigs.k8s.io/infrastructure-ready + AnnotationControlPlaneReady = aws.cluster.sigs.k8s.io/control-plane-ready + ValueReady = true +) + // AWSResourceReference is a reference to a specific AWS resource by ID, ARN, or filters. // Only one of ID, ARN or Filters may be specified. Specifying more than one will result in // a validation error.", "output": "Should this be: `aws.infrastructure.cluster.sigs.k8s.io` instead?"}, {"instruction": "Here is an example code review: 'If the label is not binary, should we rename this function?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -142,7 +142,7 @@ void PairLubricate::compute(int eflag, int vflag) Ef[2][2] = h_rate[2]/domain->zprd; Ef[0][1] = Ef[1][0] = 0.5 * h_rate[5]/domain->yprd; Ef[0][2] = Ef[2][0] = 0.5 * h_rate[4]/domain->zprd; - Ef[1][2] = Ef[2][1] = 0.5 * h_rate[3]/domain->zprd; + Ef[1][2] = Ef[2][1] = 0.5 * h_rate[3]/domain->xprd; // copy updated velocity/omega/angmom to the ghost particles // no need to do this if not shearing since comm->ghost_velocity is set", "output": "Not clear on why this change is correct."}, {"instruction": "Here is an example code review: 'These modifications allow BaseFile to translate into a SparkRow with the specID as a column'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -193,5 +193,10 @@ public final class ByteBuffersIndexInput extends IndexInput implements RandomAcc if (in == null) { throw new AlreadyClosedException(Already closed.); } - } + } + + @Override + public boolean isMMapped() { + return true; + } }", "output": "Hi Simon. Whether this should return true depends on what byte buffers are used? The same applies to ByteBufferIndexInput, actually... I don't think you can generally tell whether the ByteBuffers the input operates on come from a mmap call or from somewhere else (even direct buffers don't have to be a result of mmap)."}, {"instruction": "Here is an example code review: 'This obviously won't work for all the other platforms.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -54,6 +54,7 @@ storiesOf( 'PageSpeed Insights Module/Settings', module ) decorators: [ withRegistry, ], + padding: 0, } ) .add( 'View, open with all settings', ( args, { registry } ) => { return <Settings isOpen={ true } registry={ registry } />;", "output": "All stories in this file also need to have the default padding."}, {"instruction": "Here is an example code review: 'Is it safe to assume this surface is a toplevel?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -804,8 +804,10 @@ static void subsurface_handle_place_above(struct wl_client *client, return; } + assert(sibling->parent == subsurface->parent); + wl_list_remove(&subsurface->parent_pending_link); - wl_list_insert(&sibling->parent_pending_link, + wl_list_insert(sibling->parent_pending_link.prev, &subsurface->parent_pending_link); subsurface->reordered = true;", "output": "I don't think these asserts are necessary, because `subsurface_find_sibling` already searches in the parent. Or am I missing something?"}, {"instruction": "Here is an example code review: 'Put a comma after the last item of a multiline hash.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -0,0 +1,15 @@ +class Episode < ActiveRecord::Base + attr_accessible :title, :duration, :file, :description, :published_on, :notes, + :old_url, :file_size + + validates_presence_of :title, :duration, :file, :file_size, :description, + :published_on + + def self.published + where(published_on <= ?, Date.today).order('published_on desc') + end + + def full_title + Episode #{id}: #{title} + end +end", "output": "Should this be `number` instead of `id`?"}, {"instruction": "Here is an example code review: 'maybe say returns the default cost method that returns an object of cost 1.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1569,12 +1569,11 @@ NATable *BindWA::getNATable(CorrName& corrName, ((QualifiedName&)(table->getTableName())).setIsVolatile(TRUE); } - // For now, do not allow access through the Trafodion external name created for - // the HIVE object unless the inDDL flag is set. inDDL is set for drop - // table and SHOWDDL statements. - // TDB - may want to merge the Trafodion version with the HIVE version. - // TDB - similar operation may be needed for external HBase tables - if ((table) && (table->isExternalTable() && (! bindWA->inDDL()))) + // For now, don't allow access through the Trafodion external name created for + // native HIVE or HBASE objects unless the allowExternalTables flag is set. + // allowExternalTables is set for drop table and SHOWDDL statements. + // TDB - may want to merge the Trafodion version with the native version. + if ((table) && (table->isExternalTable() && (! bindWA->allowExternalTables()))) { *CmpCommon::diags() << DgSqlCode(-4258) << DgTableName(table->getTableName().getQualifiedNameAsAnsiString());", "output": "I have forgotten why we thought this restriction is necessary. A user registers a Hive/HBase table with us but is not able to use the table with the registered name in DML. Will UPDATE STATs will be on the original name too (and update stats code will find out registered name and use it for Table_uid?). This was the registration concept is almost like an internal implementation idea, at some point could even be done by some utility program for all existing Hive/hBase tables, and the user need not be aware of it? I am struggling with a user would want to register a table, if they cannot use it by that name."}, {"instruction": "Here is an example code review: 'maybe say returns the default cost method that returns an object of cost 1.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -40,6 +40,18 @@ struct ase_cfg_t *cfg; +int app2sim_alloc_rx; // app2sim mesaage queue in RX mode +int sim2app_alloc_tx; // sim2app mesaage queue in TX mode +int app2sim_mmioreq_rx; // MMIO Request path +int sim2app_mmiorsp_tx; // MMIO Response path +int app2sim_umsg_rx; // UMSG message queue in RX mode +int app2sim_portctrl_req_rx; // Port Control messages in Rx mode +int app2sim_dealloc_rx; +int sim2app_dealloc_tx; +int sim2app_portctrl_rsp_tx; +int sim2app_intr_request_tx; +int intr_event_fds[MAX_USR_INTRS]; + int glbl_test_cmplt_cnt; // Keeps the number of session_deinits received volatile int sockserver_kill;", "output": "Should most of these non-globals be static?"}, {"instruction": "Here is an example code review: 'This is a way better method name.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -14,6 +14,14 @@ class TestFakerName < Test::Unit::TestCase assert @tester.name_with_middle.match(/(\\w+\\.? ?){3,4}/) end + def test_first_name + assert @tester.first_name.match(/(\\w+\\.? ?){3,4}/) + end + + def test_last_name + assert @tester.last_name.match(/(\\w+\\.? ?){3,4}/) + end + def test_prefix assert @tester.prefix.match(/[A-Z][a-z]+\\.?/) end", "output": "Please do not approve PRs without tests!!!!"}, {"instruction": "Here is an example code review: 'how does that happen?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -48,7 +48,7 @@ class WebEngineView(QWebEngineView): else: profile = webenginesettings.default_profile page = WebEnginePage(theme_color=theme_color, profile=profile, - parent=self) + parent=self, win_id=win_id) self.setPage(page) def shutdown(self):", "output": "Now that you handle this in `webenginetab.py` you can undo all the changes in this file."}, {"instruction": "Here is an example code review: '@cijothomas I needed a way to set the Exporter.ParentProvider when the Processor's gets set. Internal to SDK though.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -30,7 +30,11 @@ import org.springframework.context.annotation.AnnotationConfigApplicationContext public class JavaFXApplication extends Application { public static void main(String[] args) { - Application.launch(JavaFXApplication.class); + try { + Application.launch(JavaFXApplication.class); + } catch (Exception e) { + e.printStackTrace(); + } } @Override", "output": "I think we should log the exception to a log file instead of printing it. The current behavior (not catching the exception) should lead to an automatic print of the exception to the terminal/console."}, {"instruction": "Here is an example code review: '`ds.GenericDeploymentConfig.DeploymentNotification` in L128 is nullable.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -57,7 +57,7 @@ func (r *Helper) Apply(obj []byte) (ApplyResult, error) { if err != nil { r.logger.WithError(err). WithField(stdout, ioStreams.Out.(*bytes.Buffer).String()). - WithField(stderr, ioStreams.ErrOut.(*bytes.Buffer).String()).Error(running the apply command failed) + WithField(stderr, ioStreams.ErrOut.(*bytes.Buffer).String()).Warn(running the apply command failed) return , err } return changeTracker.GetResult(), nil", "output": "These changes to the resource helpers have some more far-reaching implications as they also affect calls made in hive-operator, I believe. It's probably OK still, though. Ideally, the resource helper would not be the one doing the logging, since it cannot know the severity, but that is well beyond something that we should tackle for this PR. I would rather have the hive-operator log warnings than have the syncsetinstance controller log errors."}, {"instruction": "Here is an example code review: '` $event->getAvatarFilename()` this function return `string` or `null`. In this place ` $event->getAvatarFilename()->getValue()` return `Fatal error `'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -167,7 +167,7 @@ class ExportCategoryTableMap extends TableMap */ public function buildRelations() { - $this->addRelation('Export', '\\\\Thelia\\\\Model\\\\Export', RelationMap::ONE_TO_MANY, array('id' => 'export_category_id', ), 'CASCADE', 'RESTRICT', 'Exports'); + $this->addRelation('Export', '\\\\Thelia\\\\Model\\\\Export', RelationMap::ONE_TO_MANY, array('id' => 'export_category_id', ), null, null, 'Exports'); $this->addRelation('ExportCategoryI18n', '\\\\Thelia\\\\Model\\\\ExportCategoryI18n', RelationMap::ONE_TO_MANY, array('id' => 'id', ), 'CASCADE', null, 'ExportCategoryI18ns'); } // buildRelations() ", "output": "do you really want to change the behavior on foreign key ?"}, {"instruction": "Here is an example code review: 'I'm not certain that `res`+`utl` isn't a thing.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -183,7 +183,8 @@ void event_batch_destroy (struct event_batch *batch) if (batch->f) (void)flux_future_wait_for (batch->f, -1); if (batch->state_trans) { - event_publish_state (batch->event, batch->state_trans); + if (json_array_size (batch->state_trans) > 0) + event_publish_state (batch->event, batch->state_trans); json_decref (batch->state_trans); } if (batch->responses) {", "output": "Looks like my bad. Thanks for fixing!"}, {"instruction": "Here is an example code review: 'No need to have `xrc20` alias'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -82,6 +82,7 @@ class Command: no_cmd_split: If true, ';;' to split sub-commands is ignored. backend: Which backend the command works with (or None if it works with both) + no_replace_variables: Whether or not to replace variables like {url} _qute_args: The saved data from @cmdutils.argument _needs_js: Whether the command needs javascript enabled _modes: The modes the command can be executed in.", "output": "I think Don't replace variables ... would be cleaner."}, {"instruction": "Here is an example code review: 'Update the docstring.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -82,8 +82,7 @@ class MPLPlot(DimensionedPlot): sublabel_size = param.Number(default=18, doc= Size of optional subfigure label.) - projection = param.ObjectSelector(default=None, - objects=['3d', 'polar', None], doc= + projection = param.Parameter(default=None, doc= The projection of the plot axis, default of None is equivalent to 2D plot, '3d' and 'polar' are also supported.) ", "output": "Do you validate the possible strings? I've not read the code below but we should make sure if a string is supplied it is validate..."}, {"instruction": "Here is an example code review: 'IMO this edge case handling could remain here, just instead of overwriting the `n.nodeType`, the `makeEdgeType` method of `n` should be called, so `n.nodeType = nodeTypeEdge` -> `n.makeEdge()`'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -40,13 +40,11 @@ func AddDiskImportSteps(w *daisy.Workflow, dataDiskInfos []ovfutils.DiskInfo) { for i, dataDiskInfo := range dataDiskInfos { dataDiskIndex := i + 1 dataDiskFilePath := dataDiskInfo.FilePath - diskNames = append( - diskNames, - fmt.Sprintf(%v-data-disk-%v, w.Vars[instance_name].Value, dataDiskIndex)) + diskNames = append(diskNames, generateDataDiskName(w.Vars[instance_name].Value, dataDiskIndex)) setupDataDiskStepName := fmt.Sprintf(setup-data-disk-%v, dataDiskIndex) - diskImporterDiskName := fmt.Sprintf(disk-importer-%v, dataDiskIndex) - scratchDiskDiskName := fmt.Sprintf(disk-importer-scratch-%v-%v, dataDiskIndex, w.Vars[instance_name].Value) + diskImporterDiskName := fmt.Sprintf(disk-importer-%v-%v, dataDiskIndex, w.ID()) + scratchDiskDiskName := fmt.Sprintf(disk-importer-scratch-%v-%v, dataDiskIndex, w.ID()) setupDataDiskStep := daisy.NewStepDefaultTimeout(setupDataDiskStepName, w) setupDataDiskStep.CreateDisks = &daisy.CreateDisks{", "output": "I'd recommend using generateDataDiskName here as well -- might as well benefit from the safety that it gives to protect yourself from future changes to w.ID()."}, {"instruction": "Here is an example code review: 'This set of changes is the one part of this that I'm not completely sure is valid. Can someone look over this to make sure I got the E's right?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -29,6 +29,11 @@ import java.util.Map; * @param <F> the concrete Java class of a ContentFile instance. */ public interface ContentFile<F> { + /** + * Returns the ordinal position of the file in a manifest, or null if it was not read from a manifest. + */ + Long pos(); + /** * Returns id of the partition spec used for partition metadata. */", "output": "qq: do we want to include anything in the name to indicate that it is a position in the manifest?"}, {"instruction": "Here is an example code review: 'Just wondering... The two kinds of notifications are now quite different (Channel, text, maybe even icon). Would it make sense to extract the auto download notification to a new class instead of handling everything in the existing `notificationManager`? I have not checked if this will lead to a lot of code duplication, though.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -969,8 +969,11 @@ public class VRBrowserActivity extends PlatformActivity implements WidgetManager GleanMetricsService.stopImmersive(); Handler handler = new Handler(Looper.getMainLooper()); handler.postDelayed(() -> { - mWindows.resumeCompositor(); - Log.d(LOGTAG, Compositor Resumed); + if (!mWindows.isPaused()) { + Log.d(LOGTAG, Compositor resume begin); + mWindows.resumeCompositor(); + Log.d(LOGTAG, Compositor resume end); + } }, 20); } ", "output": "These logs should probably use the `LOGTAG`"}, {"instruction": "Here is an example code review: 'delete the empty line github.com/pkg/errors should be grouped with other third party packages same for the rest'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -28,10 +28,10 @@ import ( github.com/mysteriumnetwork/node/core/connection github.com/mysteriumnetwork/node/services/wireguard github.com/mysteriumnetwork/node/services/wireguard/key - github.com/mysteriumnetwork/wireguard-go/device - github.com/mysteriumnetwork/wireguard-go/tun github.com/pkg/errors github.com/rs/zerolog/log + golang.zx2c4.com/wireguard/device + golang.zx2c4.com/wireguard/tun ) const (", "output": "From this, it was clear, that we are using our version of wireguard-go. And now it looks like we are using original packages which is confusing."}, {"instruction": "Here is an example code review: 'I think we should log the exception to a log file instead of printing it. The current behavior (not catching the exception) should lead to an automatic print of the exception to the terminal/console.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -43,7 +43,7 @@ namespace Nethermind.JsonRpc public static ResultWrapper<T> Fail(Exception e) { - return new() { Result = Result.Fail(e.ToString()), ErrorCode = ErrorCodes.InternalError}; + return new() { Result = Result.Fail(e.Message), ErrorCode = ErrorCodes.InternalError}; } public static ResultWrapper<T> Fail(string error, int errorCode, T outputData)", "output": "Any particular reason for this? This potentially will make harder to investigate users issues"}, {"instruction": "Here is an example code review: 'Use `response.asJsonObject()` instead. Also, use `put()` instead of `putOpt()`, `null` as a value is fine.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -999,7 +999,8 @@ Blockly.BlockSvg.prototype.updatePreviews = function(closestConnection, // grayed-out blocks instead of highlighting the connection; for compatibility // with Web Blockly the name highlightedConnection will still be used. if (Blockly.highlightedConnection_ && - Blockly.highlightedConnection_ != closestConnection) { + (Blockly.highlightedConnection_ != closestConnection || + Blockly.localConnection_ != localConnection)) { if (Blockly.insertionMarker_ && Blockly.insertionMarkerConnection_) { Blockly.BlockSvg.disconnectInsertionMarker(); }", "output": "Do you also need to check if Blockly.localConnection_ is non-null?"}, {"instruction": "Here is an example code review: 'Is this a breaking change, or is the API private?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1,5 +1,6 @@ module RSpec module Core + # Internal container for global non-configuration data class World include RSpec::Core::Hooks", "output": "Not really a container, and it's not just about non-config data, not sure of a better description, @myronmarston ?"}, {"instruction": "Here is an example code review: 'It looks like there's a new `isNavigatingTo( url )` selector for this very purpose so let's use this here instead. This way we just need to use the one selector rather than two. Let's assign that to a similar-named variable here (e.g. `isNavigatingToPostResetURL`) rather than the prop it's used with.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -3,6 +3,8 @@ const { basename } = require('./path-utils'); const shim = require('./shim').default; const JoplinError = require('./JoplinError').default; const { Buffer } = require('buffer'); +const { Readable } = require('stream').Readable; +const { GetObjectCommand, ListObjectsV2Command, HeadObjectCommand, PutObjectCommand, DeleteObjectCommand, DeleteObjectsCommand } = require(@aws-sdk/client-s3); const S3_MAX_DELETES = 1000; ", "output": "The desktop app will load this fine. on iOS I get `TypeError: undefined is not an object (evaluating '_$$_REQUIRE(_dependencyMap[8], stream).Readable.Readable')` if I change it to `const Readable = require('stream').Readable;` or `const { Readable } = require('stream');` I get undefined errors from the stream on iOS: `[TypeError: stream.on is not a function. (In 'stream.on(data, function (chunk) { return chunks.push(chunk); })', 'stream.on' is undefined)]` What am I missing?"}, {"instruction": "Here is an example code review: 'This isn't really easy to read.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -93,7 +93,9 @@ func (m *MockStorer) Put(ctx context.Context, mode storage.ModePut, chs ...swarm po := swarm.Proximity(ch.Address().Bytes(), m.baseAddress) m.bins[po]++ } - m.store[ch.Address().String()] = ch.Data() + b := make([]byte, len(ch.Data())) + copy(b, ch.Data()) + m.store[ch.Address().String()] = b m.modePut[ch.Address().String()] = mode // pin chunks if needed", "output": "this is needed since the chunk feeder shares memory across calls to the pipeline. this is in order to avoid multiple allocations. this change mimics the behavior of shed and localstore, and copies the data from the call into the in-memory store"}, {"instruction": "Here is an example code review: 'Looks like this is unused? Did you mean to call it when clearing the block journal?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -42,6 +42,10 @@ import ( go.uber.org/yarpc/yarpcerrors ) +func init() { + opentracing.SetGlobalTracer(nil) +} + func TestHandlerSuccess(t *testing.T) { mockCtrl := gomock.NewController(t) defer mockCtrl.Finish()", "output": "wut. We can do this at the beginning of tests if we want right? Why are we depending on init?"}, {"instruction": "Here is an example code review: 'Looks like this is unused? Did you mean to call it when clearing the block journal?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1403,9 +1403,12 @@ func (c *client) processConnect(arg []byte) error { c.mu.Lock() acc := c.acc c.mu.Unlock() + srv.mu.Lock() if acc != nil && acc != srv.gacc { + srv.mu.Unlock() return ErrTooManyAccountConnections } + srv.mu.Unlock() } c.authViolation() return ErrAuthentication", "output": "Same trick here IMO."}, {"instruction": "Here is an example code review: 'This is a way better method name.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -108,10 +108,11 @@ module Selenium def initialize(source, duration, x, y, element: nil, origin: nil) super(source) + @duration = duration * 1000 @x_offset = x @y_offset = y - @origin = element || origin + @origin = origin || POINTER end def type", "output": "Should be `@origin = element || origin || POINTER`"}, {"instruction": "Here is an example code review: '`ds.GenericDeploymentConfig.DeploymentNotification` in L128 is nullable.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -50,11 +50,14 @@ func NewUpgradeCStorSPCJob() *cobra.Command { Long: cstorSPCUpgradeCmdHelpText, Example: `upgrade cstor-spc --spc-name <spc-name>`, Run: func(cmd *cobra.Command, args []string) { + util.CheckErr(options.RunCStorSPCUpgradeChecks(cmd, args), util.Fatal) options.resourceKind = storagePoolClaim - util.CheckErr(options.RunPreFlightChecks(cmd), util.Fatal) - util.CheckErr(options.RunCStorSPCUpgradeChecks(cmd), util.Fatal) - util.CheckErr(options.InitializeDefaults(cmd), util.Fatal) - util.CheckErr(options.RunCStorSPCUpgrade(cmd), util.Fatal) + if options.cstorSPC.spcName !=  { + singleCstorSPCUpgrade(cmd) + } + if len(args) != 0 { + bulkCstorSPCUpgrade(cmd, args) + } }, } ", "output": "this example needs a fix?"}, {"instruction": "Here is an example code review: 'I don't think these asserts are necessary, because `subsurface_find_sibling` already searches in the parent. Or am I missing something?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -248,9 +248,9 @@ static void close(struct roots_view *view) { struct wlr_xdg_surface *surface = view->xdg_surface; struct wlr_xdg_popup *popup = NULL; wl_list_for_each(popup, &surface->popups, link) { - wlr_xdg_surface_send_close(popup->base); + wlr_xdg_popup_destroy(popup->base); } - wlr_xdg_surface_send_close(surface); + wlr_xdg_toplevel_send_close(surface); } static void destroy(struct roots_view *view) {", "output": "Is it safe to assume this surface is a toplevel?"}, {"instruction": "Here is an example code review: 'Great God, I have a question. This .nebula_history file is used to save history commands. Is there a file size limit? When the file is large, does it take a long time to start initialization (loadHistory)? How did you think about this? Thx.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -225,6 +225,16 @@ projCtx pj_ctx_alloc() return new (std::nothrow) projCtx_t(*pj_get_default_ctx()); } +/************************************************************************/ +/* pj_ctx_clone() */ +/************************************************************************/ + +projCtx pj_ctx_clone( projCtx ctx ) + +{ + return new (std::nothrow) projCtx_t(*ctx); +} + /************************************************************************/ /* pj_ctx_free() */ /************************************************************************/", "output": "we don't need that function"}, {"instruction": "Here is an example code review: 'Great God, I have a question. This .nebula_history file is used to save history commands. Is there a file size limit? When the file is large, does it take a long time to start initialization (loadHistory)? How did you think about this? Thx.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -72,6 +72,13 @@ public enum Platform { } }, + WIN10(windows 10, win10) { + @Override + public Platform family() { + return WINDOWS; + } + }, + MAC(mac, darwin, os x) {}, SNOW_LEOPARD(snow leopard, os x 10.6) {", "output": "we'll also have to think about adding Windows Server 2014 or whatever they come up with later."}, {"instruction": "Here is an example code review: 'Revert this blank line'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -35,6 +35,9 @@ public interface ExecutorLoader { Map<Integer, Pair<ExecutionReference, ExecutableFlow>> fetchActiveFlows() throws ExecutorManagerException; + Pair<ExecutionReference, ExecutableFlow> fetchActiveFlowByExecId(int execId) + throws ExecutorManagerException; + List<ExecutableFlow> fetchFlowHistory(int skip, int num) throws ExecutorManagerException; ", "output": "curious do we have an API to fetch an inactive flow?"}, {"instruction": "Here is an example code review: 'Just wondering... The two kinds of notifications are now quite different (Channel, text, maybe even icon). Would it make sense to extract the auto download notification to a new class instead of handling everything in the existing `notificationManager`? I have not checked if this will lead to a lot of code duplication, though.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -116,10 +116,6 @@ function upgradeToVNodes(arr, offset) { if (Array.isArray(obj)) { upgradeToVNodes(obj); } - else if (obj && typeof obj==='object' && !isValidElement(obj) && ((obj.props && obj.type) || obj.text!=null)) { - if (obj.text) continue; - arr[i] = createElement(obj.type, obj.props, obj.props.children); - } } } ", "output": "This branch is not needed anymore because every `vnode` that passes through `h` in compat or core will have the `$$typeof`-property now ."}, {"instruction": "Here is an example code review: 'The desktop app will load this fine. on iOS I get `TypeError: undefined is not an object (evaluating '_$$_REQUIRE(_dependencyMap[8], stream).Readable.Readable')` if I change it to `const Readable = require('stream').Readable;` or `const { Readable } = require('stream');` I get undefined errors from the stream on iOS: `[TypeError: stream.on is not a function. (In 'stream.on(data, function (chunk) { return chunks.push(chunk); })', 'stream.on' is undefined)]` What am I missing?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -0,0 +1,16 @@ +const { getComposedParent } = axe.commons.dom; + +function shouldMatchElement(el) { + if (!el) { + return true; + } + const ariaHiddenValue = el.getAttribute('aria-hidden') + ? el.getAttribute('aria-hidden') + : null; + if (ariaHiddenValue === null) { + return shouldMatchElement(getComposedParent(el)); + } + return false; +} + +return shouldMatchElement(getComposedParent(node));", "output": "Did you mean to use `hasAttribute`? You shouldn't. This does not improve performance and it messes with the readability."}, {"instruction": "Here is an example code review: 'I usually set idea to never use wildcard import such as `import java.util.*;` Now i use setting from javaslang standard.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -37,13 +37,14 @@ import pytest import py.path # pylint: disable=no-name-in-module import helpers.stubs as stubsmod +from helpers.utils import CallbackChecker from qutebrowser.config import config, configdata, configtypes, configexc from qutebrowser.utils import objreg, standarddir from qutebrowser.browser.webkit import cookies from qutebrowser.misc import savemanager, sql from qutebrowser.keyinput import modeman -from PyQt5.QtCore import pyqtSignal, QEvent, QSize, Qt, QObject +from PyQt5.QtCore import QEvent, QSize, Qt from PyQt5.QtGui import QKeyEvent from PyQt5.QtWidgets import QWidget, QHBoxLayout, QVBoxLayout from PyQt5.QtNetwork import QNetworkCookieJar", "output": "Please import modules and not classes (except for Qt stuff)."}, {"instruction": "Here is an example code review: 'I think we should log the exception to a log file instead of printing it. The current behavior (not catching the exception) should lead to an automatic print of the exception to the terminal/console.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -20,6 +20,11 @@ public class DummyJavaNode extends AbstractJavaNode { super(id); } + @Override + public void setImage(String image) { + super.setImage(image); + } + @Override public Object jjtAccept(JavaParserVisitor visitor, Object data) { return data;", "output": "Hm... why do we have a DummyJavaNode in src/main? Looks like, this should have gone into src/test...."}, {"instruction": "Here is an example code review: 'Not really a container, and it's not just about non-config data, not sure of a better description, @myronmarston ?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -14,6 +14,7 @@ See the License for the specific language governing permissions and limitations under the License. */ +// Package v1alpha1 package v1alpha1 // CasKey is used for all cas specific annotation keys", "output": "This seems meaningless. If we cannot add any info let us remove this."}, {"instruction": "Here is an example code review: 'Do we need to put this on the Call? We only need the API communication between the Encoding and the Transports which is currently done through the Transport.Request. The Call is used by users right?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -493,6 +493,14 @@ func (c *Container) GetLabels() map[string]string { return c.labels } +// GetPorts gets the ports for a container +func (c *Container) GetPorts() []PortBinding { + c.lock.RLock() + defer c.lock.RUnlock() + + return c.Ports +} + // HealthStatusShouldBeReported returns true if the health check is defined in // the task definition func (c *Container) HealthStatusShouldBeReported() bool {", "output": "Can you rename `Ports` to `PortsUnsafe`?"}, {"instruction": "Here is an example code review: 'Put a comma after the last item of a multiline hash.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -0,0 +1,10 @@ +module ReturnToHelper + def make_return_to(name, path) + sig = OpenSSL::HMAC.digest( + OpenSSL::Digest::SHA256.new, + Rails.application.secrets.secret_key_base, + name + $ + path + ) + {name: name, path: path, sig: Base64.urlsafe_encode64(sig)} + end +end", "output": "This feels like it could be moved out to your first gem!"}, {"instruction": "Here is an example code review: 'Revert this blank line'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -44,7 +44,7 @@ public abstract class NewSessionQueue implements HasReadyState { public abstract boolean offerFirst(HttpRequest request, RequestId requestId); - public abstract Optional<HttpRequest> poll(); + public abstract Optional<HttpRequest> poll(RequestId requestId); public abstract int clear(); ", "output": "The expected behaviour for `poll` would be to match what `Deque` does, which is: > Retrieves and removes the head of the queue represented by this deque As such, you shouldn't need the `RequestId` here."}, {"instruction": "Here is an example code review: 'Why should audio and video elements always return `false` for `isHidden`?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -7,4 +7,17 @@ axe.utils.toArray = function (thing) { 'use strict'; return Array.prototype.slice.call(thing); -}; +}; + + +/** + * Creates an array without duplicate values from 2 array inputs + * @param {Array} arr1 First array + * @param {Array} arr2 Second array + * @return {Array} + */ +axe.utils.uniqueArray = (arr1, arr2) => { + return arr1.concat(arr2).filter((elem, pos, arr) => { + return arr.indexOf(elem) === pos; + }); +};", "output": "This is super minor, but it'd be nice if this iterated over an arbitrary number of array inputs."}, {"instruction": "Here is an example code review: 'maybe say returns the default cost method that returns an object of cost 1.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1676,9 +1676,10 @@ _tmain(int argc, TCHAR *targv[]) } # ifdef UNIX /* i#1676: detect whether under gdb */ - _snprintf(buf, BUFFER_SIZE_ELEMENTS(buf), /proc/%d/exe, getppid()); - NULL_TERMINATE_BUFFER(buf); - i = readlink(buf, buf, BUFFER_SIZE_ELEMENTS(buf)); + char path_buf[MAXIMUM_PATH]; + _snprintf(path_buf, BUFFER_SIZE_ELEMENTS(path_buf), /proc/%d/exe, getppid()); + NULL_TERMINATE_BUFFER(path_buf); + i = readlink(path_buf, buf, BUFFER_SIZE_ELEMENTS(buf)); if (i > 0) { if (i < BUFFER_SIZE_ELEMENTS(buf)) buf[i] = '\\0';", "output": "What is the problem here? The commit message has strange wording readlink is defined with restrict pointers: do you mean restricted? Is that a well-defined language term? I'm not sure what it means."}, {"instruction": "Here is an example code review: 'I usually set idea to never use wildcard import such as `import java.util.*;` Now i use setting from javaslang standard.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -17,6 +17,7 @@ package com.google.api.codegen.util.ruby; import com.google.api.codegen.util.Name; import com.google.api.codegen.util.NameFormatter; import com.google.api.codegen.util.NamePath; +import com.google.common.collect.ImmutableSet; /** * The NameFormatter for Ruby.", "output": "Why are we not wrapping here?"}, {"instruction": "Here is an example code review: 'Why do you think that it is necessary to create this class?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -2,12 +2,10 @@ namespace Shopsys\\FrameworkBundle\\Model\\Product\\Filter; -use Shopsys\\FrameworkBundle\\Model\\Product\\Parameter\\Parameter; - class ParameterFilterData { /** - * @var \\Shopsys\\FrameworkBundle\\Model\\Product\\Parameter\\Parameter + * @var \\Shopsys\\FrameworkBundle\\Model\\Product\\Parameter\\Parameter|null */ public $parameter; ", "output": "I though that all data objects are being unified in the fashion where all default values are initialized in constructor, are not they?"}, {"instruction": "Here is an example code review: 'We've avoided including h2o headers in BPF programs because it's a runtime dependency. However, IIRC, this is because h2olog was maintained in the separate repository so that h2olog did not know where h2o was installed. Now h2olog can use `H2O_ROOT`, we should add it to BCC's `cflags` in order to include h2o headers in BPF programs.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -22,16 +22,16 @@ var sourceHashes = map[string]string{ libflux/flux-core/src/ast/flatbuffers/mod.rs: 00c75dc1da14487953a4a017616fb8a237fe3da437c876f1328532dd7906f015, libflux/flux-core/src/ast/flatbuffers/monotype.rs: 4e82aae8e7edb8e230302241fe702ece9ae84fc708003c24709c2ea944cfaae8, libflux/flux-core/src/ast/flatbuffers/tests.rs: ea85b78049f0c3d79daedcf9e171ccb00d0a596d1a643aa218590c99e6b160bc, - libflux/flux-core/src/ast/mod.rs: 676e22d24cd7a97525688ed391a980d08b4bee40c5b5067d187f3ae6d66210ca, + libflux/flux-core/src/ast/mod.rs: 29b25b75a01cf1e1ac2b52d99b91986cec32011dc55af1ffd7f145838fce858d, libflux/flux-core/src/ast/tests.rs: bc7f77d569d8bbd4b9d00653f48bacd47eed46f53024dce836d3c8bbb6a80555, libflux/flux-core/src/ast/walk/mod.rs: e8a03023d7426bcf6dfdb1a61ac3263f5cf9194a595a1584dff7c899d06562f1, libflux/flux-core/src/ast/walk/tests.rs: f7b2d7dd5643bb795a86c04b6979b136b0de46b52b213caff094aed6d204a05d, libflux/flux-core/src/formatter/mod.rs: 945736a4ad87adb6a3f359b6f2da6e5492b3cb0efd282e277303e2acae137763, libflux/flux-core/src/formatter/tests.rs: b0a10998a65fc4b54a8f68b3a0ed186d8548ba3d7638f911eb188d2ce485206f, libflux/flux-core/src/lib.rs: d19b7054e07f234c107d457030a0031374c123fe14a84a5b8e35537d138bac7a, - libflux/flux-core/src/parser/mod.rs: e3f11fe29f47271b5c04accc2d7efa35e1dc62c6de036bf0cc0cccda5e4742e8, + libflux/flux-core/src/parser/mod.rs: daf24b2c439f4c7a6f138e2b25064a205aee73bb6cffc898df22dd0c962ca5df, libflux/flux-core/src/parser/strconv.rs: 748c82f6efc2eafaafb872db5b4185ce29aafa8f03ba02c4b84f4a9614e832d2, - libflux/flux-core/src/parser/tests.rs: e3a7c9222f90323a7ea9b319bd84f96f66c6f115af6d199a0da332c894713ae4, + libflux/flux-core/src/parser/tests.rs: 43a1e5d3de85d76da2107544e417f583a1f66c20910286285b9645a309c42425, libflux/flux-core/src/scanner/mod.rs: 2e15c9e0a73d0936d2eaeec030b636786db6dbe7aab673045de3a3e815c49f8a, libflux/flux-core/src/scanner/scanner.rl: 530c062363b66daded3c521af44111b99ffee0eeb2a12ccffa8b8f349002d852, libflux/flux-core/src/scanner/scanner_generated.rs: d65dcc216ccbb88d8f2e261a994ba2789075e434cb7a0f5e39e390bee2821e5b,", "output": "Does this file actually need to be committed to git? Having to run `make generate` is rather tedious on each PR and it conflicts easily."}, {"instruction": "Here is an example code review: 'This seems like an improved pattern :)'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -440,18 +440,6 @@ func parseConfig(loc location.Location, opts options.Options) (interface{}, erro cfg.ProjectID = os.Getenv(GOOGLE_PROJECT_ID) } - if cfg.JSONKeyPath ==  { - if path := os.Getenv(GOOGLE_APPLICATION_CREDENTIALS); path !=  { - // Check read access - if _, err := ioutil.ReadFile(path); err != nil { - return nil, errors.Fatalf(Failed to read google credential from file %v: %v, path, err) - } - cfg.JSONKeyPath = path - } else { - return nil, errors.Fatal(No credential file path is set) - } - } - if err := opts.Apply(loc.Scheme, &cfg); err != nil { return nil, err }", "output": "We don't need this anymore, as Google's library handles various auth mechanisms for us. We'll be less explicit about why we're failing but we gain support for several authentication methods- swings and roundabouts!"}, {"instruction": "Here is an example code review: 'Great God, I have a question. This .nebula_history file is used to save history commands. Is there a file size limit? When the file is large, does it take a long time to start initialization (loadHistory)? How did you think about this? Thx.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1,11 +1,12 @@ package plugin type Config struct { - SocketPath string `yaml:path` - Volumes VolumesConfig `yaml:volume` + SocketDir string `yaml:socket_dir default:/run/docker/plugins` + Volumes VolumesConfig `yaml:volume` + GPUs map[string]map[string]string `yaml:GPUs` } type VolumesConfig struct { - Root string + Root string `yaml:root default:/var/lib/docker-volumes` Volumes map[string]map[string]string }", "output": "No need to speficy attribute here. Moreover in yaml it is default to use lowercase names."}, {"instruction": "Here is an example code review: 'Are all these namespaces required for this attribute?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -8,10 +8,12 @@ using System; using System.Collections.Generic; using System.Globalization; using System.IO; +using System.Linq; using System.Net; using System.Net.Http; using System.Text; using System.Threading; +using System.Threading.Tasks; using Task = System.Threading.Tasks.Task; namespace Microsoft.DotNet.Build.CloudTestTasks", "output": "In general I'm a trying to understand the reason behind this PR. Looks like if a blob (name) already exists we check if the contents are identical? In what scenarios this is not the case? When we want to publish a package/asset that has changed but still we want to use the same version?"}, {"instruction": "Here is an example code review: 'Looks like there is a closing parenthesis `)` missing here.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -151,7 +151,9 @@ class BlacklistRuleBook(bre.BaseRuleBook): lists: first one is IP addresses, second one is network blocks  - data = urllib2.urlopen(url).read() + req = urllib2.build_opener() + req.addheaders = [('User-Agent', 'Forseti blacklist rules engine agent')] + data = req.open(url).read() ip_addresses = re.findall(r'^[0-9]+(?:\\.[0-9]+){3}$', data, re.M) netblocks = re.findall(r'^[0-9]+(?:\\.[0-9]+){0,3}/[0-9]{1,2}$', data, re.M)", "output": "Can rename `req` to be `opener`, since that is the object, and it wraps `req` internally?"}, {"instruction": "Here is an example code review: 'this is a behavior change. solid_subset=[] represents an empty pipeline where as solid_subset=None is the full pipeline'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1405,6 +1405,8 @@ def getFormatFieldSpeech(attrs,attrsCache=None,formatConfig=None,unit=None,extra linePrefix=attrs.get(line-prefix) if linePrefix: textList.append(linePrefix) + breakpoint=attrs.get(breakpoint) + if breakpoint: textList.append(breakpoint) if attrsCache is not None: attrsCache.clear() attrsCache.update(attrs)", "output": "@MichaelDCurran, thoughts on adding a breakpoint format field attribute? It seems almost app specific, but I guess it does seem odd abusing line-prefix. Is there any more generic concept here?"}, {"instruction": "Here is an example code review: 'Do you validate the possible strings? I've not read the code below but we should make sure if a string is supplied it is validate...'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -539,7 +539,10 @@ class WebElement(object): @property def rect(self): A dictionary with the size and location of the element. - return self._execute(Command.GET_ELEMENT_RECT)['value'] + if self._w3c: + return self._execute(Command.GET_ELEMENT_RECT)['value'] + else: + return self.size, self.location @property def screenshot_as_base64(self):", "output": "This would return a tuple of two dictionaries. You need to combine them and return a dictionary"}, {"instruction": "Here is an example code review: 'No need to have `xrc20` alias'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -7,10 +7,14 @@ import ( errors fmt + github.com/aws/amazon-ecs-cli-v2/internal/pkg/archer + github.com/aws/amazon-ecs-cli-v2/internal/pkg/manifest + github.com/aws/amazon-ecs-cli-v2/internal/pkg/store/secretsmanager github.com/aws/amazon-ecs-cli-v2/internal/pkg/store/ssm github.com/aws/amazon-ecs-cli-v2/internal/pkg/term/color github.com/aws/amazon-ecs-cli-v2/internal/pkg/term/log github.com/aws/amazon-ecs-cli-v2/internal/pkg/term/prompt + github.com/aws/amazon-ecs-cli-v2/internal/pkg/workspace github.com/spf13/cobra )", "output": "What do you think of moving the example to the help text of the prompt? and the prompt itself can be What is your application's GitHub repository URL?"}, {"instruction": "Here is an example code review: 'why not recycling? I Lru cache now recycling?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -58,9 +58,12 @@ public class TracerTest { public void shouldBeAbleToCreateATracer() { List<SpanData> allSpans = new ArrayList<>(); Tracer tracer = createTracer(allSpans); + long timeStamp = 1593493828L; try (Span span = tracer.getCurrentContext().createSpan(parent)) { span.setAttribute(cheese, gouda); + span.addEvent(Grating cheese); + span.addEvent(Melting cheese, timeStamp); span.setStatus(Status.NOT_FOUND); } ", "output": "Break out tests for events into their own tests rather than placing them in other ones. That makes it easier for us to figure out where problems lie and to do a TDD-driven implementation over new APIs."}, {"instruction": "Here is an example code review: 'Seems we don't need it anymore.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -266,7 +266,7 @@ bool parse_it(Iterator &first, Iterator last, RDKit::RWMol &mol) { } else { if (!parse_atom_labels(first, last, mol)) return false; } - } else if ((first + 9) < last && + } else if (std::distance(first, last) > 9 && std::string(first, first + 9) == atomProp:) { first += 9; if (!parse_atom_props(first, last, mol)) return false;", "output": "Nice use of std::distance. I'm a bit worried about first += 9 though."}, {"instruction": "Here is an example code review: '`ds.GenericDeploymentConfig.DeploymentNotification` in L128 is nullable.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -578,8 +578,9 @@ func (c *Operator) syncNodeEndpoints(ctx context.Context) error { ObjectMeta: metav1.ObjectMeta{ Name: c.kubeletObjectName, Labels: c.config.Labels.Merge(map[string]string{ - k8s-app: kubelet, - app.kubernetes.io/name: kubelet, + k8s-app: kubelet, + app.kubernetes.io/name: kubelet, + app.kubernetes.io/part-of: prometheus-operator, }), }, Subsets: []v1.EndpointSubset{", "output": "Shouldn't this be `app.kubernetes.io/managed-by` as prometheus-operator manages this resource, but this resource isn't a part of prometheus-operator?"}, {"instruction": "Here is an example code review: 'Use `response.asJsonObject()` instead. Also, use `put()` instead of `putOpt()`, `null` as a value is fine.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -41,8 +41,9 @@ namespace Datadog.Trace.ClrProfiler if (parent != null && parent.Type == SpanTypes.Http && - parent.GetTag(Tags.HttpMethod).Equals(httpMethod, StringComparison.OrdinalIgnoreCase) && - parent.GetTag(Tags.HttpUrl).Equals(UriHelpers.CleanUri(requestUri, removeScheme: false, tryRemoveIds: false), StringComparison.OrdinalIgnoreCase)) + parent.GetTag(Tags.InstrumentationName) != null && + httpMethod.Equals(parent.GetTag(Tags.HttpMethod), StringComparison.OrdinalIgnoreCase) && + UriHelpers.CleanUri(requestUri, removeScheme: false, tryRemoveIds: false).Equals(parent.GetTag(Tags.HttpUrl), StringComparison.OrdinalIgnoreCase)) { // we are already instrumenting this, // don't instrument nested methods that belong to the same stacktrace", "output": "As long as we're being extra-vigilant about NREs, should we check that `httpMethod` and `requestUri` are not null?"}, {"instruction": "Here is an example code review: 'Why need alias?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -19,6 +19,7 @@ import ( github.com/iotexproject/iotex-core/cli/ioctl/cmd/node github.com/iotexproject/iotex-core/cli/ioctl/cmd/update github.com/iotexproject/iotex-core/cli/ioctl/cmd/version + xrc20 github.com/iotexproject/iotex-core/cli/ioctl/cmd/xrc20 ) // RootCmd represents the base command when called without any subcommands", "output": "No need to have `xrc20` alias"}, {"instruction": "Here is an example code review: 'I'm not certain that `res`+`utl` isn't a thing.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -172,6 +172,19 @@ def define_environment_cls(pipeline_def): ) +def context_cls_inst(pipeline_def): + check.inst_param(pipeline_def, 'pipeline_def', PipelineDefinition) + pipeline_name = camelcase(pipeline_def.name) + return SystemNamedDict( + name='{pipeline_name}.Context'.format(pipeline_name=pipeline_name), + fields={ + 'context': define_maybe_optional_selector_field( + define_context_context_cls(pipeline_name, pipeline_def.context_definitions) + ) + }, + ).inst() + + def define_expectations_config_cls(name): check.str_param(name, 'name') ", "output": "the naming convention I'm been adopting if `_type` for instances of these classes. So maybe `context_config_type` is a better name for this fn"}, {"instruction": "Here is an example code review: 'Is the concept of validators exclusive to IBFT2? I wonder if this category should be more explicitly linked to IBFT2.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -54,6 +54,7 @@ public class BlockMiner<C, M extends AbstractBlockCreator<C>> implements Runnabl private final ProtocolSchedule<C> protocolSchedule; private final Subscribers<MinedBlockObserver> observers; private final AbstractBlockScheduler scheduler; + private Boolean gpuMining = false; public BlockMiner( final Function<BlockHeader, M> blockCreatorFactory,", "output": "Don't call it GPU mining, call it `externalMining`, here and throughout."}, {"instruction": "Here is an example code review: 'Found one internal team is using this method. Will coordinate with them about the migration solution.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -252,6 +252,15 @@ return [ | folder - a folder prefix for storing all generated files inside. | path - the public path relative to the application base URL, | or you can specify a full URL path. + | + | For the 'media' resource you can also specify: + | + | imageMaxWidth - Resize all media manager image uploads to be + | within this with (in pixels, 0 = ignore) + | imageMaxHeight - Resize all media manager image uploads to be + | within this height (in pixels, 0 = ignore) + | imageQuality - Set this quality to all media manager image uploads + | (1-100) */ 'storage' => [", "output": "`within this with` typo, should be `within this width`"}, {"instruction": "Here is an example code review: 's/for use/to use for/'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -22,10 +22,12 @@ import ( ) // Prometheus defines a Prometheus deployment. +// +k8s:openapi-gen=true type Prometheus struct { metav1.TypeMeta `json:,inline` // Standard object\u2019s metadata. More info: // https://github.com/kubernetes/community/blob/master/contributors/devel/api-conventions.md#metadata + // +k8s:openapi-gen=false metav1.ObjectMeta `json:metadata,omitempty` // Specification of the desired behavior of the Prometheus cluster. More info: // https://github.com/kubernetes/community/blob/master/contributors/devel/api-conventions.md#spec-and-status", "output": "how come this is false?"}, {"instruction": "Here is an example code review: 'This branch is not needed anymore because every `vnode` that passes through `h` in compat or core will have the `$$typeof`-property now .'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -24,6 +24,19 @@ function node_require(module) { return require(module); } +function typeOf(obj) { + return ({}).toString.call(obj).match(/\\s(\\w+)/)[1].toLowerCase(); +} + +function checkTypes(args, types) { + args = [].slice.call(args); + for (var i = 0; i < types.length; ++i) { + if (typeOf(args[i]) !== types[i]) { + throw new TypeError('param ' + i + ' must be of type ' + types[i]); + } + } +} + const performFetch = typeof fetch === 'undefined' ? node_require('node-fetch') : fetch; const url_parse = require('url-parse');", "output": "How about `Object.prototype.toString`? Or using the `typeof` operator?"}, {"instruction": "Here is an example code review: 'Looks like this is unused? Did you mean to call it when clearing the block journal?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -83,6 +83,7 @@ type ReporterKBPKI struct { notifySyncBuffer chan *keybase1.FSPathSyncStatus suppressCh chan time.Duration canceler func() + ctx context.Context } // NewReporterKBPKI creates a new ReporterKBPKI.", "output": "I know @jzila suggested this, but I disagree: you're really not supposed to save a context in a struct. Can you get by with just saving the `Done()` channel instead? The `ctx` should continue to be passed around explicitly."}, {"instruction": "Here is an example code review: 'we'll also have to think about adding Windows Server 2014 or whatever they come up with later.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -12,12 +12,7 @@ namespace Microsoft.AspNet.Server.Kestrel.Networking { IsWindows = PlatformApis.IsWindows; - var isDarwinMono = -#if DNX451 - IsWindows ? false : PlatformApis.IsDarwin; -#else - false; -#endif + var isDarwinMono = !IsWindows && PlatformApis.IsDarwin; if (isDarwinMono) {", "output": "This check isn't right though."}, {"instruction": "Here is an example code review: 'Revert this blank line'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -96,6 +96,8 @@ public abstract class DynamicLangXApiView implements ViewModel { return missingDefaultServiceAddress() || missingDefaultServiceScopes(); } + public abstract String codeGenVersion(); + @Override public String resourceRoot() { return SnippetSetRunner.SNIPPET_RESOURCE_ROOT;", "output": "maybe `toolkitVersion` instead? It doesn't necessarily have to be called that in the generated code, but in the view model classes, I think it makes it clearer that it is the version of toolkit itself."}, {"instruction": "Here is an example code review: 'Why this deletion?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -230,15 +230,13 @@ module.exports = class XHRUpload extends Plugin { const body = opts.getResponseData(xhr.responseText, xhr) const uploadURL = body[opts.responseUrlFieldName] - const response = { + const uploadResp = { status: ev.target.status, body, uploadURL } - this.uppy.setFileState(file.id, { response }) - - this.uppy.emit('upload-success', file, body, uploadURL) + this.uppy.emit('upload-success', file, uploadResp) if (uploadURL) { this.uppy.log(`Download ${file.name} from ${file.uploadURL}`)", "output": "the response data was added intentionally in #612, i think we could keep the `setFileState` stuff here as a special case, at least for now "}, {"instruction": "Here is an example code review: 'Looks like this is unused? Did you mean to call it when clearing the block journal?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -134,7 +134,7 @@ func (s *stream) Read(p []byte) (int, error) { } else { select { case <-s.readChan: - case <-time.After(deadline.Sub(time.Now())): + case <-time.After(time.Until(deadline)): } } s.mutex.Lock()", "output": "This isn't really easy to read."}, {"instruction": "Here is an example code review: 'Can you judge the type of error?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -123,7 +123,7 @@ func (c *CStorVolumeReplicaController) cVREventHandler(operation common.QueueOpe err := volumereplica.DeleteVolume(fullVolName) if err != nil { - glog.Errorf(Error in deleting volume %q: %s, cVR.ObjectMeta.Name,err) + glog.Errorf(Error in deleting volume %q: %s, cVR.ObjectMeta.Name, err) c.recorder.Event(cVR, corev1.EventTypeWarning, string(common.FailureDestroy), string(common.MessageResourceFailDestroy)) return string(apis.CVRStatusDeletionFailed), err }", "output": "This line changed due to go formatting. Format was not there earlier."}, {"instruction": "Here is an example code review: 'I'd feel a little safer if the first argument were a string, not a *string unless there's a particular reason for making it a pointer.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -28,13 +28,13 @@ type staticUpstream struct { Path string Interval time.Duration } + Without string } // NewStaticUpstreams parses the configuration input and sets up // static upstreams for the proxy middleware. func NewStaticUpstreams(c parse.Dispenser) ([]Upstream, error) { var upstreams []Upstream - for c.Next() { upstream := &staticUpstream{ from: ,", "output": "The name Without in code is a little nebulous. Maybe something more descriptive like TrimPrefix or StripPrefix or WithoutPathPrefix or something like that. (Thoughts?)"}, {"instruction": "Here is an example code review: 'can we also test for `transport=rest`?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -254,6 +254,12 @@ public class MoveIT { linkDataset.then().assertThat() .statusCode(OK.getStatusCode()); + // A dataset cannot be linked to the same dataverse again. + Response tryToLinkAgain = UtilIT.linkDataset(datasetPid, dataverse2Alias, superuserApiToken); + tryToLinkAgain.prettyPrint(); + tryToLinkAgain.then().assertThat() + .statusCode(FORBIDDEN.getStatusCode()); + Response getLinksBefore = UtilIT.getDatasetLinks(datasetPid, superuserApiToken); getLinksBefore.prettyPrint(); getLinksBefore.then().assertThat()", "output": "is this test in the move tests? I see what you mean then - it works, but I wonder if we won't lose track that it's being tested here."}, {"instruction": "Here is an example code review: 'A question! I think `string` totally works, but what do you think of `*string` for consistency?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -368,5 +368,8 @@ type Instance struct { EBSOptimized *bool `json:ebsOptimized` // The tags associated with the instance. - Tags map[string]string `json:tag` + Tags map[string]string `json:tags` + + // The security groups associated with the instance. + SecurityGroups map[string]string `json:securityGroups` }", "output": "I'm not sure if this wanted to be `json:tags` (which I'd set in my PR) or `json:tag` that someone elses PR had set. Given that the rest of the fields had their JSON field name set to the same as the struct field name, I opted for `tags`."}, {"instruction": "Here is an example code review: 'The `_example` field should be updated to include an interpreter with an array value.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -47,6 +47,11 @@ module Ncr message: must be three letters or numbers }, allow_blank: true + scope :for_fiscal_year, lambda { |year| + range = self.class.range_for_fiscal_year(year) + where(created_at: range[:start_time]...range[:end_time]) + } + def self.all_system_approver_emails [ self.ba61_tier1_budget_mailbox,", "output": "since the logic here and in `Proposal` is exactly the same, do you think it makes sense for us to include it elsewhere? I am not opposed to duplicated code when it makes sense, but the reason I first identified this was that I was looking for code in NCR::WorkOrder that was not specific to Work Orders. Seems like fiscal year logic might be helpful for reporting for other clients. In that case, we'd want this scope on those client data classes as well. Might be wrong to include this in the FiscalYear mixin, but it does seem like it should be outside of Proposal and WorkOrder. Does that make sense?"}, {"instruction": "Here is an example code review: '@cijothomas I needed a way to set the Exporter.ParentProvider when the Processor's gets set. Internal to SDK though.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -42,6 +42,11 @@ class InfluxWriterSubscriber(object): self.time = 0 + def on_connection_closed(self, connection, reply_code, reply_text): + self.log.info('RabbitMQ connection got closed!') + self.connection.add_timeout(5, self.connect_to_rabbitmq) + + @staticmethod def static_callback(ch, method, properties, body, obj): return obj.callback(ch, method, properties, body)", "output": "there is no static method as a go between -- how does this work?"}, {"instruction": "Here is an example code review: 'Not really a container, and it's not just about non-config data, not sure of a better description, @myronmarston ?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -0,0 +1,8 @@ +# frozen_string_literal: true +# encoding: utf-8 + +class StringifiedSymbol + include Mongoid::Document + store_in collection: stringified_symbols, client: :other + field :stringified_symbol, type: StringifiedSymbol +end", "output": "Can you please change the name of this class to be something else?"}, {"instruction": "Here is an example code review: 'Is it safe to assume this surface is a toplevel?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -403,7 +403,7 @@ size_t h2o_strstr(const char *haysack, size_t haysack_len, const char *needle, s } /* note: returns a zero-width match as well */ -const char *h2o_next_token(h2o_iovec_t *iter, int separator, size_t *element_len, h2o_iovec_t *value) +const char *h2o_next_token(h2o_iovec_t *iter, int separator, size_t *element_len, h2o_iovec_t *value, int coma_separator) { const char *cur = iter->base, *end = iter->base + iter->len, *token_start, *token_end; ", "output": "I think we might prefer generalizing the interface rather than creating an exception. Current design of `h2o_next_token` assumes the input to be a comma-separated list, and allows the caller to specify a different separator when parsing a nested list. As I understand, what we are trying to attain in this PR is to have a way of parsing a flat list of semicolon-separated list. Assuming that is the case, I think it would be better to change the API of the function to accept two separators (i.e. inner and outer), where for our existing use-cases `outer` would be `,`."}, {"instruction": "Here is an example code review: 'Unrelated file. Please remove from PR.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -43,8 +43,8 @@ namespace Nethermind.Blockchain { private const long LowestInsertedBodyNumberDbEntryAddress = 0; private const int CacheSize = 64; - private readonly ICache<Keccak, Block> _blockCache = new LruCacheWithRecycling<Keccak, Block>(CacheSize, CacheSize, blocks); - private readonly ICache<Keccak, BlockHeader> _headerCache = new LruCacheWithRecycling<Keccak, BlockHeader>(CacheSize, CacheSize, headers); + private readonly ICache<Keccak, Block> _blockCache = new LruCache<Keccak, Block>(CacheSize, CacheSize, blocks); + private readonly ICache<Keccak, BlockHeader> _headerCache = new LruCache<Keccak, BlockHeader>(CacheSize, CacheSize, headers); private const int BestKnownSearchLimit = 256_000_000; ", "output": "why not recycling? I Lru cache now recycling?"}, {"instruction": "Here is an example code review: '`ds.GenericDeploymentConfig.DeploymentNotification` in L128 is nullable.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -69,7 +69,7 @@ func (consumer *createConsumer) Consume(requestPtr interface{}) (response interf issuerID := consumer.peerID if request.ConsumerInfo != nil { issuerID = request.ConsumerInfo.IssuerID - if request.ConsumerInfo.PaymentVersion == PaymentVersionV2 { + if request.ConsumerInfo.PaymentVersion == PaymentVersionV3 { indicateNewVersion = true } } else {", "output": "Why it is now called `PaymentVersionV3`?"}, {"instruction": "Here is an example code review: 'You can put this in `kbfsOpsInit()` in you want, so we don't have to call it in every test.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -165,7 +165,7 @@ func (dc *DownstreamController) syncSecret() { } nodes := dc.lc.SecretNodes(secret.Namespace, secret.Name) - klog.Infof(there are %d nodes need to sync secret, operation: %s, len(nodes), e.Type) + klog.V(4).Infof(there are %d nodes need to sync secret, operation: %s, len(nodes), e.Type) for _, n := range nodes { msg := model.NewMessage() msg.SetResourceVersion(secret.ResourceVersion)", "output": "changed for debug purpose?"}, {"instruction": "Here is an example code review: 'Any particular reason for this? This potentially will make harder to investigate users issues'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -46,6 +46,13 @@ namespace OpenTelemetry /// <inheritdoc /> public abstract override void OnEnd(T data); + internal override void SetParentProvider(BaseProvider parentProvider) + { + base.SetParentProvider(parentProvider); + + this.exporter.ParentProvider = parentProvider; + } + /// <inheritdoc /> protected override bool OnShutdown(int timeoutMilliseconds) {", "output": "@cijothomas I needed a way to set the Exporter.ParentProvider when the Processor's gets set. Internal to SDK though."}, {"instruction": "Here is an example code review: 'I don't think these asserts are necessary, because `subsurface_find_sibling` already searches in the parent. Or am I missing something?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -31,9 +31,13 @@ inline extractor::RoadClassification roadClass(const ConnectedRoad &road, return graph.GetEdgeData(road.eid).flags.road_classification; } -inline bool isRampClass(EdgeID eid, const util::NodeBasedDynamicGraph &node_based_graph) +inline bool isRampClass(EdgeID eid, + const util::NodeBasedDynamicGraph &node_based_graph, + bool from_motorway = true) { - return node_based_graph.GetEdgeData(eid).flags.road_classification.IsRampClass(); + return node_based_graph.GetEdgeData(eid).flags.road_classification.IsRampClass() || + (from_motorway && + node_based_graph.GetEdgeData(eid).flags.road_classification.IsLinkClass()); } } // namespace", "output": "Talking through this scenario with @srividyacb and she's wondering if there should also be a check of `(from_trunk && node_based_graph.GetEdgeData(eid).flags.road_classification.IsLinkClass())` as highways with trunk classifications can also have this scenario."}, {"instruction": "Here is an example code review: 'Great God, I have a question. This .nebula_history file is used to save history commands. Is there a file size limit? When the file is large, does it take a long time to start initialization (loadHistory)? How did you think about this? Thx.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -13,7 +13,7 @@ module Beaker :q_verify_packages => ENV['q_verify_packages'] || 'y', :q_puppet_symlinks_install => 'y', :q_puppetagent_certname => host, - :q_puppetagent_server => master, + :q_puppetagent_server => master_certname, # Disable database, console, and master by default # This will be overridden by other blocks being merged in.", "output": "where does `master_certname` come from?"}, {"instruction": "Here is an example code review: 'Don't redefine, just import the existing one in `cmdline.py`. :)'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1,5 +1,7 @@ from .resnet import ResNet, make_res_layer from .resnext import ResNeXt from .ssd_vgg import SSDVGG +from .hrnet import HRNet -__all__ = ['ResNet', 'make_res_layer', 'ResNeXt', 'SSDVGG'] +__all__ = ['ResNet', 'make_res_layer', 'ResNeXt', 'SSDVGG', + 'HRNet']", "output": "The line breaking is unnecessary."}, {"instruction": "Here is an example code review: 'Careful: you only want two newlines after the final header message. (That indicates the end of headers and the start of data.)'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -28,7 +28,7 @@ void DatasetLoader::SetHeader(const char* filename) { // get column names if (io_config_.has_header) { std::string first_line = text_reader.first_line(); - feature_names_ = Common::Split(first_line.c_str(), \\t ,); + feature_names_ = Common::Split(first_line.c_str(), \\t,); } // load label idx first", "output": "why not enable split by space here ?"}, {"instruction": "Here is an example code review: 'Can you explain why is this necessary? Is `snprintf()` with four integer arguments unsafe?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1076,7 +1076,8 @@ fpga_result mmio_error(struct RASCommandLine *rasCmdLine) return result; } - if(value != FPGA_INTEGRATED_DEVICEID) { + if( (value != FPGA_INTEGRATED_DEVICEID) || + (value != FPGA_DISCRETE_DEVICEID) ) { FPGA_ERR(Failed to read Device id); return FPGA_NOT_SUPPORTED; }", "output": "Shouldn't the operator be && ?"}, {"instruction": "Here is an example code review: 'why not call `respond_to?(#{name}=)` from the `if` line?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -161,6 +161,17 @@ module Beaker FileUtils.rm_rf(@vagrant_path) end + #snapshotting depends on https://github.com/scalefactory/vagrant-multiprovider-snap + def take_snapshot(host,snapshot_name) + @logger.debug Creating snapshot of #{host} + vagrant_cmd(snap take #{host} --name=#{snapshot_name}) + end + + def restore_snapshot(host,snapshot_name) + @logger.debug Restoring snapshot of #{host} + vagrant_cmd(snap rollback #{host} --name=#{snapshot_name}) + end + def vagrant_cmd(args) Dir.chdir(@vagrant_path) do exit_status = 1", "output": "My best guess is that you want to use host.name in these parts to get the name of the host ?"}, {"instruction": "Here is an example code review: 'Careful: you only want two newlines after the final header message. (That indicates the end of headers and the start of data.)'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -270,13 +270,6 @@ func (n *Node) UnmarshalBinary(data []byte) error { n.entry = append([]byte{}, data[nodeHeaderSize:nodeHeaderSize+refBytesSize]...) offset := nodeHeaderSize + refBytesSize // skip entry - // Currently we don't persist the root nodeType when we marshal the manifest, as a result - // the root nodeType information is lost on Unmarshal. This causes issues when we want to - // perform a path 'Walk' on the root. If there is more than 1 fork, the root node type - // is an edge, so we will deduce this information from index byte array - if !bytes.Equal(data[offset:offset+32], make([]byte, 32)) { - n.nodeType = nodeTypeEdge - } n.forks = make(map[byte]*fork) bb := &bitsForBytes{} bb.fromBytes(data[offset:])", "output": "IMO this edge case handling could remain here, just instead of overwriting the `n.nodeType`, the `makeEdgeType` method of `n` should be called, so `n.nodeType = nodeTypeEdge` -> `n.makeEdge()`"}, {"instruction": "Here is an example code review: 'Unrelated file. Please remove from PR.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -205,9 +205,10 @@ public class DownloadService extends Service { Log.d(TAG, Service shutting down); isRunning = false; + boolean showAutoDownloadReport = UserPreferences.showAutoDownloadReport(); if (ClientConfig.downloadServiceCallbacks.shouldCreateReport() - && UserPreferences.showDownloadReport()) { - notificationManager.updateReport(reportQueue); + && (UserPreferences.showDownloadReport() || showAutoDownloadReport)) { + notificationManager.updateReport(reportQueue, showAutoDownloadReport); reportQueue.clear(); } ", "output": "Just wondering... The two kinds of notifications are now quite different (Channel, text, maybe even icon). Would it make sense to extract the auto download notification to a new class instead of handling everything in the existing `notificationManager`? I have not checked if this will lead to a lot of code duplication, though."}, {"instruction": "Here is an example code review: 'Looks like this is unused? Did you mean to call it when clearing the block journal?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -140,3 +140,11 @@ func (c *Call) RoutingDelegate() string { } return c.ic.req.RoutingDelegate } + +// Features returns the RequestFeatures for this request. +func (c *Call) Features() transport.RequestFeatures { + if c == nil { + return transport.RequestFeatures{} + } + return c.ic.req.Features +}", "output": "Do we need to put this on the Call? We only need the API communication between the Encoding and the Transports which is currently done through the Transport.Request. The Call is used by users right?"}, {"instruction": "Here is an example code review: 'Do we need to put this on the Call? We only need the API communication between the Encoding and the Transports which is currently done through the Transport.Request. The Call is used by users right?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1202,3 +1202,15 @@ L: } return filtered } + +func (a *WebAPI) GenerateAPIKey(ctx context.Context, req *webservice.GenerateAPIKeyRequest) (*webservice.GenerateAPIKeyResponse, error) { + return nil, status.Error(codes.Unimplemented, ) +} + +func (a *WebAPI) DisableAPIKey(ctx context.Context, req *webservice.DisableAPIKeyRequest) (*webservice.DisableAPIKeyResponse, error) { + return nil, status.Error(codes.Unimplemented, ) +} + +func (a *WebAPI) ListAPIKeys(ctx context.Context, req *webservice.ListAPIKeysRequest) (*webservice.ListAPIKeysResponse, error) { + return nil, status.Error(codes.Unimplemented, ) +}", "output": "`ctx` is unused in GenerateAPIKey"}, {"instruction": "Here is an example code review: 'this default needs to be on order 1 minute, I'm not sure why we defaulted to 1 hour below...'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -75,6 +75,7 @@ type ( func NewBlockDAO(indexers []BlockIndexer, cfg config.DB) BlockDAO { blkStore, err := filedao.NewFileDAO(cfg) if err != nil { + log.L().Fatal(err.Error(), zap.Any(cfg, cfg)) return nil } return createBlockDAO(blkStore, indexers, cfg)", "output": "Can you judge the type of error?"}, {"instruction": "Here is an example code review: 'Why this deletion?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -204,7 +204,7 @@ class GridInterface(DictInterface): if edges and not isedges: data = cls._infer_interval_breaks(data) elif not edges and isedges: - data = np.convolve(data, [0.5, 0.5], 'valid') + data = data[:-1] + np.diff(data)/2. return data ", "output": "Much simpler than a weird and confusing ``convolve`` call!"}, {"instruction": "Here is an example code review: 'Are you sure? We've changed it during an introduction of the IME support.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -739,8 +739,8 @@ describe('suspense', () => { expect(scratch.innerHTML).to.eql( `<div>Hello first 2</div><div>Hello second 2</div>` ); - expect(Suspender1.prototype.render).to.have.been.calledThrice; - expect(Suspender2.prototype.render).to.have.been.calledThrice; + expect(Suspender1.prototype.render).to.have.been.calledTwice; + expect(Suspender2.prototype.render).to.have.been.calledTwice; }); }); });", "output": "Huh, this seems weird to me... Surely the suspenders render was called again in order to get the new `<div>Hello second 2</div>` output... Imma take a peak at these tests to understand what's going on"}, {"instruction": "Here is an example code review: 'This is a way better method name.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -80,6 +80,10 @@ class ApplicationController < ActionController::Base def failed_destroy_error(obj, obj_name) #{_('Could not delete the %{o}.') % {o: obj_name}} #{errors_to_s(obj)} end + + def success_message(obj_name, action) + #{_('Successfully %{action} your %{object}.') % {object: obj_name, action: action}} + end private # Override rails default render action to look for a branded version of a", "output": "Since this is just a helper function to create text, perhaps this could live in a helper? I noticed that we have a few other error/message creators in the application controller as well, but I think this type of function should be re-factored to be part of a helper."}, {"instruction": "Here is an example code review: 'why not enable split by space here ?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -92,7 +92,7 @@ evaluation=10.0 - ((float(5 * error + warning + refactor + convention) / stateme # Template used to display messages. This is a python new-style format string # used to format the message information. See doc for all details -#msg-template= +msg-template=[{msg_id}] {path}:{line:3d}:{column}: {msg} [SPELLING]", "output": "Will this mess up parsing the messages by other editors? (vscode, vim ...)"}, {"instruction": "Here is an example code review: 'No need to speficy attribute here. Moreover in yaml it is default to use lowercase names.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1,4 +1,3 @@ -# Set up gems listed in the Gemfile. -ENV['BUNDLE_GEMFILE'] ||= File.expand_path('../../Gemfile', __FILE__) +ENV['BUNDLE_GEMFILE'] ||= File.expand_path('../Gemfile', __dir__) -require 'bundler/setup' if File.exists?(ENV['BUNDLE_GEMFILE']) +require 'bundler/setup' # Set up gems listed in the Gemfile.", "output": "Style/StringLiterals: Prefer double-quoted strings unless you need single quotes to avoid extra backslashes for escaping."}, {"instruction": "Here is an example code review: 'Could be a timing thing here. When options are created they'll copy the ref for the current default propagator. If user sets through SDK the global propagator after that, it won't be reflected. Could leave it null here and then when it is used in instrumentation do `options.Propagator ?? Propagators.DefaultTextMapPropagator`. It would be a slight perf hit but it makes it hot-swappable.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -28,8 +28,13 @@ namespace Microsoft.AspNet.Server.Kestrel.Filter _filteredStream = filteredStream; _socketInputStream = new SocketInputStream(SocketInput); - _filteredStream.CopyToAsync(_socketInputStream).ContinueWith((task, state) => + var block = memory.Lease(); + // Use pooled block for copy + _filteredStream.CopyToAsync(_socketInputStream, block).ContinueWith((task, state) => { + var returnedBlock = task.Result; + returnedBlock.Pool?.Return(returnedBlock); + ((FilteredStreamAdapter)state).OnStreamClose(task); }, this); }", "output": "Why can the pool be null?"}, {"instruction": "Here is an example code review: 'Remember to close SOLR-11877 after this'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -74,6 +74,15 @@ class ToggleButton(ia2Web.Ia2Web): return states +class PresentationalList(ia2Web.Ia2Web): +  Ensures that lists like UL, DL and OL always have the readonly state. + + def _get_states(self): + states = super().states + states.add(controlTypes.STATE_READONLY) + return states + + def findExtraOverlayClasses(obj, clsList): Determine the most appropriate class(es) for Chromium objects. This works similarly to L{NVDAObjects.NVDAObject.findOverlayClasses} except that it never calls any other findOverlayClasses method.", "output": "It might be good to have a note here: > work-around for issue #7562 allowing us to differentiate presentational lists from interactive lists (such as of size greater 1 and ARIA list boxes). In firefox, this is possible by the presence of a read-only state, even in content editable."}, {"instruction": "Here is an example code review: 'Remember to close SOLR-11877 after this'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -66,16 +66,16 @@ import java.util.Set; * the current node) may be queried. * */ -class DigraphNode implements Cloneable, Serializable { +class DigraphNode<E> implements Cloneable, Serializable { /** The data associated with this node. */ - protected Object data; + protected E data; /** * A <code>Set</code> of neighboring nodes pointed to by this * node. */ - protected Set outNodes = new HashSet(); + protected Set<DigraphNode<E>> outNodes = new HashSet<>(); /** The in-degree of the node. */ protected int inDegree = 0;", "output": "This set of changes is the one part of this that I'm not completely sure is valid. Can someone look over this to make sure I got the E's right?"}, {"instruction": "Here is an example code review: 'Use `UpperCamelCase` for function names'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -282,8 +282,12 @@ void nano::bootstrap_attempt_legacy::request_push (nano::unique_lock<std::mutex> void nano::bootstrap_attempt_legacy::add_frontier (nano::pull_info const & pull_a) { nano::pull_info pull (pull_a); - nano::lock_guard<std::mutex> lock (mutex); - frontier_pulls.push_back (pull); + // Prevent incorrent or malicious pulls with frontier 0 insertion + if (!pull.head.is_zero ()) + { + nano::lock_guard<std::mutex> lock (mutex); + frontier_pulls.push_back (pull); + } } void nano::bootstrap_attempt_legacy::add_bulk_push_target (nano::block_hash const & head, nano::block_hash const & end)", "output": "There doesn't seem to be a reason to copy this here."}, {"instruction": "Here is an example code review: 'Great God, I have a question. This .nebula_history file is used to save history commands. Is there a file size limit? When the file is large, does it take a long time to start initialization (loadHistory)? How did you think about this? Thx.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1774,6 +1774,7 @@ std::string h2o_raw_tracer::bpf_text() { #include <linux/sched.h> #include <linux/limits.h> +#include include/h2o/ebpf.h #define STR_LEN 64 ", "output": "We've avoided including h2o headers in BPF programs because it's a runtime dependency. However, IIRC, this is because h2olog was maintained in the separate repository so that h2olog did not know where h2o was installed. Now h2olog can use `H2O_ROOT`, we should add it to BCC's `cflags` in order to include h2o headers in BPF programs."}, {"instruction": "Here is an example code review: 'how come this is false?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -170,6 +170,10 @@ type ThanosRulerSpec struct { // Note: Currently only the CAFile, CertFile, and KeyFile fields are supported. // Maps to the '--grpc-server-tls-*' CLI args. GRPCServerTLSConfig *TLSConfig `json:grpcServerTlsConfig,omitempty` + // The external Query URL the Thanos Ruler will set in the 'Source' field + // of all alerts. + // Maps to the '--alert.query-url' CLI arg. + AlertQueryURL string `json:alertQueryUrl,omitempty` } // ThanosRulerStatus is the most recent observed status of the ThanosRuler. Read-only. Not", "output": "I think the docstring here should include the CLI arg `--alert.query-url` just to make it clear to users which setting this uses."}, {"instruction": "Here is an example code review: 'this default needs to be on order 1 minute, I'm not sure why we defaulted to 1 hour below...'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -224,9 +224,7 @@ func (m *ipipManager) CompleteDeferredWork() error { for _, ip := range m.activeHostnameToIP { members = append(members, ip) } - for _, ip := range m.externalNodeCIDRs { - members = append(members, ip) - } + members = append(members, m.externalNodeCIDRs...) m.ipsetsDataplane.AddOrReplaceIPSet(m.ipSetMetadata, members) m.ipSetInSync = true }", "output": "Same change just above?"}, {"instruction": "Here is an example code review: 'Huh, this seems weird to me... Surely the suspenders render was called again in order to get the new `<div>Hello second 2</div>` output... Imma take a peak at these tests to understand what's going on'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -511,4 +511,14 @@ describe('services_SearchEngine', function() { expect((await engine.search('- [ ]', { searchType: SearchEngine.SEARCH_TYPE_BASIC })).length).toBe(1); expect((await engine.search('[ ]', { searchType: SearchEngine.SEARCH_TYPE_BASIC })).length).toBe(2); })); + + it('should not mistake cyrillic l for latin n', asyncTest(async () => { + const n1 = await Note.save({ title: 'latin n', body: 'n' }); + const n2 = await Note.save({ title: 'cyrillic l', body: '\u043b' }); + + await engine.syncTables(); + + expect((await engine.search('n')).length).toBe(1); + expect((await engine.search('\u043b')).length).toBe(1); + })); });", "output": "Could you check the result content rather than just the number of search results please? For example with this test if the search engine suddenly starts returning latin n for both queries, we won't know about it."}, {"instruction": "Here is an example code review: 'nit: this is a package-wide constant so better to narrow the scope like `allEventsSign`.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -47,9 +47,10 @@ const ( otherDomainID = spiffe://otherdomain.test - serverID = spiffe://example.org/spire/server - agentID = spiffe://example.org/spire/agent/test/id - workloadID = spiffe://example.org/workload + serverID = spiffe://example.org/spire/server + agentID = spiffe://example.org/spire/agent/test/id + agentlessID = spiffe://example.org/test/id + workloadID = spiffe://example.org/workload // used to cancel stream operations on test failure instead of blocking the // full go test timeout period (i.e. 10 minutes)", "output": "nit: I think that `workloadID` should suffice for this test... that's what we'd be issuing anyways"}, {"instruction": "Here is an example code review: '@lpabon having a separate package name `aws_test` allows to test the package as if the tester was an external package. If the test package name is the same as the package being tested, the test package can also use methods and variables not exposed to the eventual user.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1,4 +1,4 @@ -require 'spec_helper' +require 'rails_helper' feature 'Admin manages mentors' do scenario 'creating a new mentor' do", "output": "Prefer double-quoted strings unless you need single quotes to avoid extra backslashes for escaping."}, {"instruction": "Here is an example code review: 'This was introduced recently for the Hadoop 3 upgrade. Copy/paste error but definitely causing some of the new test failures.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -204,11 +204,7 @@ public class ClassTypeResolver extends JavaParserVisitorAdapter { if (className != null) { populateClassName(node, className); } - } catch (ClassNotFoundException e) { - if (LOG.isLoggable(Level.FINE)) { - LOG.log(Level.FINE, Could not find class  + className + , due to:  + e); - } - } catch (NoClassDefFoundError e) { + } catch (ClassNotFoundException | NoClassDefFoundError e) { if (LOG.isLoggable(Level.FINE)) { LOG.log(Level.FINE, Could not find class  + className + , due to:  + e); }", "output": "We should have a rule to detect identical catch branches"}, {"instruction": "Here is an example code review: 'In general I'm a trying to understand the reason behind this PR. Looks like if a blob (name) already exists we check if the contents are identical? In what scenarios this is not the case? When we want to publish a package/asset that has changed but still we want to use the same version?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -28,10 +28,6 @@ namespace Microsoft.DotNet.Build.Tasks.Feed public bool PublishFlatContainer { get; set; } - public int RetryAttempts { get; set; } = 5; - - public int RetryDelayInSeconds { get; set; } = 30; - public int MaxClients { get; set; } = 8; public bool SkipCreateContainer { get; set; } = false;", "output": "remove these from the targets file."}, {"instruction": "Here is an example code review: 'delete the empty line github.com/pkg/errors should be grouped with other third party packages same for the rest'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -11,14 +11,13 @@ import ( time github.com/ethersphere/bee/pkg/addressbook + github.com/ethersphere/bee/pkg/bzz github.com/ethersphere/bee/pkg/hive/pb github.com/ethersphere/bee/pkg/logging github.com/ethersphere/bee/pkg/p2p github.com/ethersphere/bee/pkg/p2p/protobuf github.com/ethersphere/bee/pkg/storage github.com/ethersphere/bee/pkg/swarm - - ma github.com/multiformats/go-multiaddr ) const (", "output": "now that we have the signature in the hive messages, it might be that this must be drastically reduced, since there are limits on the protobuf reader/writers i believe"}, {"instruction": "Here is an example code review: 'Do we still need the upper bound `<3.9`?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -35,11 +35,12 @@ NAMESPACE_PACKAGES = [ REQUIRED_PACKAGES = [ # Installation related. 'anytree==2.4.3', - 'google-api-python-client==1.7.7', - 'google-auth==1.6.2', + 'google-api-python-client==1.7.10', + 'google-auth==1.6.3', 'google-auth-httplib2==0.0.3', 'Jinja2==2.10.1', 'jmespath==0.9.3', + 'mailjet-rest==1.3.3', 'netaddr==0.7.19', 'pyyaml==4.2b4', 'python-graph-core==1.8.2',", "output": "I recommend that we move this to be optional, as other users might not need it. Can you look at `OPTIONAL_PACKAGES` section, around line 68?"}, {"instruction": "Here is an example code review: 'Revert this blank line'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -8,10 +8,7 @@ package javaslang.control; import javaslang.Serializables; import org.junit.Test; -import java.util.Iterator; -import java.util.NoSuchElementException; -import java.util.Objects; -import java.util.Optional; +import java.util.*; import static org.assertj.core.api.Assertions.assertThat; ", "output": "I usually set idea to never use wildcard import such as `import java.util.*;` Now i use setting from javaslang standard."}, {"instruction": "Here is an example code review: 'Although this change looks good. Maybe there are other inconsistent cases too?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -29,7 +29,9 @@ module Beaker v_file <<  v.vm.box = '#{host['box']}'\\n v_file <<  v.vm.box_url = '#{host['box_url']}'\\n unless host['box_url'].nil? v_file <<  v.vm.base_mac = '#{randmac}'\\n - v_file <<  v.vm.network :private_network, ip: \\#{host['ip'].to_s}\\, :netmask => \\#{host['netmask'] ||= 255.255.0.0}\\\\n + host['ips'].each do |ip| + v_file <<  v.vm.network :private_network, ip: \\#{ip.to_s}\\, :netmask => \\#{host['netmask'] ||= 255.255.0.0}\\\\n + end if host['disk_path'] v_file <<  v.vm.provider :virtualbox do |vb|\\n", "output": "Where is host['ips'] coming from?"}, {"instruction": "Here is an example code review: 'Make this private and update all the public functions to not take this argument. The variable you set below should also be private, then in the tests instead of passing the variable in to the function just update the variable. We don't want to expose the testing implementation in the public api if it can be avoided.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -3,14 +3,7 @@ package userns -import ( - strings - - github.com/opencontainers/runc/libcontainer/user -) - -func FuzzUIDMap(data []byte) int { - uidmap, _ := user.ParseIDMap(strings.NewReader(string(data))) - _ = uidMapInUserNS(uidmap) +func FuzzUIDMap(uidmap []byte) int { + _ = uidMapInUserNS(string(uidmap)) return 1 }", "output": "oh! missed a `:` here; let me fix that; also can get rid of the intermediate variable"}, {"instruction": "Here is an example code review: 'This is a way better method name.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1,6 +1,8 @@ describe Display status text do let(:proposal) { FactoryGirl.create(:proposal, :with_parallel_approvers) } before do + proposal.approvers.first.update(first_name: Uniquely, last_name: Named) + proposal.approvers.second.update(first_name: Onlyof, last_name: Itskind) login_as(proposal.requester) end ", "output": "Is this necessary?"}, {"instruction": "Here is an example code review: 'Spotless is configured to reject star imports. Please replace with explicit imports.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1,8 +1,16 @@ -import React from 'react'; +import React, {Component} from 'react'; import 'element-theme-default'; import {i18n} from 'element-react'; import locale from 'element-react/src/locale/lang/en'; +import storage from './utils/storage'; +import logo from './utils/logo'; +import {makeLogin, isTokenExpire} from './utils/login'; + +import Header from './components/Header'; +import Footer from './components/Footer'; +import LoginModal from './components/Login'; + i18n.use(locale); import Route from './router';", "output": "I'd create a different method for each render section."}, {"instruction": "Here is an example code review: 'why named alters? how about this.alerts = alerts?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -23,6 +23,8 @@ public class EstimateGasOperationTracer implements OperationTracer { private Gas sStoreStipendNeeded = Gas.ZERO; + private boolean isReverted = false; + @Override public void traceExecution( final MessageFrame frame, final OperationTracer.ExecuteOperation executeOperation) {", "output": "Instead of storing the revert flag in the tracer is it possible to use org.hyperledger.besu.ethereum.mainnet.TransactionProcessor.Result#getRevertReason? (via org.hyperledger.besu.ethereum.transaction.TransactionSimulatorResult#getResult)? If a TX reverts without a reason do we get an empty revert reason or a revert reason with zero bytes?"}, {"instruction": "Here is an example code review: 'curious do we have an API to fetch an inactive flow?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -71,7 +71,7 @@ public class TestSparkOrcReader extends AvroDataTest { try (CloseableIterable<InternalRow> reader = ORC.read(Files.localInput(testFile)) .project(schema) - .createReaderFunc(SparkOrcReader::new) + .createReaderFunc(readOrcSchema -> new SparkOrcReader(schema, readOrcSchema)) .build()) { final Iterator<InternalRow> actualRows = reader.iterator(); final Iterator<InternalRow> expectedRows = expected.iterator();", "output": "I think this should test with and without container reuse if that is implemented in this PR. Probably just make this test parameterized."}, {"instruction": "Here is an example code review: 'Hi Simon. Whether this should return true depends on what byte buffers are used? The same applies to ByteBufferIndexInput, actually... I don't think you can generally tell whether the ByteBuffers the input operates on come from a mmap call or from somewhere else (even direct buffers don't have to be a result of mmap).'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -100,6 +100,10 @@ abstract class BaseFile<F> found = true; fromProjectionPos[i] = j; } + if (fields.get(i).fieldId() == ManifestFile.SPEC_ID.fieldId()) { + found = true; + fromProjectionPos[i] = 14; + } } if (!found) {", "output": "These modifications allow BaseFile to translate into a SparkRow with the specID as a column"}, {"instruction": "Here is an example code review: 'this is a breaking change, any specific reason you want to do this?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -519,7 +519,7 @@ function resolveReadPreference(parent, options) { throw new Error('No readPreference was provided or inherited.'); } - return readPreference; + return typeof readPreference === 'string' ? new ReadPreference(readPreference) : readPreference; } /**", "output": "is this something we've been missing this whole time?"}, {"instruction": "Here is an example code review: 'WHY U NOT SORT IMPORTS?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -25,6 +25,7 @@ import ( const ( defaultWaitApprovalTimeout = Duration(6 * time.Hour) defaultAnalysisQueryTimeout = Duration(30 * time.Second) + allEvents = * ) type GenericDeploymentSpec struct {", "output": "nit: this is a package-wide constant so better to narrow the scope like `allEventsSign`."}, {"instruction": "Here is an example code review: 'Don't redefine, just import the existing one in `cmdline.py`. :)'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -111,6 +111,15 @@ def generate_thrift_files(thrift_files_dir, env, silent=True): LOG.error('Failed to generate viewer server files') return ret + auth_thrift = os.path.join(thrift_files_dir, 'authentication.thrift') + auth_thrift = 'authentication.thrift' + auth_cmd = ['thrift', '-r', '-I', '.', + '--gen', 'py', auth_thrift] + ret = run_cmd(auth_cmd, thrift_files_dir, env, silent=silent) + if ret: + LOG.error('Failed to generate authentication interface files') + return ret + # ------------------------------------------------------------------- def generate_documentation(doc_root, env, silent=True):", "output": "There seems to be some repetition. Does a local function make this code shorter overall?"}, {"instruction": "Here is an example code review: 'Why this deletion?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -298,6 +298,7 @@ function diffElementNodes( } if (dom == null) { + isHydrating = false; if (newVNode.type === null) { return document.createTextNode(newProps); }", "output": "Might be cheaper to reuse the `null` assignment of line 313 and set `isHydrating` to null instead WDYT?"}, {"instruction": "Here is an example code review: 'Not really a container, and it's not just about non-config data, not sure of a better description, @myronmarston ?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -22,7 +22,6 @@ import java.util.List; @AutoValue public abstract class TestCaseView { - public abstract String clientMethodName(); public abstract InitCodeView initCode();", "output": "Revert this blank line"}, {"instruction": "Here is an example code review: 'These logs should probably use the `LOGTAG`'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -50,8 +50,8 @@ public class MoveReplicaHDFSTest extends MoveReplicaTest { HdfsTestUtil.teardownClass(dfsCluster); } finally { dfsCluster = null; - System.setProperty(solr.hdfs.blockcache.blocksperbank, 512); - System.setProperty(tests.hdfs.numdatanodes, 1); + System.clearProperty(solr.hdfs.blockcache.blocksperbank); + System.clearProperty(tests.hdfs.numdatanodes); } } ", "output": "This was introduced recently for the Hadoop 3 upgrade. Copy/paste error but definitely causing some of the new test failures."}, {"instruction": "Here is an example code review: 'Revert this blank line'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -2,6 +2,7 @@ class ProposalsController < ApplicationController include TokenAuth skip_before_action :authenticate_user!, only: [:approve] + before_action :check_disabled_client # TODO use Policy for all actions before_action ->{authorize proposal}, only: [:show, :cancel, :cancel_form, :history] before_action :needs_token_on_get, only: :approve", "output": "I think we should only need to do this for `:approve` since we are using `authenticate_user!` for all other actions and that checks for disabled client"}, {"instruction": "Here is an example code review: 'Do you validate the possible strings? I've not read the code below but we should make sure if a string is supplied it is validate...'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -56,9 +56,10 @@ class DefaultBucketViewTest(BaseWebTest, unittest.TestCase): self.app.get(self.collection_url, headers=self.headers) def test_querystring_parameters_are_taken_into_account(self): - self.app.get(self.collection_url + '/records?_since=invalid', - headers=self.headers, - status=400) + resp = self.app.get(self.collection_url + '/records?_since=invalid', + headers=self.headers, + status=400) + self.assertIn('Content-Length', resp.headers) def test_option_is_possible_without_authentication_for_default(self): headers = 'authorization,content-type'", "output": "I wonder if we should create new tests for header checks; here for instance we're mixing querystring and headers. Thoughts?"}, {"instruction": "Here is an example code review: 'This is a way better method name.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -42,7 +42,7 @@ module Bolt path = File.join(libexec, 'custom_facts.rb') file = { 'name' => 'custom_facts.rb', 'path' => path } metadata = { 'supports_noop' => true, 'input_method' => 'stdin' } - Bolt::Task.new(name: 'custom_facts', files: [file], metadata: metadata) + Bolt::Task.new(name: 'apply_helpers::custom_facts', files: [file], metadata: metadata) end end ", "output": "We should be able to add sensitive by hard-coding the parameters, same as you put into the metadata in apply_helpers."}, {"instruction": "Here is an example code review: 'I though that all data objects are being unified in the fashion where all default values are initialized in constructor, are not they?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -0,0 +1,11 @@ +<?php + +declare(strict_types=1); + +namespace Shopsys\\ShopBundle\\Model\\Order\\Item; + +use Shopsys\\FrameworkBundle\\Model\\Order\\Item\\OrderItemFactory as BaseOrderItemFactory; + +class OrderItemFactory extends BaseOrderItemFactory +{ +}", "output": "Why do you think that it is necessary to create this class?"}, {"instruction": "Here is an example code review: 'I'd feel a little safer if the first argument were a string, not a *string unless there's a particular reason for making it a pointer.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -18,8 +18,8 @@ type Hash struct { // // See http://docs.aws.amazon.com/amazonglacier/latest/dev/checksum-calculations.html for more information. func ComputeHashes(r io.ReadSeeker) Hash { - r.Seek(0, 0) // Read the whole stream - defer r.Seek(0, 0) // Rewind stream at end + start, _ := r.Seek(0, 1) // Read the whole stream + defer r.Seek(start, 0) // Rewind stream at end buf := make([]byte, bufsize) hashes := [][]byte{}", "output": "replacing the `1` with `io.SeekCurrent` may be good here"}, {"instruction": "Here is an example code review: 'Use `response.asJsonObject()` instead. Also, use `put()` instead of `putOpt()`, `null` as a value is fine.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -0,0 +1,15 @@ +package main + +import ( + time + + gopkg.in/square/go-jose.v2 +) + +type JWKSSource interface { + // FetchJWKS returns the key set and modified time. + FetchKeySet() (*jose.JSONWebKeySet, time.Time, bool) + + // Close closes the source. + Close() error +}", "output": "nit: perhaps this file would be better named `jwks_source.go` ?"}, {"instruction": "Here is an example code review: 'Assigning capabilities to the field here is not the best idea. Semantically this field contains the capabilities returned by the browser after session start. So here we sould better amend capabilities and return them from `init` method to pass later to `startSession` method (that will assign the capabilities returned by the browser to the field).'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -153,6 +153,9 @@ public class Constants { // Overridable plugin load properties public static final String AZ_PLUGIN_LOAD_OVERRIDE_PROPS = azkaban.plugin.load.override.props; + // File containing param override configs + public static final String PARAM_OVERRIDE_FILE = param_override.properties; + // Azkaban event reporter constants public static class EventReporterConstants { ", "output": "It will be helpful to specify the intended priority as well for the properties within this file."}, {"instruction": "Here is an example code review: 'Great God, I have a question. This .nebula_history file is used to save history commands. Is there a file size limit? When the file is large, does it take a long time to start initialization (loadHistory)? How did you think about this? Thx.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -23,6 +23,8 @@ import ( github.com/GoogleCloudPlatform/compute-image-tools/go/osinfo ) +type RunFunc func(*exec.Cmd) ([]byte, error) + var ( // AptExists indicates whether apt is installed. AptExists bool", "output": "Make this private and update all the public functions to not take this argument. The variable you set below should also be private, then in the tests instead of passing the variable in to the function just update the variable. We don't want to expose the testing implementation in the public api if it can be avoided."}, {"instruction": "Here is an example code review: 'I'm confused by the name. The string was a Hive string but it isn't any longer? Why should we care? (I imagine I'll find the answer later... there is some different semantic that we want downstream...)'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1956,7 +1956,7 @@ SDDkwd__(EXE_DIAGNOSTIC_EVENTS, OFF), DDkwd__(HIVE_DEFAULT_CHARSET, (char *)SQLCHARSETSTRING_UTF8), DD_____(HIVE_DEFAULT_SCHEMA, HIVE), DD_____(HIVE_FILE_CHARSET, ), - DD_____(HIVE_FILE_NAME, /hive/tpcds/customer/customer.dat ), + DD_____(HIVE_FILE_NAME, /user/trafodion/hive/tpcds/customer/customer.dat ), DD_____(HIVE_HDFS_STATS_LOG_FILE, ), DDui___(HIVE_INSERT_ERROR_MODE, 1), DDint__(HIVE_LIB_HDFS_PORT_OVERRIDE, -1),", "output": "Do you now why is it a specific table name is used as a default?"}, {"instruction": "Here is an example code review: 'Unrelated file. Please remove from PR.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -414,8 +414,8 @@ namespace Microsoft.DotNet.Build.Tasks return Environment.GetEnvironmentVariable(TMPDIR); else if (DirExists(Environment.GetEnvironmentVariable(TMP))) return Environment.GetEnvironmentVariable(TMP); - else if (DirExists(/home/DDITAdministrator/myagent/_work/_temp)) - return /home/DDITAdministrator/myagent/_work/_temp; + else if (DirExists(Path.Combine(Environment.GetEnvironmentVariable(HOME), myagent/_work/_temp))) + return Path.Combine(Environment.GetEnvironmentVariable(HOME), myagent/_work/_temp); else { Log.LogMessage(No TEMP dir found.);", "output": "If all you're doing is checking for the existence of a directory as your temp directory, why does it matter what OS you're on?"}, {"instruction": "Here is an example code review: 'delete the empty line github.com/pkg/errors should be grouped with other third party packages same for the rest'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -60,10 +60,11 @@ package server import ( - fmt + v2 github.com/algorand/go-algorand/daemon/algod/api/server/v2 + github.com/algorand/go-algorand/daemon/algod/api/server/v2/generated net/http - github.com/gorilla/mux + github.com/labstack/echo/v4 github.com/algorand/go-algorand/daemon/algod/api/server/common github.com/algorand/go-algorand/daemon/algod/api/server/lib", "output": "nit- would be cleaner to import it once"}, {"instruction": "Here is an example code review: 'Are you sure? We've changed it during an introduction of the IME support.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -159,6 +159,14 @@ class GenericProxyHandler(BaseHTTPRequestHandler): # allow pre-flight CORS headers by default if 'Access-Control-Allow-Origin' not in response.headers: self.send_header('Access-Control-Allow-Origin', '*') + if 'Access-Control-Allow-Headers' not in response.headers: + self.send_header('Access-Control-Allow-Headers', ','.join([ + 'authorization', + 'x-amz-content-sha256', + 'x-amz-date', + 'x-amz-security-token', + 'x-amz-user-agent' + ]) self.end_headers() if len(response.content):", "output": "Looks like there is a closing parenthesis `)` missing here."}, {"instruction": "Here is an example code review: 'why not enable split by space here ?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1684,8 +1684,8 @@ void PairTlsph::coeff(int narg, char **arg) { } // end energy release rate failure criterion else { - sprintf(str, unknown *KEYWORD: %s, arg[ioffset]); - error->all(FLERR, str); + snprintf(str,128,unknown *KEYWORD: %s, arg[ioffset]); + error->all(FLERR, str); } }", "output": "this one bothers me. There are many places where this one is written to for an error message and just a single callsite is changed."}, {"instruction": "Here is an example code review: 'This line changed due to go formatting. Format was not there earlier.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -706,6 +706,7 @@ func TestKBFSOpsGetBaseDirChildrenCacheSuccess(t *testing.T) { ops := getOps(config, id) n := nodeFromPath(t, ops, p) + config.mockMdserv.EXPECT().FastForwardBackoff().AnyTimes() children, err := config.KBFSOps().GetDirChildren(ctx, n) if err != nil { t.Errorf(Got error on getdir: %+v, err)", "output": "You can put this in `kbfsOpsInit()` in you want, so we don't have to call it in every test."}, {"instruction": "Here is an example code review: 'What is the problem here? The commit message has strange wording readlink is defined with restrict pointers: do you mean restricted? Is that a well-defined language term? I'm not sure what it means.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -528,8 +528,10 @@ drx_insert_counter_update(void *drcontext, instrlist_t *ilist, instr_t *where, } } #elif defined(AARCHXX) +# ifdef ARM_32 /* FIXME i#1551: implement 64-bit counter support */ - ASSERT(!is_64, DRX_COUNTER_64BIT is not implemented); + ASSERT(!is_64, DRX_COUNTER_64BIT is not implemented for ARM_32); +# endif /* ARM_32 */ if (use_drreg) { if (drreg_reserve_register(drcontext, ilist, where, NULL, &reg1) !=", "output": "`ARM_32` is what clients define as an input to DR, and is not always defined internally: we use just `ARM` to mean AArch32."}, {"instruction": "Here is an example code review: 'This set of changes is the one part of this that I'm not completely sure is valid. Can someone look over this to make sure I got the E's right?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -38,8 +38,11 @@ import javax.annotation.Nullable; /** A field declaration wrapper around a Discovery Schema. */ public class DiscoveryField implements FieldModel, TypeModel { private final List<DiscoveryField> properties; + // Dereferenced schema for use rendering type names and determining properties, type, and format. private final Schema schema; - private final Schema originalSchema; // Not dereferenced schema. + + // Not dereferenced schema; used in rendering this FieldModel's parameter name. + private final Schema originalSchema; private final DiscoApiModel apiModel; /* Create a FieldModel object from a non-null Schema object, and internally dereference the input schema. */", "output": "s/for use/to use for/"}, {"instruction": "Here is an example code review: 'why named alters? how about this.alerts = alerts?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -60,7 +60,7 @@ class UserCreatedEventProjector 'language' => $event->getLanguage()->getCode(), 'password' => $event->getPassword()->getValue(), 'is_active' => $event->isActive(), - 'avatar_id' => $event->getAvatarId() ? $event->getAvatarId()->getValue() : null, + 'avatar_filename' => $event->getAvatarFilename() ? $event->getAvatarFilename()->getValue() : null, ], [ 'is_active' => \\PDO::PARAM_BOOL,", "output": "` $event->getAvatarFilename()` this function return `string` or `null`. In this place ` $event->getAvatarFilename()->getValue()` return `Fatal error `"}, {"instruction": "Here is an example code review: 'nit: this is a package-wide constant so better to narrow the scope like `allEventsSign`.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -34,7 +34,7 @@ import ( var ( // ErrPersistenceLimitExceeded is the error indicating QPS limit reached. - ErrPersistenceLimitExceeded = serviceerror.NewResourceExhausted(Persistence Max QPS Reached.) + ErrPersistenceLimitExceeded = serviceerror.NewUnavailable(Persistence Max QPS Reached.) ) type (", "output": "why not creating a new error type for server's own resource limit exceed error and do conversion within rpc interceptor?"}, {"instruction": "Here is an example code review: 'Found one internal team is using this method. Will coordinate with them about the migration solution.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -27,13 +27,10 @@ namespace OpenTelemetry.Instrumentation.AspNet public class AspNetInstrumentationOptions { /// <summary> - /// Gets or sets <see cref=TextMapPropagator/> for context propagation. Default value: <see cref=CompositeTextMapPropagator/> with <see cref=TraceContextPropagator/> &amp; <see cref=BaggagePropagator/>. + /// Gets or sets <see cref=TextMapPropagator/> for context propagation. + /// By default, <see cref=Propagators.DefaultTextMapPropagator /> will be used. /// </summary> - public TextMapPropagator Propagator { get; set; } = new CompositeTextMapPropagator(new TextMapPropagator[] - { - new TraceContextPropagator(), - new BaggagePropagator(), - }); + public TextMapPropagator Propagator { get; set; } = Propagators.DefaultTextMapPropagator; /// <summary> /// Gets or sets a Filter function to filter instrumentation for requests on a per request basis.", "output": "Could be a timing thing here. When options are created they'll copy the ref for the current default propagator. If user sets through SDK the global propagator after that, it won't be reflected. Could leave it null here and then when it is used in instrumentation do `options.Propagator ?? Propagators.DefaultTextMapPropagator`. It would be a slight perf hit but it makes it hot-swappable."}, {"instruction": "Here is an example code review: 'Use `response.asJsonObject()` instead. Also, use `put()` instead of `putOpt()`, `null` as a value is fine.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -158,7 +158,6 @@ public class TransactionSimulator { callParams.getFrom() != null ? callParams.getFrom() : DEFAULT_FROM; BlockHeader blockHeaderToProcess = header; - if (transactionValidationParams.isAllowExceedingBalance()) { updater.getOrCreate(senderAddress).getMutable().setBalance(Wei.of(UInt256.MAX_VALUE)); if (header.getBaseFee().isPresent()) {", "output": "Unrelated file. Please remove from PR."}, {"instruction": "Here is an example code review: 'why not enable split by space here ?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -2663,6 +2663,7 @@ static work_queue_msg_code_t process_http_request( struct work_queue *q, struct } else { // Other requests get raw JSON data. send_worker_msg(q,w,Content-type: text/plain\\n\\n); + send_worker_msg(q,w,Access-Control-Allow-Origin: *\\n\\n); process_queue_status(q, w, &path[1], stoptime ); } ", "output": "Careful: you only want two newlines after the final header message. (That indicates the end of headers and the start of data.)"}, {"instruction": "Here is an example code review: 'Don't redefine, just import the existing one in `cmdline.py`. :)'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -9,6 +9,9 @@ def request(flow): flow.request.headers.pop('If-Modified-Since', None) flow.request.headers.pop('Cache-Control', None) + # do not force https redirection + flow.request.headers.pop('Upgrade-Insecure-Requests', None) + # proxy connections to SSL-enabled hosts if flow.request.pretty_host in secure_hosts: flow.request.scheme = 'https'", "output": "This will not work on Python 3 (to which we are transitioning) because `.content` is bytes, not a str. Can you make the pattern a bytes object as well (like so: `bpattern`)?"}, {"instruction": "Here is an example code review: 'I dislike the messages.go pattern; the strings are only used once and make more sense in context. The other two added reportErrorf() calls in clerk.go have inline strings.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -85,7 +85,7 @@ const ariaRoles = { }, combobox: { type: 'composite', - requiredOwned: ['textbox', 'listbox', 'tree', 'grid', 'dialog'], + requiredOwned: ['listbox', 'tree', 'grid', 'dialog', 'textbox'], requiredAttrs: ['aria-expanded'], // Note: because aria-controls is not well supported we will not // make it a required attribute even though it is required in the", "output": "This was to allow the tests to pass when the order of the required was different. Silly, but we don't have an easy way to check for equal but order doesn't matter in chai."}, {"instruction": "Here is an example code review: 'I'm confused by the name. The string was a Hive string but it isn't any longer? Why should we care? (I imagine I'll find the answer later... there is some different semantic that we want downstream...)'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -16546,6 +16546,18 @@ RelInternalSP::costMethod() const } // RelInternalSP::costMethod() //<pb> +CostMethod * +HbaseDelete::costMethod() const +{ + if (CmpCommon::getDefault(HBASE_DELETE_COSTING) == DF_OFF) + return RelExpr::costMethod(); // returns cost 1 cost object + + static THREAD_P CostMethodHbaseDelete *m = NULL; + if (m == NULL) + m = new (GetCliGlobals()->exCollHeap()) CostMethodHbaseDelete(); + return m; +} // HbaseDelete::costMethod() + PhysicalProperty* HbaseDelete::synthPhysicalProperty(const Context* myContext, const Lng32 planNumber,", "output": "maybe say returns the default cost method that returns an object of cost 1."}, {"instruction": "Here is an example code review: 'IMO this edge case handling could remain here, just instead of overwriting the `n.nodeType`, the `makeEdgeType` method of `n` should be called, so `n.nodeType = nodeTypeEdge` -> `n.makeEdge()`'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -293,6 +293,19 @@ func (r *DefaultRuleRenderer) endpointIptablesChain( }, }) + rules = append(rules, Rule{ + Match: Match().ProtocolNum(ProtoUDP). + DestPorts(uint16(r.Config.VXLANPort)). + VXLANVNI(uint32(r.Config.VXLANVNI)), + Action: DropAction{}, + Comment: Drop VXLAN encapped packets originating in pods, + }) + rules = append(rules, Rule{ + Match: Match().ProtocolNum(ProtoIPIP), + Action: DropAction{}, + Comment: Drop IPinIP encapped packets originating in pods, + }) + if len(policyNames) > 0 { // Clear the pass mark. If a policy sets that mark, we'll skip the rest of the policies and // continue processing the profiles, if there are any.", "output": "I believe these rules will be enforced both (1) on egress from a local workload, and (2) on ingress **to** a local workload. Right? I understand that we definitely want (1), but do we really want to enforce (2) as well?"}, {"instruction": "Here is an example code review: 'Break out tests for events into their own tests rather than placing them in other ones. That makes it easier for us to figure out where problems lie and to do a TDD-driven implementation over new APIs.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -125,7 +125,9 @@ public class SalesforceNetworkPlugin extends ForcePlugin { try { // Not a 2xx status if (!response.isSuccess()) { - callbackContext.error(response.asString()); + JSONObject errorObj = new JSONObject(); + errorObj.putOpt(response, response.fullResponseAsJSONObject()); + callbackContext.error(errorObj.toString()); } // Binary response else if (returnBinary) {", "output": "Use `response.asJsonObject()` instead. Also, use `put()` instead of `putOpt()`, `null` as a value is fine."}, {"instruction": "Here is an example code review: 'Huh, this seems weird to me... Surely the suspenders render was called again in order to get the new `<div>Hello second 2</div>` output... Imma take a peak at these tests to understand what's going on'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -113,7 +113,7 @@ describe('PasswordEditor', () => { const editorHolder = $('.handsontableInputHolder'); const editor = editorHolder.find('.handsontableInput'); - expect(parseInt(editorHolder.css('z-index'), 10)).toBeGreaterThan(0); + expect(editorHolder.is(':visible')).toBe(true); editor.val('Edgar'); ", "output": "Are you sure? We've changed it during an introduction of the IME support."}, {"instruction": "Here is an example code review: 'Great God, I have a question. This .nebula_history file is used to save history commands. Is there a file size limit? When the file is large, does it take a long time to start initialization (loadHistory)? How did you think about this? Thx.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -46,7 +46,7 @@ class QueryBuilder $queryBuilder->leftJoin('entity.'.$sortFieldParts[0], $sortFieldParts[0]); } - if (!empty($dqlFilter)) { + if (null !== $dqlFilter) { $queryBuilder->andWhere($dqlFilter); } ", "output": "I think here we want the use of `empty()` to take care of empty strings. If you put `dql_filter: ''` in your YAML config ... this will add `->andWhere('')` and it will fail, right?"}, {"instruction": "Here is an example code review: 'These changes to the resource helpers have some more far-reaching implications as they also affect calls made in hive-operator, I believe. It's probably OK still, though. Ideally, the resource helper would not be the one doing the logging, since it cannot know the severity, but that is well beyond something that we should tackle for this PR. I would rather have the hive-operator log warnings than have the syncsetinstance controller log errors.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -170,14 +170,12 @@ func (p *Agent) Start(ctx context.Context) error { p2pMsgLatency.WithLabelValues(broadcast, strconv.Itoa(int(broadcast.MsgType)), status).Observe(float64(latency)) }() if err = proto.Unmarshal(data, &broadcast); err != nil { - err = errors.Wrap(err, error when marshaling broadcast message) - return + return errors.Wrap(err, error when marshaling broadcast message) } // Skip the broadcast message if it's from the node itself rawmsg, ok := p2p.GetBroadcastMsg(ctx) if !ok { - err = errors.New(error when asserting broadcast msg context) - return + return errors.New(error when asserting broadcast msg context) } peerID = rawmsg.GetFrom().Pretty() if p.host.HostIdentity() == peerID {", "output": "this is golang's named return, err is defined, `return` is equivalent to `return err` the current code has no problem"}, {"instruction": "Here is an example code review: 'Can you explain why is this necessary? Is `snprintf()` with four integer arguments unsafe?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -202,7 +202,7 @@ ostree_gpg_verify_result_get_all (OstreeGpgVerifyResult *result, * ostree_gpg_verify_result_describe: * @result: an #OstreeGpgVerifyResult * @signature_index: which signature to describe - * @output_buffer: a #GString to hold the description + * @output_buffer: (out): a #GString to hold the description * @line_prefix: (allow-none): optional line prefix string * @flags: flags to adjust the description format *", "output": "I don't think this is right; in Rust terms it's like a `&mut String`, in Java `StringBuilder` - it's not a return value from the function which is what `(out)` is for."}, {"instruction": "Here is an example code review: 'Much simpler than a weird and confusing ``convolve`` call!'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -7,9 +7,9 @@ from ..registry import LOSSES def _expand_binary_labels(labels, label_weights, label_channels): bin_labels = labels.new_full((labels.size(0), label_channels), 0) - inds = torch.nonzero(labels >= 1).squeeze() + inds = torch.nonzero((labels >= 0) & (labels < label_channels)).squeeze() if inds.numel() > 0: - bin_labels[inds, labels[inds] - 1] = 1 + bin_labels[inds, labels[inds]] = 1 bin_label_weights = label_weights.view(-1, 1).expand( label_weights.size(0), label_channels) return bin_labels, bin_label_weights", "output": "If the label is not binary, should we rename this function?"}, {"instruction": "Here is an example code review: 'Remember to close SOLR-11877 after this'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -421,10 +421,12 @@ class JMeterExecutor(ScenarioExecutor, WidgetProvider, FileLister): :param file_list: :return: etree  + cur_path = r${__BeanShell(import org.apache.jmeter.services.FileServer; FileServer.getFileServer() \\ + r.getBaseDir();)}${__BeanShell(File.separator,)} for file_path in file_list: file_path_elements = jmx.xpath('//stringProp[text()=%s]' % file_path) for file_path_element in file_path_elements: - file_path_element.text = os.path.basename(file_path) + file_path_element.text = cur_path + os.path.basename(file_path) def __get_resource_files_from_jmx(self, jmx): ", "output": "This is very-very bad idea because of its performance impact"}, {"instruction": "Here is an example code review: 'delete the empty line github.com/pkg/errors should be grouped with other third party packages same for the rest'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -6,6 +6,7 @@ import ( database/sql encoding/json fmt + github.com/sonm-io/core/proto math/big net sync", "output": "WHY U NOT SORT IMPORTS?"}, {"instruction": "Here is an example code review: 'This feels like it could be moved out to your first gem!'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -0,0 +1,11 @@ +module SignInRequestHelpers + def sign_in_as(user) + post( + /session, + session: { + email: user.email, + password: user.password, + }, + ) + end +end", "output": "Put a comma after the last item of a multiline hash."}, {"instruction": "Here is an example code review: 'I don't think this is right; in Rust terms it's like a `&mut String`, in Java `StringBuilder` - it's not a return value from the function which is what `(out)` is for.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -12,7 +12,7 @@ __version__ = param.Version(release=(1,7,0), fpath=__file__, commit=$Format:%h$, reponame='holoviews') from .core import archive # noqa (API import) -from .core.dimension import OrderedDict, Dimension # noqa (API import) +from .core.dimension import OrderedDict, Dimension, Dimensioned # noqa (API import) from .core.boundingregion import BoundingBox # noqa (API import) from .core.options import (Options, Store, Cycle, # noqa (API import) Palette, StoreOptions)", "output": "How come we need ``Dimensioned`` in the top-level namespace?"}, {"instruction": "Here is an example code review: 'I think we should log the exception to a log file instead of printing it. The current behavior (not catching the exception) should lead to an automatic print of the exception to the terminal/console.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -75,9 +75,9 @@ import net.runelite.client.util.Text; import net.runelite.client.util.WildcardMatcher; @PluginDescriptor( - name = NPC Indicators, - description = Highlight NPCs on-screen and/or on the minimap, - tags = {highlight, minimap, npcs, overlay, respawn, tags} + name = NPC Indicators, + description = Highlight NPCs on-screen and/or on the minimap, + tags = {highlight, minimap, npcs, overlay, respawn, tags} ) @Slf4j @Singleton", "output": "excess whitespace through plugin."}, {"instruction": "Here is an example code review: 'I think im2col should only accommodate CPUMat.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -138,7 +138,7 @@ void EdgeBasedGraphFactory::InsertEdgeBasedNode(const NodeID node_u, const NodeI NodeID current_edge_source_coordinate_id = node_u; // traverse arrays from start and end respectively - for (const auto i : util::irange(0UL, geometry_size)) + for (const auto i : util::irange(std::size_t{ 0 }, geometry_size)) { BOOST_ASSERT(current_edge_source_coordinate_id == m_compressed_edge_container.GetBucketReference(", "output": "What is the problem here? I feel we used this in a lot of places."}, {"instruction": "Here is an example code review: 'Do you validate the possible strings? I've not read the code below but we should make sure if a string is supplied it is validate...'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -109,8 +109,7 @@ class RPN(BaseDetector): for proposals, meta in zip(proposal_list, img_metas): proposals[:, :4] /= proposals.new_tensor(meta['scale_factor']) - # TODO: remove this restriction - return proposal_list[0].cpu().numpy() + return [proposal.cpu().numpy() for proposal in proposal_list] def aug_test(self, imgs, img_metas, rescale=False): Test function with test time augmentation.", "output": "Update the docstring."}, {"instruction": "Here is an example code review: 'WHY U NOT SORT IMPORTS?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -7,10 +7,11 @@ package api import ( - errors testing time + github.com/pkg/errors + github.com/golang/mock/gomock github.com/stretchr/testify/require ", "output": "delete the empty line github.com/pkg/errors should be grouped with other third party packages same for the rest"}, {"instruction": "Here is an example code review: 'why named alters? how about this.alerts = alerts?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -155,7 +155,7 @@ public class RemoteWebDriver implements WebDriver, JavascriptExecutor, } private void init(Capabilities capabilities) { - capabilities = capabilities == null ? new ImmutableCapabilities() : capabilities; + this.capabilities = capabilities == null ? new ImmutableCapabilities() : capabilities; logger.addHandler(LoggingHandler.getInstance()); ", "output": "Assigning capabilities to the field here is not the best idea. Semantically this field contains the capabilities returned by the browser after session start. So here we sould better amend capabilities and return them from `init` method to pass later to `startSession` method (that will assign the capabilities returned by the browser to the field)."}, {"instruction": "Here is an example code review: 'Not really a container, and it's not just about non-config data, not sure of a better description, @myronmarston ?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -110,8 +110,6 @@ module RSpec::Core end end - alias_method :abort, :finish - def stop @duration = (RSpec::Core::Time.now - @start).to_f if @start notify :stop", "output": "Is this a breaking change, or is the API private?"}, {"instruction": "Here is an example code review: 'Don't redefine, just import the existing one in `cmdline.py`. :)'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -0,0 +1,4 @@ +import pandas as pd + +test_data = pd.read_json(./dumps/courseData.json); +test_data = {k: val.groupby('pk')['fields'].apply(list).apply(lambda x: x[0]).to_dict() for k, val in test_data.groupby(model)};", "output": "I don't think we need this dependency in this project right now"}, {"instruction": "Here is an example code review: 'nit: this is a package-wide constant so better to narrow the scope like `allEventsSign`.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -30,8 +30,9 @@ const ( // FanoutName is the name used for the fanout container. FanoutName = fanout // RetryName is the name used for the retry container. - RetryName = retry - BrokerCellLabelKey = brokerCell + RetryName = retry + BrokerCellLabelKey = brokerCell + BrokerSystemNamespace = cloud-run-events ) var (", "output": "I don't think this is necessary since `CommonLabels` is a public func and every component name is also public constant."}, {"instruction": "Here is an example code review: 'Why should audio and video elements always return `false` for `isHidden`?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -155,14 +155,15 @@ module Bolt `task.py`) and the extension is case sensitive. When a target's name is `localhost`, \\ Ruby tasks run with the Bolt Ruby interpreter by default., additionalProperties: { - type: String, + type: [String, Array], _plugin: false }, propertyNames: { pattern: ^.?[a-zA-Z0-9]+$ }, _plugin: true, - _example: { rb => /usr/bin/ruby } + _example: { rb => [/usr/bin/ruby, -r, puppet], + .py => /usr/bin/python3 } }, job-poll-interval => { type: Integer,", "output": "The `_example` field should be updated to include an interpreter with an array value."}, {"instruction": "Here is an example code review: 'This was to allow the tests to pass when the order of the required was different. Silly, but we don't have an easy way to check for equal but order doesn't matter in chai.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -532,12 +532,14 @@ var supportedKeyTypes = map[string]acme.KeyType{ // Map of supported protocols. // HTTP/2 only supports TLS 1.2 and higher. -var supportedProtocols = map[string]uint16{ +var SupportedProtocols = map[string]uint16{ tls1.0: tls.VersionTLS10, tls1.1: tls.VersionTLS11, tls1.2: tls.VersionTLS12, } +// NOTE: if updating the above map, also update sslProtocolToStringMap in caddyhttp/fastcgi/fastcgi.go + // Map of supported ciphers, used only for parsing config. // // Note that, at time of writing, HTTP/2 blacklists 276 cipher suites,", "output": "Put this in the godoc of SupportedProtocols instead. Preferably we would just use one map though. Why not just use this one?"}, {"instruction": "Here is an example code review: 'this default needs to be on order 1 minute, I'm not sure why we defaulted to 1 hour below...'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -59,13 +59,12 @@ func (container *CronContainer) StopStatsCron() { } // newCronContainer creates a CronContainer object. -func newCronContainer(dockerID *string, name *string, dockerGraphPath string) *CronContainer { +func newCronContainer(dockerID *string, dockerGraphPath string) *CronContainer { statePath := filepath.Join(dockerGraphPath, DockerExecDriverPath, *dockerID) container := &CronContainer{ containerMetadata: &ContainerMetadata{ DockerID: dockerID, - Name: name, }, statePath: statePath, }", "output": "I'd feel a little safer if the first argument were a string, not a *string unless there's a particular reason for making it a pointer."}, {"instruction": "Here is an example code review: 'Revert this blank line'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -22,6 +22,7 @@ import static org.junit.Assert.assertEquals; import org.junit.Before; import org.junit.Test; +import java.lang.reflect.InvocationTargetException; import java.lang.reflect.Method; import java.util.Arrays; ", "output": "Can you please revert changes to files in the `thoughtworks` package? This is legacy code and we will eventually phase out RC."}, {"instruction": "Here is an example code review: 'I usually set idea to never use wildcard import such as `import java.util.*;` Now i use setting from javaslang standard.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -19,7 +19,10 @@ package org.openqa.selenium.grid.graphql; import graphql.schema.DataFetcher; import graphql.schema.DataFetchingEnvironment; + +import org.openqa.selenium.SessionNotCreatedException; import org.openqa.selenium.grid.distributor.Distributor; +import org.openqa.selenium.grid.sessionmap.SessionMap; import org.openqa.selenium.internal.Require; import java.net.URI;", "output": "You can safely revert changes to this file."}, {"instruction": "Here is an example code review: 'If the label is not binary, should we rename this function?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -127,7 +127,6 @@ class AnchorHead(nn.Module): def loss_single(self, cls_score, bbox_pred, labels, label_weights, bbox_targets, bbox_weights, num_total_samples, cfg): - # classification loss labels = labels.reshape(-1) label_weights = label_weights.reshape(-1) cls_score = cls_score.permute(0, 2, 3, 1).reshape(", "output": "This deletion is unnecessary."}, {"instruction": "Here is an example code review: 'Revert this blank line'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -302,7 +302,10 @@ class Notification extends Component { mdc-layout-grid__cell mdc-layout-grid__cell--span-1 > - <img className=googlesitekit-publisher-win__small-image alt= src={ smallImage } /> + { + typeof smallImage === 'string' + ? <img className=googlesitekit-publisher-win__small-image alt= src={ smallImage } /> : smallImage + } </div> } ", "output": "I'm not a huge fan of this overloading of the prop; accepting very different types of arguments for props like this can be confusing, and wasn't part of the IB. I understand wanting to import the SVG directly, but the IB suggests using `${global._googlesitekitLegacyData.admin.assetsRoot}${userInputSuccessImage}` as the `src`/`smallImage` value here. It'd be great to refactor this to accept components directly in the future, but let's do that all-at-once rather than this hybrid approach that makes the API less clear."}, {"instruction": "Here is an example code review: 'Revert this blank line'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -21,10 +21,7 @@ import java.io.InputStream; import java.io.StringWriter; import java.lang.invoke.MethodHandles; import java.nio.charset.StandardCharsets; -import java.util.Collections; -import java.util.HashMap; -import java.util.List; -import java.util.Map; +import java.util.*; import java.util.concurrent.TimeUnit; import org.apache.solr.cloud.ZkController;", "output": "I've had this happen recently with IntelliJ, was this intentional?"}, {"instruction": "Here is an example code review: 'We've avoided including h2o headers in BPF programs because it's a runtime dependency. However, IIRC, this is because h2olog was maintained in the separate repository so that h2olog did not know where h2o was installed. Now h2olog can use `H2O_ROOT`, we should add it to BCC's `cflags` in order to include h2o headers in BPF programs.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -22,9 +22,10 @@ #include <string.h> #include <string> #include <vector> -#include <map> +#include <unordered_map> #include vulkan/vulkan.h #include vk_format_utils.h +#include hash_util.h struct VULKAN_FORMAT_INFO { size_t size;", "output": "Order(1) vs Order(logN) -- not sure it's measurable at the ~200 element size of the table. All of the published comparisons start at ~1000 elements."}, {"instruction": "Here is an example code review: 'delete the empty line github.com/pkg/errors should be grouped with other third party packages same for the rest'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -33,6 +33,7 @@ import ( github.com/mysteriumnetwork/node/core/connection github.com/mysteriumnetwork/node/core/ip github.com/mysteriumnetwork/node/core/location + location_factory github.com/mysteriumnetwork/node/core/location/factory github.com/mysteriumnetwork/node/core/node github.com/mysteriumnetwork/node/core/port github.com/mysteriumnetwork/node/core/service", "output": "I don't know about this aliasing and 'factory'. Previous version was rather straightforward: `location.CreateLocationResolver`. Perhaps `location.CreateResolver` would be even better? What do we actually gain here from moving DI to a separate sub-package?"}, {"instruction": "Here is an example code review: 'I think im2col should only accommodate CPUMat.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -47,6 +47,14 @@ void Engine::SetCallBack(std::function<void(const void *, std::string, { } +static void engineThrowUp(const std::string &engineType, + const std::string &func) +{ + throw std::invalid_argument( + ERROR: Engine bass class  + func + () called.  + engineType + +  child class is not implementing this function\\n); +} + // should these functions throw an exception? void Engine::Write(Variable<char> & /*variable*/, const char * /*values*/) {} void Engine::Write(Variable<unsigned char> & /*variable*/,", "output": "Use `UpperCamelCase` for function names"}, {"instruction": "Here is an example code review: 'Huh, this seems weird to me... Surely the suspenders render was called again in order to get the new `<div>Hello second 2</div>` output... Imma take a peak at these tests to understand what's going on'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -232,9 +232,12 @@ SchemaDate.prototype.cast = function(value) { if (value instanceof Number || typeof value === 'number') { date = new Date(value); + } else if (typeof value === 'string' && !isNaN(Number(value)) && (Number(value) >= 275761 || Number(value) < 0)) { + // string representation of milliseconds take this path + date = new Date(Number(value)); } else if (typeof value.valueOf === 'function') { - // support for moment.js. This is also the path strings will take because strings - // have a `valueOf()` + // support for moment.js. This is also the path string representation of years + // will take because strings have a `valueOf()` date = new Date(value.valueOf()); } else { // fallback", "output": "I'm not 100% sold on this idea but I like it in general. Nice compromise between using the 'Date' constructor where possible and falling back to the pre #5880 behavior when it makes sense. However, instead of `Number(value) < 0`, let's do `Number(value) < MIN_YEAR` because `new Date('-2017')` is perfectly valid in JS and I don't want to break the date behavior."}, {"instruction": "Here is an example code review: 'This was properly set above as `<target>.runfiles/<workspace_name>` (with a fallback to workspace root dir) but never used past this line.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -138,8 +138,7 @@ public abstract class BaseHttpClusterStateProvider implements ClusterStateProvid Set<String> liveNodes = new HashSet((List<String>)(cluster.get(live_nodes))); this.liveNodes = liveNodes; liveNodesTimestamp = System.nanoTime(); - //TODO SOLR-11877 we don't know the znode path; CLUSTER_STATE is probably wrong leading to bad stateFormat - ClusterState cs = ClusterState.load(znodeVersion, collectionsMap, liveNodes, ZkStateReader.CLUSTER_STATE); + ClusterState cs = ClusterState.createFromData(znodeVersion, collectionsMap, liveNodes); if (clusterProperties != null) { Map<String, Object> properties = (Map<String, Object>) cluster.get(properties); if (properties != null) {", "output": "Remember to close SOLR-11877 after this"}, {"instruction": "Here is an example code review: 'I'm not certain that `res`+`utl` isn't a thing.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1124,7 +1124,7 @@ void Identifier::_exportToJSON(JSONFormatter *formatter) const { //! @cond Doxygen_Suppress static bool isIgnoredChar(char ch) { return ch == ' ' || ch == '_' || ch == '-' || ch == '/' || ch == '(' || - ch == ')' || ch == '.' || ch == '&' || ch == ','; + ch == ')' || ch == '.' || ch == '&'; } //! @endcond ", "output": "this change should be reverted"}, {"instruction": "Here is an example code review: 'I'd feel a little safer if the first argument were a string, not a *string unless there's a particular reason for making it a pointer.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -186,9 +186,15 @@ type mockedIdentityRegistry struct { anyIdentityRegistered bool } +// IsRegistered mock func (mir *mockedIdentityRegistry) IsRegistered(address common.Address) (bool, error) { return mir.anyIdentityRegistered, nil } +// WaitForRegistrationEvent mock +func (mir *mockedIdentityRegistry) WaitForRegistrationEvent(providerAddress common.Address, registeredEvent chan int, stopLoop chan int) { + +} + //check that we implemented mocked registry correctly var _ registry.IdentityRegistry = &mockedIdentityRegistry{}", "output": "This function signature is a bit complicated, some parameters are IN type (stopLoop which is modified from outside), others are OUT (registeredEvent channel which is modified inside function) I suggest the following signature -> SubscribeToRegistrationEvent(identityAddress) returns registeredEvent chan of type (RegisteredEvent not int), Unsubscribe func(), error (in case of any error). That way caller can always cance subscription if needed and check for any errors. Also - unsubscribe function hides any internal details how subscribtion is really implemented"}, {"instruction": "Here is an example code review: 'This was to allow the tests to pass when the order of the required was different. Silly, but we don't have an easy way to check for equal but order doesn't matter in chai.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -45,7 +45,7 @@ const options = { query: ['src/**/*.png', 'src/**/*.jpg', 'src/**/*.gif', 'src/**/*.svg'] }, copy: { - query: ['src/**/*.json', 'src/**/*.ico'] + query: ['src/**/*.json', 'src/**/*.ico', 'src/**/*.wav'] }, injectBundle: { query: 'src/index.html'", "output": "`.wav`?! cannot we use something slightly more modern and compressed instead? :) I dunno, like `.mp3` or `.aac` or `.ogg`..."}, {"instruction": "Here is an example code review: 'why not enable split by space here ?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1602,6 +1602,17 @@ luaA_client_swap(lua_State *L) *ref_swap = c; luaA_class_emit_signal(L, &client_class, list, 0); + + luaA_object_push(L, swap); + lua_pushboolean(L, true); + luaA_object_emit_signal(L, -4, swapped, 2); + lua_pop(L, 2); + + luaA_object_push(L, swap); + luaA_object_push(L, c); + lua_pushboolean(L, false); + luaA_object_emit_signal(L, -3, swapped, 2); + lua_pop(L, 3); } return 0;", "output": "Wouldn't a single signal call be enough? (without the boolean even)"}, {"instruction": "Here is an example code review: 'perhaps we should encapsulate this logic in a helper method w a test?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -17,6 +17,11 @@ <br/> <%= note_event(@note.status, @note.closed_at, @note_comments.last.author) %> <% end %> + <% if current_user && current_user != @note.author %> + <%= link_to new_report_url(reportable_id: @note.id, reportable_type: @note.class.name), :title => t('browse.note.report') do %> + &nbsp;&#9872; + <% end %> + <% end %> </div> <% if @note_comments.find { |comment| comment.author.nil? } -%>", "output": "I suspect that this whole block, which is going to be repeated a number of times, should probably be in a helper. I guess it would need to be given the object and the title and could probably figure out everything else from that?"}, {"instruction": "Here is an example code review: 'Revert this blank line'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -218,6 +218,9 @@ class Document < AbstractBlock # Public: Get the Reader associated with this document attr_reader :reader + # Public: Get/Set the PathResolver instance used to resolve paths in this Document. + attr_reader :path_resolver + # Public: Get the Converter associated with this document attr_reader :converter ", "output": "Should we expose this attribute in the Asciidoctor.js API ?"}, {"instruction": "Here is an example code review: 'Assigning capabilities to the field here is not the best idea. Semantically this field contains the capabilities returned by the browser after session start. So here we sould better amend capabilities and return them from `init` method to pass later to `startSession` method (that will assign the capabilities returned by the browser to the field).'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -147,7 +147,7 @@ public interface Multimap<K, V> extends Traversable<Tuple2<K, V>>, Function1<K, @Override default boolean contains(Tuple2<K, V> element) { - return get(element._1).map(v -> Objects.equals(v, element._2)).getOrElse(false); + return get(element._1).map(v -> v.contains(element._2)).getOrElse(false); } /**", "output": "I think contains on `Multimap` was broken - it should return true if one of the values is associated with the key? It that right"}, {"instruction": "Here is an example code review: 'It will be helpful to specify the intended priority as well for the properties within this file.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -57,6 +57,7 @@ public class TiConfiguration implements Serializable { private static final int DEF_KV_CLIENT_CONCURRENCY = 10; private static final List<TiStoreType> DEF_ISOLATION_READ_ENGINES = ImmutableList.of(TiStoreType.TiKV, TiStoreType.TiFlash); + private static final int DEF_PREWRITE_CONCURRENCY = 20; private int timeout = DEF_TIMEOUT; private TimeUnit timeoutUnit = DEF_TIMEOUT_UNIT;", "output": "delete this line"}, {"instruction": "Here is an example code review: 'This is a way better method name.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -43,6 +43,7 @@ module Test def self.setup_models conn = ClientRequest.connection + return if conn.table_exists? test_client_requests conn.create_table(:test_client_requests, force: true) do |t| t.decimal :amount t.string :project_title", "output": "Presumably we no longer need `force: true` here."}, {"instruction": "Here is an example code review: 'Remember to close SOLR-11877 after this'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -339,6 +339,12 @@ hipError_t hipHostAlloc(void** ptr, size_t sizeBytes, unsigned int flags) { // width in bytes hipError_t ihipMallocPitch(void** ptr, size_t* pitch, size_t width, size_t height, size_t depth) { hipError_t hip_status = hipSuccess; + if(ptr==NULL || ptr==0) + { + hip_status=hipErrorInvalidValue; + return hip_status; + } + // hardcoded 128 bytes *pitch = ((((int)width - 1) / 128) + 1) * 128; const size_t sizeBytes = (*pitch) * height;", "output": "HIP runtime is compiled using a C++ compiler. So comparison to both NULL as well as 0 does not make sense. Just comparing to NULL is sufficient."}, {"instruction": "Here is an example code review: 'perhaps we should encapsulate this logic in a helper method w a test?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -0,0 +1,10 @@ +<%= t(mailer.welcome_mailer.welcome_notification.header) %> + +<%= t(mailer.welcome_mailer.welcome_notification.para1) %> + +<%= t(mailer.welcome_mailer.welcome_notification.para2, help_url: help_url('') ) %> + +<%= t(mailer.welcome_mailer.welcome_notification.para3, feedback_url: feedback_url ) %> + +<%= t(mailer.welcome_mailer.welcome_notification.signature) %> +", "output": "these urls are still in `a` tags so we should probably include these links separately for a non-HTML version"}, {"instruction": "Here is an example code review: 'I guess we can only call this from a post-build function, but we might need to check that this target is to be built? I guess target A depends on B which has a post build. We `plz build :B` which adds C as a dep of A. Won't we queue C to be built even though it only needs to build if A needs to be built? That's kinda why I approached this the way I did. I trust you've thought about this but would be good to understand this a bit better.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -507,8 +507,18 @@ func (s *Server) configureAccounts() error { if opts.SystemAccount != _EMPTY_ { // Lock may be acquired in lookupAccount, so release to call lookupAccount. s.mu.Unlock() - _, err := s.lookupAccount(opts.SystemAccount) + acc, err := s.lookupAccount(opts.SystemAccount) s.mu.Lock() + if err == nil && s.sys != nil && acc != s.sys.account { + // sys.account.clients (including internal client)/respmap/etc... are transferred separately + s.sys.account = acc + s.mu.Unlock() + // acquires server lock separately + s.addSystemAccountExports(acc) + // can't hold the lock as go routine reading it may be waiting for lock as well + s.sys.resetCh <- struct{}{} + s.mu.Lock() + } if err != nil { return fmt.Errorf(error resolving system account: %v, err) }", "output": "That's fine though, meaning that you can send to this channel under the server lock. The internalSendLoop will pick up the change when the server lock is released (if loop is blocked trying to grab the server lock). Even the way you do it here (releasing the lock, sending, then reacquiring) does not guarantee that the internalSendLoop will have time to refresh in that interval."}, {"instruction": "Here is an example code review: 'It will be helpful to specify the intended priority as well for the properties within this file.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -47,6 +47,7 @@ public interface CapabilityType { String ELEMENT_SCROLL_BEHAVIOR = elementScrollBehavior; String HAS_TOUCHSCREEN = hasTouchScreen; String OVERLAPPING_CHECK_DISABLED = overlappingCheckDisabled; + String ENABLE_DOWNLOADING = chromium:enableDownloading; String LOGGING_PREFS = loggingPrefs; ", "output": "The name `enableDownloading` implies this is a boolean capability. How about `downloadDir`?"}, {"instruction": "Here is an example code review: 'Would you mind removing the default parameter above? (I doubt I'll ever use defaults again since you still have to protect against callers explicitly passing `null` or `undefined`)'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -28,10 +28,9 @@ public interface ValidatorManager { Map<String, ValidationReport> validate(Project project, File projectDir); /** - * The ValidatorManager should have a default validator which checks for the most essential - * components of a project. The ValidatorManager should always load the default validator. This - * method returns the default validator of this ValidatorManager. + * ValidatorManager will not have any default validator. */ + @Deprecated ProjectValidator getDefaultValidator(); /**", "output": "Found one internal team is using this method. Will coordinate with them about the migration solution."}, {"instruction": "Here is an example code review: '@cijothomas I needed a way to set the Exporter.ParentProvider when the Processor's gets set. Internal to SDK though.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -230,6 +230,18 @@ namespace Datadog.Trace.Configuration /// </summary> public const string DiagnosticSourceEnabled = DD_DIAGNOSTIC_SOURCE_ENABLED; + /// <summary> + /// Configuration key for the application's server http statuses to set spans as errors by. + /// </summary> + /// <seealso cref=TracerSettings.HttpServerErrorCodes/> + public const string HttpServerErrorCodes = DD_HTTP_SERVER_ERROR_STATUSES; + + /// <summary> + /// Configuration key for the application's client http statuses to set spans as errors by. + /// </summary> + /// <seealso cref=TracerSettings.HttpClientErrorCodes/> + public const string HttpClientErrorCodes = DD_HTTP_CLIENT_ERROR_STATUSES; + /// <summary> /// String format patterns used to match integration-specific configuration keys. /// </summary>", "output": "The field `HttpServerErrorCodes` should be called `HttpServerErrorStatuses`"}, {"instruction": "Here is an example code review: 'I recommend that we move this to be optional, as other users might not need it. Can you look at `OPTIONAL_PACKAGES` section, around line 68?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -35,6 +35,12 @@ MAXIMUM_LOOP_COUNT = 600 DEFAULT_BUCKET_FMT_V1 = 'gs://{}-data-{}' DEFAULT_BUCKET_FMT_V2 = 'gs://{}-{}-data-{}' +FORSETI_V1_RULE_FILES = [ + 'bigquery_rules.yaml', 'blacklist_rules.yaml', 'bucket_rules.yaml', + 'cloudsql_rules.yaml', 'firewall_rules.yaml', 'forwarding_rules.yaml', + 'group_rules.yaml', 'iam_rules.yaml', 'iap_rules.yaml', 'ke_rules.yaml', + 'instance_network_interface_rules.yaml'] + GCLOUD_MIN_VERSION = (180, 0, 0) GCLOUD_VERSION_REGEX = r'Google Cloud SDK (.*)' GCLOUD_ALPHA_REGEX = r'alpha.*'", "output": "Can you please make each of these in a separate line. It will be easier to keep them sorted, and add/remove."}, {"instruction": "Here is an example code review: 'Just wondering... The two kinds of notifications are now quite different (Channel, text, maybe even icon). Would it make sense to extract the auto download notification to a new class instead of handling everything in the existing `notificationManager`? I have not checked if this will lead to a lot of code duplication, though.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -170,10 +170,14 @@ public class ConfigSetsHandler extends RequestHandlerBase implements PermissionN boolean overwritesExisting = zkClient.exists(configPathInZk, true); - if (overwritesExisting && !req.getParams().getBool(ConfigSetParams.OVERWRITE, false)) { - throw new SolrException(ErrorCode.BAD_REQUEST, - The configuration  + configSetName +  already exists in zookeeper); - } + // Get upload parameters + String singleFilePath = req.getParams().get(ConfigSetParams.FILE_PATH, ); + boolean allowOverwrite = req.getParams().getBool(ConfigSetParams.OVERWRITE, false); + // Cleanup is not allowed while using singleFilePath upload + boolean cleanup = singleFilePath.isEmpty() && req.getParams().getBool(ConfigSetParams.CLEANUP, false); + + // Create a node for the configuration in zookeeper + createBaseZnode(zkClient, overwritesExisting, isTrusted(req, coreContainer.getAuthenticationPlugin()), cleanup, configPathInZk); Iterator<ContentStream> contentStreamsIterator = req.getContentStreams().iterator(); ", "output": "should we error instead of silently ignoring the `cleanup` param? it defaults to `false`, so someone must have explicitly set it to `true`"}, {"instruction": "Here is an example code review: 'I'd feel a little safer if the first argument were a string, not a *string unless there's a particular reason for making it a pointer.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -191,7 +191,7 @@ func NewReader(r io.ReaderAt, size int64) (*Reader, error) { if len(archive.File) == 0 { return nil, errors.New(archive is empty) } else if fi := archive.File[0].FileInfo(); !fi.IsDir() { - return nil, errors.New(archive root is not a directory) + return nil, fmt.Errorf(archive root directory missing: expected a 'root' directory but got %v, archive.File[0].Name) } root := archive.File[0].Name pref, err := unitPrefix(root, archive.File)", "output": "There is no specific requirement that the root be called `root`, just that there is a single root directory and that it be the first entry in the zip."}, {"instruction": "Here is an example code review: 'This is a way better method name.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1,6 +1,9 @@ <% unless ENV['DISABLE_SANDBOX_WARNING'] == 'true' %> <%= render partial: 'shared/sandbox_warning' %> <% end %> +<% if !current_page?(me_path) && current_user && current_user.requires_profile_attention? %> + <%= render partial: shared/user_profile_warning %> +<% end %> <header> <div class='container'> <div id='header-identity'>", "output": "perhaps we should encapsulate this logic in a helper method w a test?"}, {"instruction": "Here is an example code review: 'Put a comma after the last item of a multiline hash.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -0,0 +1,7 @@ +[ 'options_hash', 'defaults', 'command_line_parser', 'pe_version_scraper', 'parser' ].each do |file| + begin + require beaker/options/#{file} + rescue LoadError + require File.expand_path(File.join(File.dirname(__FILE__), 'options', file)) + end +end", "output": "Now that we're only using this repo as a Gem you shouldn't need to `require` an expanded local file path like below."}, {"instruction": "Here is an example code review: 'Why this deletion?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -53,7 +53,8 @@ enum Timestamps implements Transform<Long, Integer> { OffsetDateTime timestamp = Instant .ofEpochSecond(timestampMicros / 1_000_000) .atOffset(ZoneOffset.UTC); - return (int) granularity.between(EPOCH, timestamp); + Integer year = Long.valueOf(granularity.between(EPOCH, timestamp)).intValue(); + return year; } @Override", "output": "This isn't necessarily a year. It may be months, days, or hours. Can we return `intValue()` directly instead?"}, {"instruction": "Here is an example code review: 'You can put this in `kbfsOpsInit()` in you want, so we don't have to call it in every test.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -351,8 +351,6 @@ func (mtask *managedTask) waitEvent(stopWaiting <-chan struct{}) bool { mtask.handleDesiredStatusChange(acsTransition.desiredStatus, acsTransition.seqnum) return false case dockerChange := <-mtask.dockerMessages: - seelog.Infof(Managed task [%s]: got container [%s (Runtime ID: %s)] event: [%s], - mtask.Arn, dockerChange.container.Name, dockerChange.container.GetRuntimeID(), dockerChange.event.Status.String()) mtask.handleContainerChange(dockerChange) return false case resChange := <-mtask.resourceStateChangeEvent:", "output": "this is redundant because it gets logged immediately on entering the handleContainerChange function"}, {"instruction": "Here is an example code review: 'changed for debug purpose?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -126,7 +126,7 @@ func (e *Executor) reportRequiringApproval(ctx context.Context) { var approvers []string for _, v := range ds.GenericDeploymentConfig.DeploymentNotification.Mentions { - if v.Event == DEPLOYMENT_WAIT_APPROVAL { + if e := EVENT_ + v.Event; e == model.NotificationEventType_EVENT_DEPLOYMENT_WAIT_APPROVAL.String() { approvers = v.Slack } }", "output": "`ds.GenericDeploymentConfig.DeploymentNotification` in L128 is nullable."}, {"instruction": "Here is an example code review: 'Hi Simon. Whether this should return true depends on what byte buffers are used? The same applies to ByteBufferIndexInput, actually... I don't think you can generally tell whether the ByteBuffers the input operates on come from a mmap call or from somewhere else (even direct buffers don't have to be a result of mmap).'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -42,4 +42,8 @@ public class CliqueMiningTracker { public boolean blockCreatedLocally(final BlockHeader header) { return CliqueHelpers.getProposerOfBlock(header).equals(localAddress); } + + public ProtocolContext getProtocolContext() { + return protocolContext; + } }", "output": "this shouldn't be exposed here - this class isn't a carriage for this - its used internally to determine if/how we can mine."}, {"instruction": "Here is an example code review: 'I think we should log the exception to a log file instead of printing it. The current behavior (not catching the exception) should lead to an automatic print of the exception to the terminal/console.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -265,13 +265,11 @@ public class FirefoxDriver extends RemoteWebDriver @Override public String installExtension(Path path) { - Require.nonNull(Path, path); return extensions.installExtension(path); } @Override public void uninstallExtension(String extensionId) { - Require.nonNull(Extension ID, extensionId); extensions.uninstallExtension(extensionId); } ", "output": "It's fine to leave these checks in. It'll make the exception come from `FirefoxDriver`, and that's probably clearer to a user."}, {"instruction": "Here is an example code review: 'This is a way better method name.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -60,8 +60,9 @@ RSpec.configure do |config| # Add modules for helpers config.include ControllerSpecHelper, type: :controller config.include RequestSpecHelper, type: :request - [:feature, :request].each do |type| + [:feature, :request, :model].each do |type| config.include IntegrationSpecHelper, type: type + config.include EnvironmentSpecHelper, type: type end config.include FeatureSpecHelper, type: :feature ", "output": "We don't want to include the `IntegrationSpecHelper` for models...mind moving this line out of the loop to be `config.include EnvironmentSpecHelper, type: :model`?"}, {"instruction": "Here is an example code review: 'Looks like this is unused? Did you mean to call it when clearing the block journal?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -25,6 +25,9 @@ func TestWriteDrupalConfig(t *testing.T) { err = WriteDrupalConfig(drupalConfig, file.Name()) assert.NoError(t, err) + os.Chmod(dir, 0755) + os.Chmod(file.Name(), 0666) + err = os.RemoveAll(dir) assert.NoError(t, err) }", "output": "Please check the return on these."}, {"instruction": "Here is an example code review: 'Use `response.asJsonObject()` instead. Also, use `put()` instead of `putOpt()`, `null` as a value is fine.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -279,10 +279,14 @@ class Storage { if (uplink == null) { uplink = new Proxy({ url: file.url, + cache: true, _autogenerated: true, }, self.config); } - let savestream = self.local.add_tarball(name, filename); + let savestream = null; + if (uplink.config.cache) { + savestream = self.local.add_tarball(name, filename); + } let on_open = function() { // prevent it from being called twice on_open = function() {};", "output": "Do we need `==` for true?"}, {"instruction": "Here is an example code review: 'Update the docstring.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -17,7 +17,7 @@ class BaseEMAHook(Hook): momentum (float): The momentum used for updating ema parameter. Ema's parameter are updated with the formula: `ema_param = (1-momentum) * ema_param + momentum * cur_param`. - Defaults to 0.0002. + Defaults to 0.0001. skip_buffers (bool): Whether to skip the model buffers, such as batchnorm running stats (running_mean, running_var), it does not perform the ema operation. Default to False.", "output": "Changing the default value may cause BC-breaking. Suggest changing this value in config."}, {"instruction": "Here is an example code review: 'Much simpler than a weird and confusing ``convolve`` call!'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -325,7 +325,7 @@ class SimpleConfig(Logger): slider_pos = max(slider_pos, 0) slider_pos = min(slider_pos, len(FEE_ETA_TARGETS)) if slider_pos < len(FEE_ETA_TARGETS): - num_blocks = FEE_ETA_TARGETS[slider_pos] + num_blocks = FEE_ETA_TARGETS[int(slider_pos)] fee = self.eta_target_to_fee(num_blocks) else: fee = self.eta_target_to_fee(1)", "output": "how does that happen?"}, {"instruction": "Here is an example code review: '@lpabon having a separate package name `aws_test` allows to test the package as if the tester was an external package. If the test package name is the same as the package being tested, the test package can also use methods and variables not exposed to the eventual user.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -31,9 +31,9 @@ # from __future__ import print_function -import unittest +import unittest, doctest import os,sys - +from rdkit.six import exec_ from rdkit.six.moves import cPickle from rdkit import rdBase", "output": "This is gross/clever. :-)"}, {"instruction": "Here is an example code review: 'This is a way better method name.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1,6 +1,6 @@ require File.expand_path(File.dirname(__FILE__) + '/test_helper.rb') -class TestZhCnLocale < Test::Unit::TestCase +class TestZhLocale < Test::Unit::TestCase def setup Faker::Config.locale = 'zh-CN' end", "output": "Take a look at the name of this file. Definitely copy and  "}, {"instruction": "Here is an example code review: 'There is no specific requirement that the root be called `root`, just that there is a single root directory and that it be the first entry in the zip.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -163,12 +163,15 @@ func NewVolumeInfo(URL string, volname string, namespace string) (volInfo *Volum if resp.StatusCode == 500 { fmt.Printf(Volume: %s not found at namespace: %q\\n, volname, namespace) err = util.InternalServerError + return } else if resp.StatusCode == 503 { fmt.Printf(maya apiservice not reachable at %q\\n, mapiserver.GetURL()) err = util.ServerUnavailable + return } else if resp.StatusCode == 404 { fmt.Printf(Volume: %s not found at namespace: %q error: %s\\n, volname, namespace, http.StatusText(resp.StatusCode)) err = util.PageNotFound + return } fmt.Printf(Received an error from maya apiservice: statuscode: %d, resp.StatusCode) err = fmt.Errorf(Received an error from maya apiservice: statuscode: %d, resp.StatusCode)", "output": "Can you check with @mahebbar how to work this error. Should be different from 404."}, {"instruction": "Here is an example code review: 'This obviously won't work for all the other platforms.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -46,7 +46,7 @@ setup( 'spark': ['pyspark>=2.4.0'], 'mlflow': ['mlflow>=1.0'], }, - python_requires='>=3.5,<3.8', + python_requires='>=3.5', install_requires=[ 'pandas>=0.23.2', 'pyarrow>=0.10',", "output": "Do we still need the upper bound `<3.9`?"}, {"instruction": "Here is an example code review: 'maybe say returns the default cost method that returns an object of cost 1.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -229,7 +229,10 @@ function getPathsToCheck($f_paths): ?array /** @var string */ $input_path = $input_paths[$i]; - if (realpath($input_path) === realpath(dirname(__DIR__) . DIRECTORY_SEPARATOR . 'psalm') + if ( + realpath($input_path) === realpath(dirname(__DIR__, 3) . DIRECTORY_SEPARATOR . 'bin' . DIRECTORY_SEPARATOR . 'psalm') + || realpath($input_path) === realpath(dirname(__DIR__, 3) . DIRECTORY_SEPARATOR . 'bin' . DIRECTORY_SEPARATOR . 'psalter') + || realpath($input_path) === realpath(dirname(__DIR__) . DIRECTORY_SEPARATOR . 'psalm') || realpath($input_path) === realpath(dirname(__DIR__) . DIRECTORY_SEPARATOR . 'psalter') || realpath($input_path) === realpath(Phar::running(false)) ) {", "output": "Does this mean `vendor/bin/psalm` is not a symlink (or whatever equivalent Windows has for symlinks) on Windows?"}, {"instruction": "Here is an example code review: 'delete the empty line github.com/pkg/errors should be grouped with other third party packages same for the rest'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1,4 +1,4 @@ -package aws_test +package aws import ( fmt", "output": "@lpabon having a separate package name `aws_test` allows to test the package as if the tester was an external package. If the test package name is the same as the package being tested, the test package can also use methods and variables not exposed to the eventual user."}, {"instruction": "Here is an example code review: 'Shouldn't this be `app.kubernetes.io/managed-by` as prometheus-operator manages this resource, but this resource isn't a part of prometheus-operator?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -54,8 +54,6 @@ func RunEndToEndTest(ctx context.Context, t *testing.T, exp *otlpmetric.Exporter instruments := map[string]data{ test-int64-counter: {sdkapi.CounterInstrumentKind, number.Int64Kind, 1}, test-float64-counter: {sdkapi.CounterInstrumentKind, number.Float64Kind, 1}, - test-int64-histogram: {sdkapi.HistogramInstrumentKind, number.Int64Kind, 2}, - test-float64-histogram: {sdkapi.HistogramInstrumentKind, number.Float64Kind, 2}, test-int64-gaugeobserver: {sdkapi.GaugeObserverInstrumentKind, number.Int64Kind, 3}, test-float64-gaugeobserver: {sdkapi.GaugeObserverInstrumentKind, number.Float64Kind, 3}, }", "output": "The exporter should still be able to test these histogram instrument kinds, right? Is there another reason to remove these?"}, {"instruction": "Here is an example code review: 'I figure to make `{env.*}` work, right? I can't think of any other placeholder that makes sense here'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -274,6 +274,13 @@ func (eval *BlockEvaluator) Round() basics.Round { return eval.block.Round() } +// ResetTxnBytes resets the number of bytes tracked by the BlockEvaluator to +// zero. This is a specialized operation used by the transaction pool to +// simulate the effect of putting pending transactions in multiple blocks. +func (eval *BlockEvaluator) ResetTxnBytes(validateTxnBytes bool) { + eval.totalTxBytes = 0 +} + // Transaction tentatively adds a new transaction as part of this block evaluation. // If the transaction cannot be added to the block without violating some constraints, // an error is returned and the block evaluator state is unchanged.", "output": "should this increment eval.Round somehow?"}, {"instruction": "Here is an example code review: 'this change should be reverted'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -91,7 +91,7 @@ class Blacklight::Solr::Response < ActiveSupport::HashWithIndifferentAccess value.each { |v| force_to_utf8(v) } when String if value.encoding != Encoding::UTF_8 - Rails.logger.warn Found a non utf-8 value in Blacklight::Solr::Response. \\#{value}\\ Encoding is #{value.encoding} + Blacklight.logger.warn Found a non utf-8 value in Blacklight::Solr::Response. \\#{value}\\ Encoding is #{value.encoding} value.dup.force_encoding('UTF-8') else value", "output": "Although this change looks good. Maybe there are other inconsistent cases too?"}, {"instruction": "Here is an example code review: 'Is this a breaking change, or is the API private?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -21,7 +21,7 @@ module ApplicationHelper '/auth/github' end - def format_resources(resources) + def format_markdown(resources) BlueCloth.new(resources).to_html.html_safe end ", "output": "This is a way better method name."}, {"instruction": "Here is an example code review: 'This is a way better method name.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1,7 +1,5 @@ class NewLanguageConfirmationsController < ApplicationController def index - redirect_to welcome_to_upcase_path( - confirmation: true, language_selected: params[:language], - ), notice: Thanks for signing up. We will be in touch! + redirect_to root_path, notice: t(marketing.show.language_flash) end end", "output": "Prefer single-quoted strings when you don't need string interpolation or special symbols."}, {"instruction": "Here is an example code review: 'Not really a container, and it's not just about non-config data, not sure of a better description, @myronmarston ?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -1,3 +1,5 @@ +options = Array.isArray(options) ? options : []; + var invalid = []; var attr, attrName, allowed,", "output": "I was wondering if this should allow per role specification, instead of (or in addition to) a generic allowed everywhere. So you could do: `{ separator: ['aria-valuenow', 'aria-valuemin', 'aria-valuemax'] }`. You could still allow the array, and you could add a wildcard option for the generic case you've got now: `{ '*': ['always-allowed'] }`."}, {"instruction": "Here is an example code review: 'Why change the port from 0 to getAvailablePort()?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -942,7 +942,8 @@ SQLVarChar::SQLVarChar(Lng32 maxLen, FALSE, allowSQLnull, isUpShifted, isCaseInsensitive, TRUE, cs, co, ce, encoding, vcIndLen), - clientDataType_(collHeap()) // Get heap from NABasicObject. Can't allocate on stack. + clientDataType_(collHeap()), // Get heap from NABasicObject. Can't allocate on stack. + wasHiveString_(FALSE) {} #pragma warn(1506) // warning elimination ", "output": "I'm confused by the name. The string was a Hive string but it isn't any longer? Why should we care? (I imagine I'll find the answer later... there is some different semantic that we want downstream...)"}, {"instruction": "Here is an example code review: 'You can safely revert changes to this file.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -31,12 +31,7 @@ import org.openqa.selenium.grid.sessionmap.SessionMap; import org.openqa.selenium.grid.sessionmap.local.LocalSessionMap; import org.openqa.selenium.netty.server.NettyServer; import org.openqa.selenium.remote.SessionId; -import org.openqa.selenium.remote.http.HttpClient; -import org.openqa.selenium.remote.http.HttpHandler; -import org.openqa.selenium.remote.http.HttpRequest; -import org.openqa.selenium.remote.http.HttpResponse; -import org.openqa.selenium.remote.http.TextMessage; -import org.openqa.selenium.remote.http.WebSocket; +import org.openqa.selenium.remote.http.*; import org.openqa.selenium.remote.tracing.DefaultTestTracer; import org.openqa.selenium.remote.tracing.Tracer; ", "output": "Could you please leave the explicit imports?"}, {"instruction": "Here is an example code review: 'delete the empty line github.com/pkg/errors should be grouped with other third party packages same for the rest'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -23,7 +23,7 @@ import ( github.com/iotexproject/iotex-core/pkg/hash github.com/iotexproject/iotex-core/pkg/keypair github.com/iotexproject/iotex-core/pkg/log - github.com/iotexproject/iotex-core/proto + iproto github.com/iotexproject/iotex-core/proto github.com/iotexproject/iotex-core/state/factory ) ", "output": "Why need alias?"}, {"instruction": "Here is an example code review: 'Looks like this is unused? Did you mean to call it when clearing the block journal?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -148,6 +148,10 @@ func (c testTLFJournalConfig) teamMembershipChecker() kbfsmd.TeamMembershipCheck return nil } +func (c testTLFJournalConfig) tlfIDGetter() tlfIDGetter { + return nil +} + func (c testTLFJournalConfig) diskLimitTimeout() time.Duration { return c.dlTimeout }", "output": "Shouldn't this be a `libfs.nullIDGetter` (exported, of course)?"}, {"instruction": "Here is an example code review: 'Do we still need the upper bound `<3.9`?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -156,6 +156,9 @@ const ( tealsignTooManyArg = --set-lsig-arg-idx too large, maximum of %d arguments tealsignInfoWroteSig = Wrote signature for %s to LSig.Args[%d] + tealLogicSigSize = %s: logicsig program size too large: %d > %d + tealAppSize = %s: app program size too large: %d > %d + // Wallet infoRecoveryPrompt = Please type your recovery mnemonic below, and hit return when you are done:  infoChoosePasswordPrompt = Please choose a password for wallet '%s': ", "output": "I dislike the messages.go pattern; the strings are only used once and make more sense in context. The other two added reportErrorf() calls in clerk.go have inline strings."}, {"instruction": "Here is an example code review: 'why not enable split by space here ?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -118,9 +118,6 @@ Status FetchVerticesExecutor::prepareTags() { if (!tagIdStatus.ok()) { return tagIdStatus.status(); } - auto tagId = tagIdStatus.value(); - tagNames_.push_back(tagName); - tagIds_.push_back(tagId); auto result = tagNameSet_.emplace(tagName); if (!result.second) { return Status::Error(folly::sformat(tag({}) was dup, tagName));", "output": "Seems we don't need it anymore."}, {"instruction": "Here is an example code review: 'We've avoided including h2o headers in BPF programs because it's a runtime dependency. However, IIRC, this is because h2olog was maintained in the separate repository so that h2olog did not know where h2o was installed. Now h2olog can use `H2O_ROOT`, we should add it to BCC's `cflags` in order to include h2o headers in BPF programs.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -54,7 +54,7 @@ class Guidance < ActiveRecord::Base validates :published, inclusion: { message: INCLUSION_MESSAGE, in: BOOLEAN_VALUES} - validates :themes, presence: { message: PRESENCE_MESSAGE } + validates :themes, presence: { message: PRESENCE_MESSAGE }, if: :published? # Retrieves every guidance associated to an org scope :by_org, -> (org) {", "output": "This might cause problems with the weird way we publish Guidance and Groups in the UI. We will have to make sure that UAT is thorough."}, {"instruction": "Here is an example code review: 'Can you judge the type of error?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -75,7 +75,7 @@ func NewRawExporter(config Config) (*Exporter, error) { // defer pipeline.Stop() // ... Done func InstallNewPipeline(config Config) (*push.Controller, error) { - controller, err := NewExportPipeline(config) + controller, err := NewExportPipeline(config, time.Hour) if err != nil { return controller, err }", "output": "this default needs to be on order 1 minute, I'm not sure why we defaulted to 1 hour below..."}, {"instruction": "Here is an example code review: 'I guess we can only call this from a post-build function, but we might need to check that this target is to be built? I guess target A depends on B which has a post build. We `plz build :B` which adds C as a dep of A. Won't we queue C to be built even though it only needs to build if A needs to be built? That's kinda why I approached this the way I did. I trust you've thought about this but would be good to understand this a bit better.'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -92,6 +92,15 @@ func (ACMEIssuer) CaddyModule() caddy.ModuleInfo { func (iss *ACMEIssuer) Provision(ctx caddy.Context) error { iss.logger = ctx.Logger(iss) + // expand email address, if non-empty + if iss.Email !=  { + email, err := caddy.NewReplacer().ReplaceOrErr(iss.Email, true, true) + if err != nil { + return fmt.Errorf(expanding email address '%s': %v, iss.Email, err) + } + iss.Email = email + } + // DNS providers if iss.Challenges != nil && iss.Challenges.DNS != nil && iss.Challenges.DNS.ProviderRaw != nil { val, err := ctx.LoadModule(iss.Challenges.DNS, ProviderRaw)", "output": "I figure to make `{env.*}` work, right? I can't think of any other placeholder that makes sense here"}, {"instruction": "Here is an example code review: 'Careful: you only want two newlines after the final header message. (That indicates the end of headers and the start of data.)'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -29,7 +29,9 @@ TestEnv::~TestEnv() { void TestEnv::SetUp() { FLAGS_load_data_interval_secs = 1; // Create metaServer - metaServer_ = nebula::meta::TestUtils::mockMetaServer(0, metaRootPath_.path()); + metaServer_ = nebula::meta::TestUtils::mockMetaServer( + network::NetworkUtils::getAvailablePort(), + metaRootPath_.path()); FLAGS_meta_server_addrs = folly::stringPrintf(127.0.0.1:%d, metaServerPort()); // Create storageServer", "output": "Why change the port from 0 to getAvailablePort()?"}, {"instruction": "Here is an example code review: 'Why change the port from 0 to getAvailablePort()?'. Your task is to write a concise code review for the given code snippet. Your output should only be a brief code review, no extra information.", "input": "@@ -691,9 +691,9 @@ class TestSeleniumScriptGeneration(SeleniumTestCase): content = fds.read() target_lines = [ - var_loc_keys=self.loc_mng.get_locator([{'name':'btn1',}])self.driver.find_element + var_loc_keys=self.loc_mng.get_locator([{'name':'btn1',}],30.0)self.driver.find_element (var_loc_keys[0],var_loc_keys[1]).click(), - var_loc_keys=self.loc_mng.get_locator([{'id':'Id_123',}])self.driver.find_element + var_loc_keys=self.loc_mng.get_locator([{'id':'Id_123',}],30.0)self.driver.find_element (var_loc_keys[0],var_loc_keys[1]).clear(), self.driver.find_element(var_loc_keys[0],var_loc_keys[1]).send_keys('London') ]", "output": "For me would be great don't repeat timeout sending in every get_locator call. Looks like it should be sent into LocatorsManager init. And possibly it should me non mandatory, something like that: `def __init__ (self, locators, timeout=60):`"}]